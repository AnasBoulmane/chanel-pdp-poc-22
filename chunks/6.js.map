{"version":3,"sources":["webpack:///./patterns/scripts/ui/vto/Components/ButtonWishList.jsx","webpack:///./patterns/scripts/ui/vto/Components/Cart.jsx","webpack:///./patterns/scripts/ui/vto/Components/Error.jsx","webpack:///./patterns/scripts/ui/vto/Components/IntensitySwitch.jsx","webpack:///./patterns/scripts/ui/vto/Components/IntensitySwitchButton.jsx","webpack:///./patterns/scripts/ui/vto/Components/Makeup/AddedToBag.jsx","webpack:///./patterns/scripts/ui/vto/Components/Makeup/QuickAddToBag.jsx","webpack:///./patterns/scripts/ui/vto/Components/Makeup/impetus.js","webpack:///./patterns/scripts/ui/vto/Components/Makeup/index.jsx"],"names":["ButtonWishList","Component","constructor","props","e","undo","result","udpateProductInWishlist","state","codeProduct","active","setState","wishlistData","showNotification","pushAnalytics","updateUI","err","console","error","elNotifier","select","classList","add","elementsNotifier","selectAll","slice","forEach","el","removeAttribute","focus","undoButton","clickUndo","onClick","addEventListener","bind","notifier","show","name","message","label","close","opener","button","noFocus","setTimeout","reconfigNotifier","wishlist","productCodeIds","indexOf","datalayer","analytics","eventAction","textActive","textInactive","window","document","DLKit","push","event","eventCategory","eventLabel","accessibility","isProductInWishList","componentWillReceiveProps","render","node","ButtonCart","componentDidMount","hasProduct","Error","IntensitySwitch","toggle","sku","type","toggleIntensity","newProps","product","code","mainSku","altSku","mobileBp","display","width","displayType","hasTwoIntensities","ready","selectedVariant","toggleButton","ariaPressed","i18nIntensity","config","vto","labels","light","intense","i18nDescription","shadeSwitch","replace","ButtonAddedToBag","globalCartImage","addedToBagLabel","locales","ButtonQuickAddToBag","quickAddToBag","quickAddToBagLabel","stopThresholdDefault","bounceDeceleration","bounceAcceleration","requestId","Impetus","source","sourceEl","update","updateCallback","multiplier","friction","initialValues","boundX","boundY","bounce","onEnd","callbackEnd","boundXmin","boundXmax","boundYmin","boundYmax","pointerLastX","pointerLastY","pointerCurrentX","pointerCurrentY","pointerId","decVelX","decVelY","targetX","targetY","stopThreshold","ticking","pointerActive","paused","decelerating","trackingPoints","init","querySelector","callUpdateCallback","onDown","destroy","removeEventListener","pause","resume","setValues","x","y","setMultiplier","val","setBoundX","setBoundY","call","normalizeEvent","ev","touch","targetTouches","changedTouches","clientX","clientY","id","identifier","addTrackingPoint","onMove","getPassiveSupported","passive","onUp","stopTracking","preventDefault","requestTick","startDecelAnim","time","Date","now","length","shift","updateAndRender","pointerChangeX","pointerChangeY","diff","checkBounds","dragOutOfBoundsMultiplier","Math","pow","requestAnimFrame","restrict","xDiff","yDiff","undefined","inBounds","firstPoint","lastPoint","xOffset","yOffset","timeOffset","D","abs","stepDecelAnim","max","cancelAnimationFrame","reboundAdjust","adjust","requestAnimationFrame","webkitRequestAnimationFrame","mozRequestAnimationFrame","callback","passiveSupported","options","Object","defineProperty","get","connect","Makeup","identifyBrowser","includes","isPortrait","variantList","interceptor","iFrame","container","contentWindow","isiOS","isMobile","windowWidth","innerWidth","setCanvasDimensionsOnResize","isItChrome","isWideScreen","windowHeight","innerHeight","windowResized","viewSwitched","min","rotationValue","enableLandscapeError","matchMedia","matches","isPortraitView","showRotationError","dispatch","buttonWishListDesktop","dataWishList","dataset","JSON","parse","trackWishlist","vtoWishlist","textWishlistActive","textWishlistInactive","vtoContainer","vto_wrapper","getBoundingClientRect","height","cameraIcon","vto_container","frameHeight","getFrameHeight","addedTop","style","top","offsetHeight","marginTop","cameraIconRect","vto_wrapperRect","vto_containerRect","minHeightContainer","bottom","selector","selectedElem","offsetTop","canvas","getComputedStyle","iframeContent","iFrameCanvas","iframeCanvasRect","iframeComputedStyles","frameMargin","parseFloat","marginLeft","canvasWidth","canvasHeight","imageWidth","imageHeight","scale","parseInt","position","left","transform","isMobileScreen","pictureContainer","toggleTopContainerClass","remove","contains","showTimer","showPicture","setCameraPosition","Manager","publish","VTO_PDP_STYLE_UPDATE","ymkContainer","videoElem","setAttribute","selectedFirstTime","shadeChanged","interceptorPos","selectedPos","variantNodes","getSelectedIndex","interceptorCenter","floor","animate","impetus","shadeImg","iFrameHeight","isLandscapeView","isLandscape","isMobileView","dataLayer","a11yOnVideoElem","ctoLandscapeCheck","scrollContainer","scroller","scrollTo","disableScroll","disabledRubberBand","attach","sdk","YMK","snapshot","imgURL","imgSrc","detach","key","variants","findIndex","v","selected","sellableOnline","showCTA","quickAdd","showCart","unavailableMsgFlag","showUnavailableMsg","test","stock","stockLevel","errorNotificationClosed","productTitle","body","innerText","is4Ombres","showCTOpicture","cameraAvailable","setWishListState","mobileCameraIcon","React","createRef","desktopCameraIcon","_componentIsMounted","retrySetup","className","initialCanvas","cameraErrorResolvedAction","vtoIframe","iframe","vtoCameraNotAvailableAction","notify","Notifier","invalid","unavailableShade","makeup","closeButtonLabel","onShow","notificationCloseBtn","onHide","li","vtoVariantShades","getAttribute","imgEl","reset","hideUI","autoOpen","subscribe","WINDOW_WAS_RESIZED","onResize","productFirstImage","visibility","toLowerCase","initalDimensionInterval","setInterval","initialFrameDimensions","clearInterval","opacity","forcedClosed","vtoSDKCloseAction","vtoCloseClickAction","firstSlideEl","getCollection","_firstSlideElId","Promise","resolve","vtoClose","product_detail_scroll","showing","vtoReadyAction","renderAddToBag","renderCartIcon","getRightNav","renderWishListIcon","getLeftNav","getUnavailableMessage","unavailable","notifyError","limitationError","quickAddToBagError","productHeading","detailsHeader","vtoVariantShadeAriaHidden","basic","is4ShadowProduct","is4ShadowFeatureFlipping","applyMakeupBySku","lastProduct","componentDidUpdate","previousIntensity","pos","centerInterceptorPos","round","center","closestDistance","shouldSelectIndex","ch","index","minDistance","right","vtoContainerInnerEl","componentWillUnmount","observers","observer","unobserve","events","unsubscribe","onVariantChange","atbTemplate","ACC","CSRFToken","form","createElement","innerHTML","webservices","cart","xhr","then","response","analyticsJson","ecommerce","detail","products","currencyCode","cart_id","cartValue","catch","statusCode","prevState","formError","renderVariants","selectedIndex","visible","i","isPrevious","isNext","els","map","spanClassName","ariaProperties","imgProperties","src","shade","srcSet","onKeyDown","keyCode","current","click","role","liClsName","alt","variantSelector","text","tabIndex","previous","next","setInterceptorRef","enableCTOPicturePDP","cameraClicked","cto","dedicated","cameraText","setVariantListRef","polluxCondition","sessionStorage","getItem","isBoutiqueApp","jsConfigSecond","timerProps","imageProps","updateValue","outer","timerComplete","photoCaptureClose","isDesktopScreen","hidden","price","toString","split"],"mappings":"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","file":"chunks/6.js?v=3.23","sourcesContent":["import React,  { Component } from 'react'\nimport Icon from './Icon'\nimport { select, selectAll } from 'lib/selectors'\nimport { getWishlistData, udpateProductInWishlist } from 'lib/wishlist/wishlist-yapi'\nimport { updateUI } from 'lib/wishlist/wishlist-ui'\nimport notifier from \"modules/notifier\"\n\nclass ButtonWishList extends Component {\n    constructor(props) {\n        super(props)\n        this.state = {\n            codeProduct: props.codeProduct,\n            wishlistData: props.wishlistData,\n            active: false,\n            analytics: {\n                event: 'uaevent',\n                eventCategory: 'vto',\n                eventLabel: props.codeProduct,\n                eventAction: ''\n            },\n            accessibility: {\n                textActive: props.accessibility.textActive,\n                textInactive: props.accessibility.textInactive\n            },\n            textActive: props.textActive,\n            textInactive: props.textInactive\n        }\n        this.isProductInWishList()\n    }\n    componentWillReceiveProps(props) {\n        if(props.codeProduct !== this.state.codeProduct) {\n            this.setState({\n                codeProduct: props.codeProduct,\n                analytics: {\n                    event: 'uaevent',\n                    eventCategory: 'vto',\n                    eventLabel: props.codeProduct,\n                    eventAction: ''\n                },\n                accessibility: {\n                    textActive: props.accessibility.textActive,\n                    textInactive: props.accessibility.textInactive\n                },\n                textActive: props.textActive,\n                textInactive: props.textInactive\n            })\n            this.isProductInWishList()\n        }\n    }\n    onClick = async (e, undo = false) => {\n        try {\n            const result = await udpateProductInWishlist(this.state.codeProduct, !this.state.active, false)\n            this.setState({\n                active: !this.state.active\n            })\n             this.setState({\n                wishlistData: result\n            })\n            this.showNotification(result, undo)\n            this.pushAnalytics()\n            // this line is important to update all wishlist icons state (second argument for header wishlist)\n            updateUI(result, !this.state.active)\n        } catch (err) {\n            console.error(err)\n        }\n    }\n    reconfigNotifier = (undo) => {\n        const elNotifier = select('.notifier__wrapper')\n        elNotifier.classList.add('notifier__for-vto-wishlist')\n        const elementsNotifier = selectAll('a,button', elNotifier)\n        if (elementsNotifier) {\n            elementsNotifier.slice(1).forEach(el => el.removeAttribute('tabindex'))\n            elementsNotifier[0].focus()\n        }\n        const undoButton = select('.undo[data-wishlist]', elNotifier)\n        if (undoButton) {\n            undoButton.classList.add('undo-vto-wishlist')\n            const clickUndo = (e) => {this.onClick(e,true)}\n            undoButton.addEventListener('click', clickUndo.bind(this))\n        }\n    }\n    showNotification = async (result, undo) => {\n        await notifier.show({\n            name: result.message.label,\n            message: result.message.message,\n            close: result.message.close,\n            opener: this.button,\n            noFocus: false\n        })\n        setTimeout(()=>{this.reconfigNotifier(undo)}, 100)\n    }\n    isProductInWishList = () => {\n     const wishlist = this.state.wishlistData\n       setTimeout(()=>{\n          this.setState({\n              active: wishlist.productCodeIds.indexOf(this.state.codeProduct) > -1\n          })\n       }, 100)\n    }\n    pushAnalytics = () => {\n        let datalayer = this.state.analytics\n        datalayer.eventAction = this.state.active ? this.state.textActive : this.state.textInactive\n        window.document.DLKit.push('on-wishlist-add', datalayer)\n    }\n    render () {\n        return (\n          <button ref={node => this.button = node} onClick={this.onClick} type=\"button\" className=\"vto-wishlist\">\n            <Icon name={this.state.active ? \"wishlist-on\" : \"wishlist-off\"} />\n            <span className=\"is-sr-only\">{!this.state.active? this.state.accessibility.textActive : this.state.accessibility.textInactive}</span>\n          </button>\n        )\n    }\n}\n\nexport default ButtonWishList\n","import React,  { Component } from 'react'\nimport Icon from './Icon'\n\nclass ButtonCart extends Component {\n\n  componentDidMount () {\n    this.button.focus()\n  }\n\n  render () {\n    return (\n      <span ref={node => this.button = node } className={`button icon is-large vto-cart nav-item ${this.props.hasProduct}`}>\n        <Icon name=\"vto-cart\" />\n      </span>\n    )\n  }\n}\n\nexport default ButtonCart\n","import React from 'react'\n\nconst Error = ({ error }) => (\n  <div className=\"error permissionDenied\">\n    <div role=\"heading\" aria-level=\"2\" className=\"error__title\">{error.name}</div>\n    <p className=\"error__message\">{error.message}</p>\n  </div>\n)\n\nexport default Error\n","import React, { Component } from 'react'\nimport IntensitySwitchButton from './IntensitySwitchButton'\n\nclass IntensitySwitch extends Component {\n    constructor(props) {\n        super(props)\n        this.state = {\n            active: 'light'\n        }\n        this.toggle = this.toggle.bind(this)\n    }\n\n    toggle(sku, type) {\n        if (this.state.active !== type) {\n            this.props.toggleIntensity(sku, type)\n            this.setState({\n                active: type\n            })\n        }\n    }\n\n    componentWillReceiveProps(newProps) {\n        if (newProps.product.code !== this.props.product.code) {\n            this.setState({active: 'light'})\n        }\n    }\n\n    render() {\n        const mainSku = this.props.product.mainSku\n        const altSku = this.props.product.altSku\n        const mobileBp = 960\n        let display = false\n\n        if (this.props.width > mobileBp && this.props.displayType === 'desktop') display = true\n        else if (this.props.width <= mobileBp && this.props.displayType === 'mobile') display = true\n\n        return (\n            <React.Fragment>\n                {this.props.product.hasTwoIntensities && this.props.ready && display &&\n                    <div className=\"intensity-switch\">\n                        <IntensitySwitchButton type=\"light\" active={this.state.active} sku={mainSku} toggle={this.toggle} toggleIntensity={this.props.toggleIntensity} selectedVariant={this.props.selectedVariant}  />\n                        <IntensitySwitchButton type=\"intense\" active={this.state.active} sku={altSku} toggle={this.toggle} toggleIntensity={this.props.toggleIntensity} selectedVariant={this.props.selectedVariant}  />\n                    </div>\n                }\n            </React.Fragment>\n        )\n    }\n\n}\n\nexport default IntensitySwitch\n","import React, { Component } from 'react'\n\nclass IntensitySwitch extends Component {\n    constructor(props) {\n        super(props)\n    }\n\n    toggleButton(sku, type) {\n        this.props.toggle(sku, type)\n    }\n\n    render() {\n        const type = this.props.type\n        const active = this.props.active === type ? 'active' : ''\n        const ariaPressed = this.props.active === type ? 'true' : 'false'\n\n        let i18nIntensity = ''\n        if (type === 'light') {\n            i18nIntensity = window.config.vto.labels.light\n        }\n        else if (type=== 'intense') {\n            i18nIntensity = window.config.vto.labels.intense\n        }\n        let i18nDescription = window.config.vto.labels.shadeSwitch\n        i18nDescription = i18nDescription.replace('{0}', i18nIntensity)\n        i18nDescription = i18nDescription.replace('{1}', this.props.selectedVariant)\n\n        return(\n            <React.Fragment>\n                <button\n                    type=\"button\"\n                    aria-pressed={ariaPressed}\n                    aria-describedby={`switch-${type}`}\n                    className={`switch ${active}`}\n                    data-sku={this.props.sku}\n                    onClick={this.toggleButton.bind(this, this.props.sku, type)}>\n                        {i18nIntensity}\n                </button>\n                <p\n                    id={`switch-${type}`}\n                    className=\"is-hidden\">\n                        {i18nDescription}\n                </p> \n            </React.Fragment>\n        )\n    }\n\n}\n\nexport default IntensitySwitch\n","import React, { Component } from 'react'\nimport Icon from '../Icon'\nimport config from '../../../../lib/config'\nimport { select } from '../../../../lib/selectors'\n\nclass ButtonAddedToBag extends Component {\n  componentDidMount() {\n    const globalCartImage = select('.js-cart')\n    this.button.focus()\n    if (globalCartImage) {\n      globalCartImage.classList.add('already-has-product')\n    }\n  }\n\n  render() {\n    let {addedToBagLabel} = config.locales.vto\n    return (\n      <button ref={node => this.button = node} className=\"button nav-item\">\n        {addedToBagLabel}\n        <Icon name=\"next\" className=\"vto-next\"/>\n        <span className=\"is-sr-only\">{addedToBagLabel}</span>\n      </button>\n    )\n  }\n}\n\nexport default ButtonAddedToBag\n","import React,  { Component } from 'react'\nimport Icon from '../Icon'\nimport config from '../../../../lib/config'\n\nclass ButtonQuickAddToBag extends Component {\n\n  render () {\n    return (\n      <button ref={node => this.button = node } className=\"button nav-item\" type=\"button\" onClick={() => this.props.quickAddToBag()}>\n        {config.locales.vto.quickAddToBagLabel}\n        <Icon name=\"next\" className=\"vto-next\" />\n      </button>\n    )\n  }\n}\n\nexport default ButtonQuickAddToBag\n","const stopThresholdDefault = 0.3;\nconst bounceDeceleration = 0.04;\nconst bounceAcceleration = 0.11;\n\nlet requestId = null;\n\n// fixes weird safari 10 bug where preventDefault is prevented\n// @see https://github.com/metafizzy/flickity/issues/457#issuecomment-254501356\nwindow.addEventListener('touchmove', function() {});\n\nexport default class Impetus {\n    constructor({\n        source: sourceEl = document,\n        update: updateCallback,\n        multiplier = 1,\n        friction = 0.92,\n        initialValues,\n        boundX,\n        boundY,\n        bounce = true,\n        onEnd\n    }) {\n        const callbackEnd = onEnd\n        var boundXmin, boundXmax, boundYmin, boundYmax, pointerLastX, pointerLastY, pointerCurrentX, pointerCurrentY, pointerId, decVelX, decVelY;\n        var targetX = 0;\n        var targetY = 0;\n        var stopThreshold = stopThresholdDefault * multiplier;\n        var ticking = false;\n        var pointerActive = false;\n        var paused = false;\n        var decelerating = false;\n        var trackingPoints = [];\n\n        /**\n         * Initialize instance\n         */\n        (function init() {\n            sourceEl = (typeof sourceEl === 'string') ? document.querySelector(sourceEl) : sourceEl;\n            if (!sourceEl) {\n                throw new Error('IMPETUS: source not found.');\n            }\n\n            if (!updateCallback) {\n                throw new Error('IMPETUS: update function not defined.');\n            }\n\n            if (initialValues) {\n                if (initialValues[0]) {\n                    targetX = initialValues[0];\n                }\n                if (initialValues[1]) {\n                    targetY = initialValues[1];\n                }\n                callUpdateCallback();\n            }\n\n            // Initialize bound values\n            if (boundX) {\n                boundXmin = boundX[0];\n                boundXmax = boundX[1];\n            }\n            if (boundY) {\n                boundYmin = boundY[0];\n                boundYmax = boundY[1];\n            }\n\n            sourceEl.addEventListener('touchstart', onDown);\n            sourceEl.addEventListener('mousedown', onDown);\n        })();\n\n        /**\n         * In edge cases where you may need to\n         * reinstanciate Impetus on the same sourceEl\n         * this will remove the previous event listeners\n         */\n        this.destroy = function() {\n            sourceEl.removeEventListener('touchstart', onDown);\n            sourceEl.removeEventListener('mousedown', onDown);\n            // however it won't \"destroy\" a reference\n            // to instance if you'd like to do that\n            // it returns null as a convinience.\n            // ex: `instance = instance.destroy();`\n            return null;\n        };\n\n        /**\n         * Disable movement processing\n         * @public\n         */\n        this.pause = function() {\n            pointerActive = false;\n            paused = true;\n        };\n\n        /**\n         * Enable movement processing\n         * @public\n         */\n        this.resume = function() {\n            paused = false;\n        };\n\n        /**\n         * Update the current x and y values\n         * @public\n         * @param {Number} x\n         * @param {Number} y\n         */\n        this.setValues = function(x, y) {\n            if (typeof x === 'number') {\n                targetX = x;\n            }\n            if (typeof y === 'number') {\n                targetY = y;\n            }\n        };\n\n        /**\n         * Update the multiplier value\n         * @public\n         * @param {Number} val\n         */\n        this.setMultiplier = function(val) {\n            multiplier = val;\n            stopThreshold = stopThresholdDefault * multiplier;\n        };\n\n        /**\n         * Update boundX value\n         * @public\n         * @param {Number[]} boundX\n         */\n        this.setBoundX = function(boundX) {\n            boundXmin = boundX[0];\n            boundXmax = boundX[1];\n        };\n\n        /**\n         * Update boundY value\n         * @public\n         * @param {Number[]} boundY\n         */\n        this.setBoundY = function(boundY) {\n            boundYmin = boundY[0];\n            boundYmax = boundY[1];\n        };\n\n        /**\n         * Executes the update function\n         */\n        function callUpdateCallback() {\n            updateCallback.call(sourceEl, targetX, targetY);\n        }\n\n        /**\n         * Creates a custom normalized event object from touch and mouse events\n         * @param  {Event} ev\n         * @returns {Object} with x, y, and id properties\n         */\n        function normalizeEvent(ev) {\n            if (ev.type === 'touchmove' || ev.type === 'touchstart' || ev.type === 'touchend') {\n                var touch = ev.targetTouches[0] || ev.changedTouches[0];\n                return {\n                    x: touch.clientX,\n                    y: touch.clientY,\n                    id: touch.identifier\n                };\n            } else { // mouse events\n                return {\n                    x: ev.clientX,\n                    y: ev.clientY,\n                    id: null\n                };\n            }\n        }\n\n        /**\n         * Initializes movement tracking\n         * @param  {Object} ev Normalized event\n         */\n        function onDown(ev) {\n            var event = normalizeEvent(ev);\n            if (!pointerActive && !paused) {\n                pointerActive = true;\n                decelerating = false;\n                pointerId = event.id;\n\n                pointerLastX = pointerCurrentX = event.x;\n                pointerLastY = pointerCurrentY = event.y;\n                trackingPoints = [];\n                addTrackingPoint(pointerLastX, pointerLastY);\n\n                // @see https://developers.google.com/web/updates/2017/01/scrolling-intervention\n                document.addEventListener('touchmove', onMove, getPassiveSupported() ? {passive: false} : false);\n                document.addEventListener('touchend', onUp);\n                document.addEventListener('touchcancel', stopTracking);\n                document.addEventListener('mousemove', onMove, getPassiveSupported() ? {passive: false} : false);\n                document.addEventListener('mouseup', onUp);\n            }\n        }\n\n        /**\n         * Handles move events\n         * @param  {Object} ev Normalized event\n         */\n        function onMove(ev) {\n            ev.preventDefault();\n            var event = normalizeEvent(ev);\n\n            if (pointerActive && event.id === pointerId) {\n                pointerCurrentX = event.x;\n                pointerCurrentY = event.y;\n                addTrackingPoint(pointerLastX, pointerLastY);\n                requestTick();\n            }\n        }\n\n        /**\n         * Handles up/end events\n         * @param {Object} ev Normalized event\n         */\n        function onUp(ev) {\n            var event = normalizeEvent(ev);\n\n            if (pointerActive && event.id === pointerId) {\n                stopTracking();\n            }\n        }\n\n        /**\n         * Stops movement tracking, starts animation\n         */\n        function stopTracking() {\n            pointerActive = false;\n            addTrackingPoint(pointerLastX, pointerLastY);\n            startDecelAnim();\n\n            document.removeEventListener('touchmove', onMove);\n            document.removeEventListener('touchend', onUp);\n            document.removeEventListener('touchcancel', stopTracking);\n            document.removeEventListener('mouseup', onUp);\n            document.removeEventListener('mousemove', onMove);\n        }\n\n        /**\n         * Records movement for the last 100ms\n         * @param {number} x\n         * @param {number} y [description]\n         */\n        function addTrackingPoint(x, y) {\n            var time = Date.now();\n            while (trackingPoints.length > 0) {\n                if (time - trackingPoints[0].time <= 100) {\n                    break;\n                }\n                trackingPoints.shift();\n            }\n\n            trackingPoints.push({x, y, time});\n        }\n\n        /**\n         * Calculate new values, call update function\n         */\n        function updateAndRender() {\n            var pointerChangeX = pointerCurrentX - pointerLastX;\n            var pointerChangeY = pointerCurrentY - pointerLastY;\n\n            targetX += pointerChangeX * multiplier;\n            targetY += pointerChangeY * multiplier;\n\n            if (bounce) {\n                let diff = checkBounds();\n                if (diff.x !== 0) {\n                    targetX -= pointerChangeX * dragOutOfBoundsMultiplier(diff.x) * multiplier;\n                }\n                if (diff.y !== 0) {\n                    targetY -= pointerChangeY * dragOutOfBoundsMultiplier(diff.y) * multiplier;\n                }\n            } else {\n                checkBounds(true);\n            }\n\n            callUpdateCallback();\n\n            pointerLastX = pointerCurrentX;\n            pointerLastY = pointerCurrentY;\n            ticking = false;\n        }\n\n\n        /**\n         * Returns a value from around 0.5 to 1, based on distance\n         * @param {Number} val\n         */\n        function dragOutOfBoundsMultiplier(val) {\n            return 0.000005 * Math.pow(val, 2) + 0.0001 * val + 0.55;\n        }\n\n\n        /**\n         * prevents animating faster than current framerate\n         */\n        function requestTick() {\n            if (!ticking) {\n                requestAnimFrame(updateAndRender);\n            }\n            ticking = true;\n        }\n\n\n        /**\n         * Determine position relative to bounds\n         * @param {Boolean} restrict Whether to restrict target to bounds\n         */\n        function checkBounds(restrict) {\n            var xDiff = 0;\n            var yDiff = 0;\n\n            if (boundXmin !== undefined && targetX < boundXmin) {\n                xDiff = boundXmin - targetX;\n            } else if (boundXmax !== undefined && targetX > boundXmax) {\n                xDiff = boundXmax - targetX;\n            }\n\n            if (boundYmin !== undefined && targetY < boundYmin) {\n                yDiff = boundYmin - targetY;\n            } else if (boundYmax !== undefined && targetY > boundYmax) {\n                yDiff = boundYmax - targetY;\n            }\n\n            if (restrict) {\n                if (xDiff !== 0) {\n                    targetX = (xDiff > 0) ? boundXmin : boundXmax;\n                }\n                if (yDiff !== 0) {\n                    targetY = (yDiff > 0) ? boundYmin : boundYmax;\n                }\n            }\n\n            return {\n                x: xDiff,\n                y: yDiff,\n                inBounds: xDiff === 0 && yDiff === 0\n            };\n        }\n\n\n        /**\n         * Initialize animation of values coming to a stop\n         */\n        function startDecelAnim() {\n            var firstPoint = trackingPoints[0];\n            var lastPoint = trackingPoints[trackingPoints.length - 1];\n\n            var xOffset = lastPoint.x - firstPoint.x;\n            var yOffset = lastPoint.y - firstPoint.y;\n            var timeOffset = lastPoint.time - firstPoint.time;\n\n            var D = (timeOffset / 15) / multiplier;\n\n            decVelX = (xOffset / D) || 0; // prevent NaN\n            decVelY = (yOffset / D) || 0;\n\n            var diff = checkBounds();\n\n            if ((Math.abs(decVelX) > 1 || Math.abs(decVelY) > 1) || !diff.inBounds){\n                decelerating = true;\n                requestId = requestAnimFrame(stepDecelAnim);\n            }\n        }\n\n\n        /**\n         * Animates values slowing down\n         */\n        function stepDecelAnim() {\n            if (!decelerating) {\n                return;\n            }\n\n            decVelX *= friction;\n            decVelY *= friction;\n\n            targetX += decVelX;\n            targetY += decVelY;\n\n            var diff = checkBounds();\n\n            if(Math.max(Math.abs(decVelX), 0.002) === 0.002 || Math.max(Math.abs(decVelY), 0.002) === 0.002){\n              window.cancelAnimationFrame(requestId)\n              callbackEnd.call(sourceEl, targetX, targetY)\n              return;\n            }\n\n            if ((Math.abs(decVelX) > stopThreshold || Math.abs(decVelY) > stopThreshold) || !diff.inBounds) {\n\n                if (bounce) {\n                    let reboundAdjust = 2.5;\n\n                    if (diff.x !== 0) {\n                        if (diff.x * decVelX <= 0) {\n                            decVelX += diff.x * bounceDeceleration;\n                        } else {\n                            let adjust = (diff.x > 0) ? reboundAdjust : -reboundAdjust;\n                            decVelX = (diff.x + adjust) * bounceAcceleration;\n                        }\n                    }\n                    if (diff.y !== 0) {\n                        if (diff.y * decVelY <= 0) {\n                            decVelY += diff.y * bounceDeceleration;\n                        } else {\n                            let adjust = (diff.y > 0) ? reboundAdjust : -reboundAdjust;\n                            decVelY = (diff.y + adjust) * bounceAcceleration;\n                        }\n                    }\n                } else {\n                    if (diff.x !== 0) {\n                        if (diff.x > 0) {\n                            targetX = boundXmin;\n                        } else {\n                            targetX = boundXmax;\n                        }\n                        decVelX = 0;\n                    }\n                    if (diff.y !== 0) {\n                        if (diff.y > 0) {\n                            targetY = boundYmin;\n                        } else {\n                            targetY = boundYmax;\n                        }\n                        decVelY = 0;\n                    }\n                }\n\n                callUpdateCallback();\n\n                requestId = requestAnimFrame(stepDecelAnim);\n            } else {\n                window.cancelAnimationFrame(requestId)\n                callbackEnd.call(sourceEl, targetX, targetY)\n                decelerating = false;\n            }\n        }\n    }\n}\n\n\n\n/**\n * @see http://www.paulirish.com/2011/requestanimationframe-for-smart-animating/\n */\nconst requestAnimFrame = (function(){\n    return window.requestAnimationFrame || window.webkitRequestAnimationFrame || window.mozRequestAnimationFrame || function(callback) {\n        window.setTimeout(callback, 1000 / 60);\n    };\n})();\n\n\nfunction getPassiveSupported() {\n    let passiveSupported = false;\n\n    try {\n        var options = Object.defineProperty({}, \"passive\", {\n            get: function() {\n                passiveSupported = true;\n            }\n        });\n\n        window.addEventListener(\"test\", null, options);\n    } catch(err) {}\n\n    getPassiveSupported = () => passiveSupported;\n    return passiveSupported;\n}\n","import React, { Component } from 'react'\nimport { connect } from 'react-redux'\nimport * as xhr from '../../../../modules/fetch'\nimport Close from '../Close'\nimport IntensitySwitch from '../IntensitySwitch'\nimport Cart from '../Cart'\nimport Notifier from '../../../../modules/notifier'\nimport Impetus from './impetus'\nimport QuickAddToBag from './QuickAddToBag'\nimport AddedToBag from './AddedToBag'\nimport {\n  cameraErrorResolvedAction,\n  vtoCameraNotAvailableAction,\n  vtoSDKCloseAction,\n  vtoReadyAction,\n  vtoCloseClickAction\n} from \"../../Redux/actions\"\nimport Error from \"../Error\"\nimport { getCollection, select, selectAll } from '../../../../lib/selectors'\nimport config from \"../../../../lib/config\"\nimport ButtonWishList from '../ButtonWishList'\nimport { VTO_PDP_STYLE_UPDATE, Manager, WINDOW_WAS_RESIZED } from \"../../../../lib/events\"\nimport PhotoCapture from '../../../cto/Components/photoCapture'\nimport CameraIcon from 'ui/cto/Components/cameraIcon'\nimport {CtoContext} from 'ui/cto/Components/ctoContext'\nimport CountdownTimer from '../../../cto/Components/countdownTimer'\nimport {isMobileScreen,isLandscape, isDesktopScreen, isPortrait, isTabletScreen, isiOS, isMobile, isWideScreen, ctoLandscapeCheck, disabledRubberBand, identifyBrowser} from '../../../../lib/helpers'\n\nexport default connect(state => state)(class Makeup extends Component {\n  width = 640\n  height = 480\n  lastProduct = null\n  previousIntensity = null\n  variantNodes = []\n  variantList = null\n  observers = []\n  interceptor = null\n  requestId = null\n  timeout = null\n  windowResized = false\n  productFirstImage = select('.product-details__media .carousel__slide #pdp-image-0-0>img')\n  _componentIsMounted = false\n  _firstSlideElId = null\n  disableScroll = null\n  screenHeightDifference = false\n  windowHeight = 0\n  isItChrome = identifyBrowser().includes('Chrome')\n  isPortraitView = isPortrait()\n\n  constructor(props) {\n    super(props)\n    this.state = {\n      code: this.props.variants.findIndex(v => v.selected).code || this.props.product.code,\n      sellableOnline: this.props.product.sellableOnline,\n      showCTA: true,\n      quickAdd: true,\n      showCart: true,\n      unavailableMsgFlag: false,\n      showUnavailableMsg: /(SOLD_OUT|OUT_STOCK)/g.test(this.props.product.stock.stockLevel),\n      errorNotificationClosed: false,\n      shadeChanged: true,\n      productTitle: select('.product-details__title', document.body).innerText,\n      is4Ombres: false,\n      windowWidth: window.innerWidth,\n      wishlistData: this.props.product.wishlistData,\n      showCTOpicture: false,\n      showTimer: false,\n      showPicture: false,\n      canvasWidth: 0,\n      canvasHeight: 0,\n      imageWidth:0,\n      imageHeight:0,\n      imgSrc: '',\n      cameraAvailable: true,\n      showRotationError: window.matchMedia(\"(orientation:portrait)\").matches != isPortrait(),\n      enableLandscapeError: true\n    }\n    this.setWishListState()\n    this.mobileCameraIcon = React.createRef()\n    this.desktopCameraIcon = React.createRef()\n  }\n\n  setVariantListRef = (node) => {\n    this.variantList = node\n  }\n\n  setInterceptorRef = (node) => {\n    this.interceptor = node\n  }\n\n  componentDidMount() {\n    const {dispatch, sdk} = this.props\n    \n    this._componentIsMounted = true\n\n    sdk.addEventListener('loaded', () => {\n      this.retrySetup()\n      const vtoContainer = select('.vto__container')\n      if (vtoContainer && !vtoContainer.className.includes('vto-window-resized')) vtoContainer.className += \" vto-window-resized\"\n      this.initialCanvas()\n      this.setState({\n        showCTOpicture: true\n      }, () => {\n        this.setCameraPosition()\n      })\n      if (isMobile()) {\n        setTimeout(() => {\n          window.scrollTo(0, 1)\n        }, 0)\n      }\n    })\n\n    sdk.addEventListener('liveCam', () => {\n      cameraErrorResolvedAction({dispatch})\n\n      const vtoIframe = this.container.querySelector('#YMK-module-iframe')\n      vtoIframe.setAttribute('aria-hidden', 'true')\n      vtoIframe.setAttribute('title', `${config.locales.vto.iframe}`)\n    })\n\n    sdk.addEventListener('noCamera', () => {\n      vtoCameraNotAvailableAction({dispatch})\n      this.setState({\n        cameraAvailable: false\n      })\n    })\n\n    sdk.addEventListener('invalidProduct', () => {\n      if (!this.state.notify && this._componentIsMounted) {\n        this.setState({notify: true})\n        Notifier.show({\n          message: window.config.vto.labels.invalid || window.config.vto.labels.unavailableShade,\n          name: window.config.vto.labels.invalid || '',\n          close: config.vto.makeup.closeButtonLabel || '',\n          onShow: () => {\n            const notificationCloseBtn = select('.js-notifier-close', select('.notifier__wrapper'))\n            setTimeout(() => notificationCloseBtn.focus(), 30)\n          },\n          onHide: () => {\n            this.setState({notify: false})\n\n            const li = this.variantNodes[this.getSelectedIndex()]\n            const vtoVariantShades = selectAll('.vto-variant-shade', select('.interceptor'))\n\n            if (li) {\n              li.setAttribute('tabindex', '-1')\n              li.focus()\n            }\n\n            if (vtoVariantShades) {\n              vtoVariantShades.forEach((el) => {\n                if (!el.getAttribute('aria-hidden')) {\n                  const imgEl = select('img', el)\n                  imgEl.setAttribute('tabindex', '0')\n                }\n              })\n            }\n          }\n        })\n      }\n      sdk.reset()\n      this.setState({\n        showCTOpicture: false\n      })\n    })\n\n    const {width, height} = this.container.getBoundingClientRect()\n    this.adjust()\n\n    sdk.init({\n      hideUI: true,\n      width,\n      height,\n      autoOpen: true\n    })\n    \n   \n    this.windowHeight = window.innerHeight\n    \n    Manager.subscribe(WINDOW_WAS_RESIZED, this.onResize)\n    \n    if (this.productFirstImage) {\n      this.productFirstImage.style.visibility = 'hidden'\n    }\n\n\n    if (this.state.productTitle && this.state.productTitle.toLowerCase().includes(\"les 4 ombres\")) {\n      this.setState({is4Ombres: true})\n    }\n\n    const initalDimensionInterval = setInterval(() => {\n      this.initialFrameDimensions(initalDimensionInterval)\n    }, 100);\n  }\n\n  onResize = () => {\n    const iFrame = select('#YMK-module-iframe', this.container)\n    if (iFrame && iFrame.contentWindow.document) {\n        if (isiOS() && isMobile()) {\n          if (this.state.windowWidth !== window.innerWidth) {\n            this.setCanvasDimensionsOnResize()\n          }\n        } else if(!(this.isItChrome && isWideScreen() && this.windowHeight - window.innerHeight < 80 && window.innerWidth == this.state.windowWidth)){ // 80 in case download notification is visible on Chrome\n          this.setCanvasDimensionsOnResize()\n        }\n      this.windowResized = true\n    }\n    const viewSwitched = Math.max(window.innerWidth, this.state.windowWidth) > 960 && Math.min(window.innerWidth, this.state.windowWidth) <= 960\n    this.windowHeight = window.innerHeight\n    const rotationValue = this.state.enableLandscapeError && (window.matchMedia(\"(orientation:portrait)\").matches != this.isPortraitView || viewSwitched)\n    this.setState({\n      windowWidth: window.innerWidth,\n      showRotationError: rotationValue\n    })\n    if (rotationValue && window.innerWidth != this.state.windowWidth) {\n      const { dispatch } = this.props\n      this.close(dispatch, true)\n    }\n  }\n\n  initialFrameDimensions(initalDimensionInterval) {\n    const iFrame = select('#YMK-module-iframe', this.container)\n    if (iFrame && iFrame.contentWindow.document) {\n      const iFrame = select('#YMK-module-iframe', this.container).contentWindow.document\n      const {width, height} = window.getComputedStyle(select('#YMK-module'))\n      select('.frame-content>div', iFrame).style.height = height\n      select('.frame-content>div', iFrame).style.width = width\n      clearInterval(initalDimensionInterval)\n    }\n  }\n\n  setWishListState = () => {\n    // dom is changing after changing the product\n    const buttonWishListDesktop = select('.product-details__flags button')\n    if (buttonWishListDesktop) {\n      const dataWishList = buttonWishListDesktop.dataset\n      const analytics = JSON.parse(dataWishList.trackWishlist)\n      this.state.vtoWishlist = {\n        accessibility: {\n          textActive: dataWishList.textActive,\n          textInactive: dataWishList.textInactive\n        },\n        analytics: {},\n        textActive: dataWishList.textWishlistActive,\n        textInactive: dataWishList.textWishlistInactive,\n      }\n    }\n  }\n  getFrameHeight = () => {\n    const vtoContainer = select('.vto__container')\n    const vto_wrapper = select('.vto__wrapper')\n    if(vtoContainer && vto_wrapper){\n      return Math.min(vtoContainer.getBoundingClientRect().height, vto_wrapper.getBoundingClientRect().height)\n    }\n  }\n  setCameraPosition = () => {\n    const cameraIcon = select('.pdp-camera .camera-icon')\n    const vto_wrapper = select('.vto__wrapper')\n    const vto_container = select('.vto__container')\n    if(cameraIcon && vto_wrapper && vto_container){\n      const frameHeight = this.getFrameHeight()\n      let addedTop = 0\n        if (frameHeight != 0) {\n          cameraIcon.style.top = 'auto'\n          addedTop = frameHeight - (vto_wrapper.offsetHeight > vto_container.offsetHeight ? 0 : 76)\n          cameraIcon.style.marginTop = `${addedTop}px`\n        }\n        const cameraIconRect = cameraIcon.getBoundingClientRect()\n        const vto_wrapperRect = vto_wrapper.getBoundingClientRect()\n        const vto_containerRect = vto_container.getBoundingClientRect()\n        const minHeightContainer = vto_wrapper.offsetHeight > vto_container.offsetHeight ? vto_containerRect : vto_wrapperRect\n        if(cameraIconRect.bottom > minHeightContainer.bottom) {\n          cameraIcon.style.marginTop = `${addedTop - 20 - (cameraIconRect.bottom - minHeightContainer.bottom)}px`\n        }\n    } \n  }\n\n  toggleTopContainerClass = (selector) => {\n    const selectedElem = select(selector)\n    const vto_wrapper = select('.vto__wrapper')\n    selectedElem && selectedElem.classList.toggle('topContainer', vto_wrapper && vto_wrapper.offsetTop < 0)\n  }\n\n  setCanvasDimensionsOnResize = () => {\n    const iFrame = select('#YMK-module-iframe', this.container).contentWindow.document\n    const canvas = select('#canvas', iFrame)\n    const {width, height} = window.getComputedStyle(select('#YMK-module'))\n    const iframeContent = select('.frame-content>div', iFrame)\n\n    iframeContent.style.height = height\n    iframeContent.style.width = width\n    const iFrameCanvas = select('#YMK-module')\n  const vtoContainer = select('.vto__container--inner')\n    if (iFrameCanvas && vtoContainer) {\n      const iframeCanvasRect = iFrameCanvas.getBoundingClientRect()\n      const iframeComputedStyles = getComputedStyle(iFrameCanvas)\n      const frameMargin = parseFloat(iframeComputedStyles.marginLeft)\n      this.setState({\n        canvasWidth: iframeCanvasRect.width + frameMargin + 'px',\n        canvasHeight: this.getFrameHeight() + 'px',\n        imageWidth: iframeCanvasRect.width + frameMargin + 'px',\n        ...(iframeCanvasRect.height != 0 && {imageHeight: iframeCanvasRect.height + 'px'})\n      })\n    }\n    if (canvas) {\n      const scale = Math.max(\n        parseInt(width, 10) / parseInt(canvas.style.width.replace('px', ''), 10),\n        parseInt(height, 10) / parseInt(canvas.style.height.replace('px', ''), 10))\n\n      canvas.style.position = 'absolute'\n      canvas.style.left = '50%'\n      canvas.style.top = '50%'\n      canvas.style.transform = `translate3d(-50%, -50%, 0) scale(${scale})`\n    }\n\n    const isMobile = isMobileScreen()\n    const pictureContainer = select('.photo_container')\n    \n    if(pictureContainer) {\n      this.toggleTopContainerClass('.vto__picture')\n      if(!isPortrait()){\n        if(pictureContainer){\n          pictureContainer.classList.add('mobile_Landscape')\n          pictureContainer.classList.remove('mobile_potrait')\n        }\n      } else if(isMobile){\n          if(pictureContainer.classList.contains('mobile_Landscape')){\n            pictureContainer.classList.remove('mobile_Landscape')\n          }\n          pictureContainer.classList.add('mobile_potrait')\n      } else{\n        pictureContainer.classList.remove('mobile_Landscape')\n      }\n    }\n    if(!(this.state.showTimer || this.state.showPicture)){\n      this.adjust()\n    } \n    \n    this.setCameraPosition()\n    Manager.publish(VTO_PDP_STYLE_UPDATE)\n  }\n\n  a11yOnVideoElem = () => {\n    const ymkContainer = select('#YMK-module')\n    const videoElem = select('#YMK-video-input', ymkContainer)\n    if(this.state.showPicture || this.state.showTimer){\n        videoElem.setAttribute('tabindex','-1')\n    } else{\n      videoElem.removeAttribute('tabindex')\n    }\n  }\n\n  initialCanvas() {\n    const iFrame = select('#YMK-module-iframe', this.container).contentWindow.document\n    const canvas = select('#canvas', iFrame)\n    if (canvas) {\n      canvas.style.opacity = 0\n      setTimeout(() => {\n        const iFrame = select('#YMK-module-iframe', this.container).contentWindow.document\n        const canvas = select('#canvas', iFrame)\n        const { width, height } = window.getComputedStyle(select('#YMK-module'))\n        if (canvas) {\n          const scale = Math.max(parseInt(width, 10) / parseInt(canvas.style.width.replace('px', ''), 10), parseInt(height, 10) / parseInt(canvas.style.height.replace('px', ''), 10))\n          canvas.style.position = 'absolute'\n          canvas.style.left = '50%'\n          canvas.style.top = '50%'\n          canvas.style.transform = `translate3d(-50%, -50%, 0) scale(${scale})` \n          canvas.style.opacity = 1\n        }\n      }, 500);\n    }\n  }\n  \n  adjust = () => {\n    let {left = 0, selectedFirstTime, shadeChanged} = this.state,\n      interceptorPos = this.interceptor.getBoundingClientRect(),\n      selectedPos = this.variantNodes.length > 0 ? this.variantNodes[this.getSelectedIndex()].getBoundingClientRect() : 0,\n      interceptorCenter = interceptorPos.left + interceptorPos.width / 2\n\n    if (shadeChanged) {\n      left += interceptorCenter - (selectedPos.left + selectedPos.width / 2)\n      left = Math.floor(left)\n\n      this.setState({\n        left,\n        animate: true,\n        shadeChanged: false\n      }, () => {\n        if (this.impetus) {\n          this.impetus.setValues(left, left)\n        }\n      })\n    }\n\n    const shadeImg = select('.vto-shade-list .selected>span>img')\n\n    if (shadeImg && selectedFirstTime) {\n      shadeImg.setAttribute('tabindex', '-1')\n      shadeImg.focus()\n    }\n  }\n\n  async close(dispatch, forcedClosed = false) {\n    const {sdk} = this.props\n\n    try {\n      let test = true\n\n      if (this.requestId) window.cancelAnimationFrame(this.requestId)\n      !forcedClosed && vtoSDKCloseAction({dispatch})\n      vtoCloseClickAction({dispatch})\n\n      select('.vto__container--inner').style.display = 'none'\n\n      const firstSlideEl = select('button', getCollection('.js-slide', select('.product-details__container'))[0])\n      if (firstSlideEl && this._firstSlideElId) {\n        firstSlideEl.id = this._firstSlideElId\n      }\n\n      while (test) {\n        const iFrame = select('#YMK-module-iframe', this.container)\n        const canvas = iFrame && (select('#canvas', iFrame.contentWindow.document) || select('.frame-content', iFrame.contentWindow.document)) ||  null\n        await new Promise(resolve => {\n          setTimeout(() => {\n            if (canvas || !!select(\".permissionDenied\", select('.vto__container--inner'))) {\n              if (!select(\".permissionDenied\", select('.vto__container--inner'))) {\n                !forcedClosed && sdk.close()\n              }\n              window.vtoClose(forcedClosed)\n              test = false\n            }\n            resolve()\n          }, 200)\n        })\n      }\n    } catch (e) {\n      console.error(e)\n    }\n    const product_detail_scroll = select('.product-details .product-details-scroll')\n    if (product_detail_scroll) {\n      product_detail_scroll.style.visibility = 'visible'\n    }\n  }\n\n  retrySetup() {\n    const {dispatch, sdk, showing} = this.props\n\n    if (sdk && showing && this._componentIsMounted) {\n      this.show()\n      vtoReadyAction({dispatch})\n      if (this.container) {\n        const vtoIframe = this.container.querySelector('#YMK-module-iframe')\n        vtoIframe.setAttribute('aria-hidden', 'true')\n        vtoIframe.setAttribute('tabindex', '-1')\n        vtoIframe.setAttribute('title', `${config.locales.vto.iframe}`)\n      }\n    }\n  }\n\n  renderAddToBag() {\n    const {product} = this.props\n    return (\n      <span>\n        {this.state.quickAdd ? <QuickAddToBag quickAddToBag={() => this.quickAddToBag(product)}/> : <AddedToBag/>}\n      </span>\n    )\n  }\n\n  renderCartIcon() {\n    return (\n      <div>\n        {this.state.quickAdd ? <Cart hasProduct=''/> : <Cart hasProduct='already-has-product'/>}\n      </div>\n    )\n  }\n\n  getRightNav() {\n    const { showCTA, showCart } = this.state\n    return (\n      <div className=\"nav-right\">\n        {showCTA ? this.renderAddToBag() : ''}\n        {showCart ? this.renderCartIcon() : ''}\n      </div>\n    )\n  }\n\n  renderWishListIcon() {\n    return (\n      <li>\n        <ButtonWishList\n          codeProduct={this.state.code}\n          accessibility={this.state.vtoWishlist.accessibility}\n          analytics={this.state.vtoWishlist.analytics}\n          textActive={this.state.vtoWishlist.textActive}\n          textInactive={this.state.vtoWishlist.textInactive}\n          wishlistData={this.state.wishlistData}/>\n      </li>\n    )\n  }\n\n  getLeftNav() {\n    return (\n      <ul className=\"nav-left\">\n        {this.renderWishListIcon()}\n      </ul>\n    )\n  }\n\n  getUnavailableMessage() {\n    return this.state.showUnavailableMsg &&\n      (\n        <ul className=\"nav-right\">\n          <li>\n            <button className=\"button nav-item\" aria-disabled=\"true\">\n               {config.locales.vto.unavailable}\n            </button>\n          </li>\n        </ul>\n      )\n   }\n\n  notifyError(error) {\n    Notifier.show({\n      message: error || window.config.vto.labels.limitationError,\n      name: window.config.vto.labels.quickAddToBagError || '',\n      close: window.config.vto.labels.close + ' ' + window.config.vto.labels.quickAddToBagError || '',\n      onHide: () => {\n        let productHeading = this.detailsHeader.querySelector('h1.product-details__head')\n        let vtoVariantShadeAriaHidden = selectAll('.vto-variant-shade', select('.interceptor'))\n\n        if (productHeading) {\n          productHeading.setAttribute('tabindex', '-1')\n          productHeading.focus()\n        }\n\n        if (vtoVariantShadeAriaHidden) {\n          vtoVariantShadeAriaHidden.forEach((el) => {\n            if (!el.getAttribute('aria-hidden')) {\n              const imgEl = select('img', el)\n              imgEl.setAttribute('tabindex', '0')\n            }\n            if (el.classList.contains('selected')) {\n              const imgEl = select('img', el)\n              this.setState({errorNotificationClosed: true}, () => {\n                imgEl.setAttribute('tabindex', '0')\n                imgEl.focus()\n              })\n            }\n          })\n        }\n      }\n    })\n  }\n\n  \n  show() {\n    const {product} = this.props\n    let code = ''\n\n    if (product.basic.is4ShadowProduct && product.is4ShadowFeatureFlipping) {\n      code = product.mainSku;\n      YMK.applyMakeupBySku(code)\n    }\n    else {\n      code = product.code;\n      YMK.applyMakeupBySku(code)\n    }\n    this.lastProduct = code \n  }\n\n  toggleIntensity(sku, type) {\n    YMK.applyMakeupBySku(sku)\n    dataLayer.push({ \n       'eventCategory': 'vto', \n       'eventAction': 'change intensity', \n       'eventLabel': type, \n       'event': 'uaevent' \n    })\n  }\n\n  componentDidUpdate() {\n    const {showing, product, variants} = this.props\n\n    if (this.lastProduct !== product.code && showing && this.lastProduct !== this.previousIntensity) {\n      this.previousIntensity = this.lastProduct\n      this.show()\n    }\n\n    if (!this.impetus || this.windowResized && !(this.state.showTimer || this.state.showPicture)) {\n\n      if (this.windowResized) {\n        this.impetus = this.impetus.destroy()\n        this.windowResized = false\n      }\n\n      const pos = this.variantList.getBoundingClientRect(),\n        centerInterceptorPos = this.interceptor.getBoundingClientRect()\n\n      // Listen for scroll events\n      this.impetus = new Impetus({\n        source: this.variantList,\n        initialValues: [this.state.left, pos.top],\n        boundY: [pos.bottom, pos.bottom],\n        boundX: [-pos.width + pos.width / variants.length, 100],\n        update: (left) => {\n          if (Math.round(left) === this.state.left)\n            return\n          this.setState({left: Math.round(left), animate: false})\n\n        },\n        onEnd: () => {\n          let center = centerInterceptorPos.width / 2 + centerInterceptorPos.left,\n            closestDistance = null,\n            shouldSelectIndex = this.getSelectedIndex()\n\n          this.variantNodes.forEach((ch, index) => {\n            let pos = ch.getBoundingClientRect(),\n              minDistance = Math.min(Math.abs(pos.left - center), Math.abs(pos.right - center))\n\n            if (minDistance < closestDistance || !closestDistance) {\n              closestDistance = minDistance\n              shouldSelectIndex = index\n            }\n          })\n          this.setWishListState()\n          this.setState({code: variants[shouldSelectIndex].code}, () => {\n            setTimeout(() => {\n              this.select(this.state.code)\n            }, 100)\n          })\n        }\n      })\n    }\n  }\n\n  getSelectedIndex() {\n    return this.props.variants.findIndex(v => v.code === this.state.code)\n  }\n\n  componentWillReceiveProps(newProps) {\n    const {vto, code} = newProps.product\n    if (vto && vto !== this.props.product.vto) {\n      const product = newProps.product\n\n      if (product.basic.is4ShadowProduct && product.is4ShadowFeatureFlipping) {\n        YMK.applyMakeupBySku(product.mainSku)\n      }\n      else {\n        YMK.applyMakeupBySku(code)\n      }\n      this.setState({\n        showCTOpicture: true\n      })\n    }\n   \n\n    this.setState({code}, () => this.adjust())\n\n    if (newProps.ready && this._firstSlideElId === null) {\n      const firstSlideEl = select('button', getCollection('.js-slide', select('.product-details__container'))[0])\n      if (firstSlideEl) {\n        const vtoContainerInnerEl = select('.vto__container--inner.makeup', select('.vto__container'))\n        if (vtoContainerInnerEl) {\n          this._firstSlideElId = firstSlideEl.id\n          vtoContainerInnerEl.id = firstSlideEl.id\n          firstSlideEl.id = ''\n        }\n      }\n    }\n    \n  }\n\n  componentWillUnmount() {\n    if (this.observers && this.observers.length) {\n      this.observers.forEach(\n        (observer, index) => observer.unobserve(this.variantNodes[index])\n      )\n    }\n\n    if (this.impetus) {\n      this.impetus = this.impetus.destroy()\n    }\n\n    document.body.classList.remove('vto-makeup')\n    document.body.removeAttribute('style')\n    if (this.productFirstImage) {\n      this.productFirstImage.style.visibility = ''\n    }\n\n    const {sdk} = this.props\n    const events = ['loaded', 'liveCam', 'noCamera', 'invalidProduct']\n\n    events.forEach(e => {\n      sdk.removeEventListener(e)\n    })\n\n    this._componentIsMounted = false\n    Manager.unsubscribe(WINDOW_WAS_RESIZED, this.onResize)\n  }\n\n  select(code) {\n    if (this.props.product.code !== code) {\n      this.setState({\n        quickAdd: true,\n        showCTA: true,\n        showCart: true,\n        unavailableMsgFlag: false,\n        selectedFirstTime: true,\n        shadeChanged: true,\n        sellableOnline: this.props.product.sellableOnline\n      }, () => onVariantChange(code))\n    }\n  }\n\n  quickAddToBag(product) {\n    const atbTemplate =\n      `<button type=\"submit\"></button>\n        <input type=\"hidden\" name=\"qty\" value=\"1\" />\n        <input type=\"hidden\" name=\"productCodePost\" value=\"${product.code}\" />\n        <input type=\"hidden\" name=\"ctaStatus\" value=\"${product.stock.stockLevel}\" />\n        <input type=\"hidden\" name=\"CSRFToken\" value=\"${ACC.config.CSRFToken}\" />`\n\n    const form = document.createElement('form')\n    form.innerHTML = atbTemplate\n    form.classList.add = 'js-addToBag'\n    form.setAttribute('action', config.webservices.cart.add)\n    form.setAttribute('method', 'post')\n\n    xhr.submit(form)\n      .then((response) => {\n        const analyticsJson = \n          {\n            \"eventLabel\": dataLayer[0].ecommerce.detail.products[0].name,\n            \"ecommerce\": {\n                \"add\": {\n                    \"products\": [dataLayer[0].ecommerce.detail.products[0]]\n                },\n                \"currencyCode\": dataLayer[0].currencyCode\n            },\n            \"event\": \"uaevent\",\n            \"eventCategory\": \"add to cart\",\n            \"eventAction\": \"VTO quickAdd\",\n            \"cartid\": response.cart_id,\n            \"cartValue\": response.cartValue\n          }\n        dataLayer.push(analyticsJson)\n        this.setState({\n          quickAdd: !this.state.quickAdd,\n          showCart: true,\n          unavailableMsgFlag: false\n        })\n      })\n      .catch((err) => {\n        if (err.statusCode === 403) {\n          if (err.stock.stockLevel === 'OUT_STOCK') {\n            this.setState({sellableOnline: false, showCart: false})\n            this.setState({unavailableMsgFlag: true, showUnavailableMsg: true})\n          } else {\n            this.setState(prevState => ({showCTA: !prevState.showCTA}))\n            this.notifyError(err.formError)\n            this.setState({unavailableMsgFlag: false, showUnavailableMsg: false})\n          }\n        }\n      })\n  }\n\n  cameraClicked = (e) => {\n    const iFrame = select('#YMK-module')\n    const iFrameHeight = iFrame.getBoundingClientRect().height \n    const isLandscapeView = isLandscape()\n    const isMobileView = isMobileScreen()\n    \n    if (iFrame) {\n      const frameMargin = parseFloat(getComputedStyle(iFrame).marginLeft)\n      this.setState({\n        canvasWidth: iFrame.getBoundingClientRect().width + frameMargin + 'px',\n        canvasHeight: this.getFrameHeight() + 'px',\n        imageWidth: iFrame.getBoundingClientRect().width + frameMargin + 'px',\n        imageHeight: this.getFrameHeight() + 'px'\n      })\n      if(iFrameHeight > window.innerHeight && (!isLandscapeView || !isMobileView)){\n        const vtoContainer = select('.vto__container')\n        if(vtoContainer){\n          this.setState({\n            imageHeight: vtoContainer.getBoundingClientRect().height + 'px'\n          })\n        } \n      }\n    }\n    dataLayer.push({ \n      'eventCategory': 'vto', \n      'eventAction': 'take picture on PDP',\n      'eventLabel': this.state.code, // shade sku value \n      'event': 'uaevent' // associated event \n    }); \n    this.setState({\n      showTimer: true\n    }, () => {\n      this.toggleTopContainerClass('.count-down')\n      this.a11yOnVideoElem()\n      if(ctoLandscapeCheck()) {\n        const scrollContainer = select('.vto__container--inner')\n        const scroller = select('.count-down')\n        if(scroller) {\n          window.scrollTo(0,scroller.offsetHeight)\n        }\n        this.disableScroll = new disabledRubberBand(scrollContainer,scroller)\n        this.disableScroll.attach()\n      }\n    })\n  }\n\n  renderVariants(selectedVariant = null) {\n    let {variants = []} = this.props,\n      {code, left, animate = false} = this.state\n\n    let style = {\n      transform: `translateX(${left}px) translateZ(0px)`\n    }\n\n    let selectedIndex = this.getSelectedIndex(),\n      visible = (i) => i < selectedIndex + 3 && i > selectedIndex - 3,\n      isPrevious = i => visible(i) && i >= 0 && i < selectedIndex,\n      isNext = i => visible(i) && i <= variants.length - 1 && i > selectedIndex\n\n    let els = variants.map((li, index) => {\n\n      let selected = code === li.code,\n        spanClassName = '',\n        ariaProperties = {},\n        imgProperties = {\n          src: li.shade.src,\n          srcSet: li.shade.srcSet,\n          onKeyDown: (e) => {\n            if (e.keyCode === 13 || e.keyCode === 32) {\n              if (this.props.product.code === li.code) {\n                this.mobileCameraIcon.current && this.mobileCameraIcon.current.props.click()\n              }\n              this.select(li.code)\n            }\n          },\n          onClick: (e) => {\n            e.preventDefault()\n            this.select(li.code)\n          },\n          role: 'button'\n        },\n        liClsName = 'vto-variant-shade'\n\n      if (selected) {\n        imgProperties = {...imgProperties, alt: `${window.config.vto.makeup.variantSelector.selected}: ${li.text.toLowerCase()}`, tabIndex: \"-1\"}\n        liClsName += ' selected'\n        ariaProperties['aria-current'] = true\n      } else if (isPrevious(index)) {\n        imgProperties = {...imgProperties, alt: `${window.config.vto.makeup.variantSelector.previous}: ${li.text.toLowerCase()}`, tabIndex: \"0\"}\n      } else if (isNext(index)) {\n        imgProperties = {...imgProperties, alt: `${window.config.vto.makeup.variantSelector.next}: ${li.text.toLowerCase()}`, tabIndex: \"0\"}\n      } else {\n        imgProperties = {...imgProperties, alt: ''}\n        if (!visible(index))\n          ariaProperties = {'aria-hidden': true}\n      }\n\n      return (\n        <li\n          ref={node => this.variantNodes[index] = node}\n          className={liClsName}\n          key={index}\n          {...ariaProperties}>\n            <span className={spanClassName} {...ariaProperties}>\n              <img {...imgProperties}/>\n            </span>\n        </li>)\n    })\n\n    return (\n      <div ref={this.setInterceptorRef} className=\"interceptor\">\n        {config.vto.makeup.enableCTOPicturePDP && this.state.showCTOpicture && (!this.state.showTimer) && this.state.cameraAvailable && <CameraIcon ref={this.mobileCameraIcon} click={this.cameraClicked} cameraMessage={`${window.config.cto.dedicated.cameraText} ${selectedVariant ? selectedVariant.text : ''}`} />}\n        <ul ref={this.setVariantListRef} className={`vto-shade-list ${animate ? 'animate' : ''}`} data-left={left}\n            style={style}>\n          {els}\n        </ul>\n      </div>\n    )\n  }\n\n  timerComplete = () => {\n    const sdk = window.YMK\n    sdk.snapshot('base64', (imgURL) => {\n      this.setState({\n        imgSrc: imgURL,\n        showTimer: false,\n        showPicture: true\n      }, () => {\n        this.disableScroll && this.disableScroll.detach()\n        this.toggleTopContainerClass('.vto__picture')        \n      })\n    })\n  }\n\n\n  updateValue = (key, val) => {\n    this.setState({[key]: val});\n  }\n\n  photoCaptureClose = () => {\n    const cameraIcon = window.innerWidth > 960 ? select('.camera-icon') :  select('.interceptor .camera-icon')\n    setTimeout(() => {\n      cameraIcon && cameraIcon.focus()\n    }, 0)\n    this.setState({\n      showPicture: false\n    }, () => {\n        this.setCanvasDimensionsOnResize()\n        this.a11yOnVideoElem()\n    })\n  }\n\n  render() {\n    const {variants = [], error, product, dispatch} = this.props\n    let { sellableOnline } = this.props.product.sellableOnline\n    let { unavailableMsgFlag, productTitle, is4Ombres } = this.state\n    let selectedIndex = this.getSelectedIndex(),\n      selectedVariant = variants[selectedIndex] || {shade: {}}\n    let polluxCondition = sessionStorage.getItem('nobrand') === 'true'\n    const isBoutiqueApp = window.jsConfigSecond.isBoutiqueApp\n    \n    const timerProps = {\n      ...(window.innerWidth > 960 ? { 'style': { width: this.state.canvasWidth, height: this.state.canvasHeight } } : { 'style': { width: window.innerWidth, height: ((isiOS() && (isLandscape() || window.innerWidth > window.innerHeight)) ? '100%' : window.innerHeight + 'px') } })\n    }\n\n    // screen.availheight to account for navigation bars in IOS\n    const imageProps = {\n      ...(window.innerWidth > 960 ? { 'style': { width: this.state.imageWidth, height: this.state.imageHeight } } : { 'style': { width: this.state.imageWidth, height: '100%' } })\n    }\n    return (\n      <CtoContext.Provider value={{state: this.state, updateValue: this.updateValue}}>\n      <div className={`vto__wrapper`  + (error && error.name ? ' error-no-camera-makeup' : '') + (this.isItChrome ? ' chrome' : '')}\n           ref={node => this.outer = node}>\n        <div {...(this.state.showTimer || this.state.showPicture) ? {\"hidden\":true, 'aria-hidden': true} : {}}>\n          <Close close={() => this.close(dispatch)}/>\n        </div>\n        { config.vto.makeup.enableCTOPicturePDP && this.state.showCTOpicture && !(this.state.showTimer || this.state.showPicture) && this.state.cameraAvailable &&\n          <div className=\"pdp-camera\">\n            <CameraIcon click={this.cameraClicked} ref={this.desktopCameraIcon} cameraMessage={`${window.config.cto.dedicated.cameraText} ${selectedVariant.text}`}  name=\"cto_camera_black\" />\n          </div>\n        }\n        {this.state.showTimer && <CountdownTimer callback={this.timerComplete}  customProps={timerProps} /> }\n        {this.state.showPicture && <PhotoCapture imgSrc={this.state.imgSrc} customProps={imageProps} callback={this.photoCaptureClose} customClass='vto__picture' backIconName={isDesktopScreen() || (window.innerWidth > 960) ? 'cto_back_white' : 'cto_back_black'}/>}\n        <div {...(this.state.showTimer || this.state.showPicture) ? {\"hidden\":true, 'aria-hidden': true} : {}}>\n          <IntensitySwitch toggleIntensity={this.toggleIntensity} product={product} ready={this.props.ready} width={this.state.windowWidth} displayType=\"desktop\" selectedVariant={selectedVariant.text} />\n        </div>\n        <div ref={node => this.container = node} id=\"YMK-module\" \n             className={`${error && error.type ? 'has-error' : ''}`} {...(this.state.showTimer || this.state.showPicture) ? {'aria-hidden': true} : {}}/> \n        {error && error.name ? <Error error={error}/> : null}\n        <div className=\"vto-shade-selector__container\" {...(this.state.showTimer || this.state.showPicture) ? {\"hidden\":true, 'aria-hidden': true} : {}}>\n          <div className=\"vto-product-info\">\n            <h1 ref={node => this.detailsHeader = node} className=\"product-details__head\">\n              <span className=\"heading vto-product-info--title \">{productTitle}</span>\n            </h1>\n            {!isBoutiqueApp && (\n              <div className=\"container\" {...(polluxCondition ? {hidden:'true'} : {})}>\n                {this.getLeftNav()}\n                {this.props.product.sellableOnline && !unavailableMsgFlag ? this.getRightNav() : this.getUnavailableMessage()}\n              </div>\n            )}\n            <p className=\"shade-title\">\n              <img alt=\"\"\n                   src={selectedVariant.shade.src}\n                   srcSet={selectedVariant.shade.srcSet}/>\n              {selectedVariant.text}\n            </p>\n\n            <IntensitySwitch toggleIntensity={this.toggleIntensity} product={product} ready={this.props.ready} width={this.state.windowWidth} displayType=\"mobile\" selectedVariant={selectedVariant.text} />\n\n            {product.sellableOnline ? <p className=\"price\" {...(polluxCondition ? {hidden:'true'} : {})}>{(product.price || '').toString().split('.')[0]}</p> : '' }\n          </div>\n          {this.renderVariants(selectedVariant)}\n        </div>\n      </div>\n      </CtoContext.Provider>\n    )\n  }\n})\n"],"sourceRoot":""}