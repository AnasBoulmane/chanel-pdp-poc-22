{"version":3,"sources":["webpack:///./patterns/scripts/ui/bottom-navigation/index.js"],"names":["decode","require","NAV_SELECTOR","COOKIE_KEY","bottomNavBar","select","onNavItemClicked","e","navLinks","selectAll","forEach","elem","link","hasAttribute","removeAttribute","currentTarget","setAttribute","updateCartCount","cartCount","cartItem","classList","toggle","addRemoveSROnly","productCount","navItem","isSR","cartCountText","config","bottomNavigation","wishlistCartCountText","innerText","srEle","document","createElement","innerHTML","add","appendChild","remove","updateStar","data","productIds","undefined","sanitizeWishlistData","nbItems","productCodeIds","length","hasWishlistedItems","wishlistItem","getCartDataFromCookie","cookieValue","readCookie","cartDataJson","indexOf","window","atob","JSON","parse","console","error","bindEvents","Manager","subscribe","PAGELOAD_WISHLIST","wishlistData","PAGELOAD_CARTCOUNT","cartData","session","cartEntryCount","cartEntriesCount","isShoppable","nonShoppable","cartItemCount","hasActiveCart","footerNotifierSpacing","notifier","footer","init","Array","from","nav","index","firstElementChild","hiddenText","contains","addEventListener"],"mappings":"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","file":"chunks/bottomNavigation.js?v=3.23","sourcesContent":["import { select, selectAll } from 'lib/selectors'\nimport { Manager,PAGELOAD_WISHLIST, PAGELOAD_CARTCOUNT } from 'lib/events'\nimport { sanitizeWishlistData } from 'lib/wishlist/wishlist-yapi'\nimport config from \"lib/config\"\nimport { read as readCookie } from 'modules/cookie'\n\nconst decode = require('urldecode')\nconst NAV_SELECTOR = \".js-bottom-navigation-bar\"\nconst COOKIE_KEY = 'active-cartStatus'\nconst bottomNavBar = select(NAV_SELECTOR)\n\nfunction onNavItemClicked(e) {\n  const navLinks = selectAll(\".navigation-links li\",bottomNavBar)\n  navLinks.forEach(elem => {\n    let link = select(\".nav-item\",elem)\n    if(link.hasAttribute(\"aria-current\")) link.removeAttribute(\"aria-current\")\n   })\n  e.currentTarget.setAttribute(\"aria-current\",\"true\")\n}\nfunction updateCartCount(cartCount) {\n  const navLinks = selectAll(\".navigation-links li\",bottomNavBar)\n  let cartItem = select(\".js-cart\",bottomNavBar)\n  if (cartItem) {\n    cartItem.classList.toggle(\"already-has-product\", cartCount > 0)\n   addRemoveSROnly(cartCount,cartItem)\n  }\n}\nfunction addRemoveSROnly(productCount, navItem) {\n  const isSR = select(\".is-sr-only\", navItem)\n  const cartCountText = `${productCount} ${config.bottomNavigation.wishlistCartCountText}`\n  if(productCount) {\n    if(isSR) { \n      isSR.innerText  =  cartCountText\n    } else {\n      let srEle = document.createElement(\"span\")\n      srEle.innerHTML = cartCountText\n      srEle.classList.add(\"is-sr-only\")\n      navItem.appendChild(srEle)\n    }\n  } else {\n    if(isSR) isSR.remove()\n  }\n}\nfunction updateStar(data) {\n  if (data.productIds === undefined)\n    data = sanitizeWishlistData(data)\n  const nbItems = data.productCodeIds.length\n  const hasWishlistedItems = nbItems > 0\n  let wishlistItem = select(\".wishlist\",bottomNavBar)\n  if (wishlistItem) {\n    wishlistItem.classList.toggle(\"already-has-product\", hasWishlistedItems)\n    addRemoveSROnly(nbItems,wishlistItem)\n  } \n}\n\nfunction getCartDataFromCookie() {\n  try {\n    const cookieValue = readCookie(COOKIE_KEY)\n    if (cookieValue) {\n      let cartDataJson = cookieValue\n      if (cookieValue.indexOf(\"{\") != 0) {\n        cartDataJson = window.atob(decode(cookieValue))\n      }\n      return JSON.parse(cartDataJson)\n    }\n  } catch(e) {\n    console.error(e)\n    return null\n  }\n  return null\n}\n\nfunction bindEvents() {\n  Manager.subscribe(PAGELOAD_WISHLIST, (wishlistData) => {\n    updateStar(wishlistData)\n  })\n  Manager.subscribe(PAGELOAD_CARTCOUNT, (cartData) => {\n    let cartCount\n    if (cartData.session) \n      cartCount = cartData.session.cartEntryCount\n    else\n    cartCount = cartData.cartEntriesCount\n\n    updateCartCount(cartCount) \n  })\n}\nfunction isShoppable() {\n  const cartData = getCartDataFromCookie()\n  const nonShoppable = select(\".js-non-shoppable\",bottomNavBar)\n  if(cartData) {\n    const cartEntriesCount = cartData ? cartData.cartItemCount : 0\n    const hasActiveCart = cartEntriesCount > 0\n    if (nonShoppable && !hasActiveCart) {\n      nonShoppable.classList.add('is-hidden')\n    }\n  } else if (nonShoppable){\n    nonShoppable.classList.add('is-hidden')\n  }\n}\nfunction footerNotifierSpacing() {\n  const notifier = select(\".notifier\")\n  const footer = select(\".js-footer\")\n  notifier.classList.add(\"is-bottom-navigation\")\n  footer.classList.add(\"is-bottom-navigation\")\n}\nfunction init() {\n  if (bottomNavBar) {\n    const navLinks = selectAll(\".navigation-links li\",bottomNavBar)\n    Array.from(navLinks, (nav, index) => {\n      const link = nav.firstElementChild\n      const hiddenText = select(\".is-sr-only\",link)\n      if(link.hasAttribute(\"title\")) link.removeAttribute(\"title\")\n        if (hiddenText) hiddenText.remove()\n    })\n    Array.from(navLinks,(nav) =>{\n      const link = select(\".nav-item\",nav)\n      if (nav.classList.contains(\"visited-nav-item\")) {\n      link.setAttribute(\"aria-current\",\"true\")\n      }\n      if(link) link.addEventListener('click',onNavItemClicked)\n    });\n    bindEvents()\n    isShoppable()\n    footerNotifierSpacing()\n  }\n}\nexport default {\n  init\n}"],"sourceRoot":""}