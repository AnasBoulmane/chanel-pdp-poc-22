{"version":3,"sources":["webpack:///./patterns/scripts/pages/account/details.js","webpack:///./patterns/scripts/pages/account/index.js","webpack:///./patterns/scripts/pages/account/order-cancel.js","webpack:///./patterns/scripts/pages/account/popinResetPassword.js","webpack:///./patterns/scripts/pages/account/preference-setting.js","webpack:///./patterns/scripts/pages/account/resetPassword.js","webpack:///./patterns/scripts/pages/account/subscription.js"],"names":["ERROR_MESSAGE_ATTRIBUTE","SUCCESS_UPDATE_EMAIL","EMAIL_INFO","UPDATE_EMAIL_FORM","COM_ADD_LABELS_SELECTOR","COUNTRY_SELECTED","config","country","toLowerCase","countryCodes","ca","au","countryCodeSDefault","details","el","toUpperCase","then","module","default","init","params","updatedEmail","addressId","formData","window","addEventListener","selectOptionBlank","visitedMarket","countryFieldOne","select","countryFieldTwo","setAttribute","defaultCountySelected","phoneCCodeEle","innerHTML","displayHiddenForm","e","button","delegateTarget","target","dataset","formToggleDisplay","targetEl","document","getElementById","hiddenEl","hiddenToggled","removeAttribute","hidden","classList","add","focusable","hideComAddressLabels","focus","displayPasswordSuccess","form","parentEl","parentElement","currentHeight","clientHeight","message","style","display","remove","nextHeight","overflow","TweenLite","to","opacity","onComplete","reset","set","clearProps","fromTo","infoText","height","handleDetailUpdate","data","formType","personalDetails","chanelUpdateContactForm","editFormData","editUpdateContactForm","isEdited","value","showSavedCommunicationAddress","hideCommunicationAddressForm","cancelBtn","htmlEmailUpdated","emailInfoBlock","body","elToUpdate","id","focusElement","querySelector","notifyUpdate","handleSubmit","formId","communicationAddressInfo","contains","getCollection","forEach","elm","parentNode","removeChild","inputLabels","inputElm","validity","valueMissing","invalid","pop","validateUserAge","checkValidity","length","preventDefault","newEmail","patternMismatch","checkEmailValidity","setCustomValidity","Manager","publish","updateProfileDetails","updateEmailDetails","updateContactDetails","updatePasswordDetails","notifier","show","name","locales","accountDetails","label","close","opener","noFocus","optionBlank","querySelectorAll","i","firstName","lastName","submitData","passwordSelector","currentEmail","trim","textError","errors","fields","sameEmailAddress","setErrorMessage","isValid","encodePasswords","onUpdateEmailAnalytics","decodePasswords","sessionStorage","setItem","countryCode","phoneNumberElm","replace","phoneNumber","isValidMobilePhone","invalidMobilePhone","notAccepted","catch","err","console","error","selectors","formElm","Promise","resolve","email","isValidEmail","fieldName","errorCode","DLKit","push","event","dl","eventAction","eventLabel","eventCategory","input","field","closest","errorMessage","selectorId","parent","area","createElement","parentField","hasAttribute","insertBefore","firstChild","errorDivElm","appendChild","paddingBottom","attribValue","getAttribute","focusFirstError","errorId","ariaDescribedby","attributes","split","filter","attr","lastIndexOf","join","unshift","dataErr","testError","dataTestError","first","xhr","manageField","province","cnDistrict","cnCity","formObj","serialize","selectedOptions","innerText","btnSubmit","communicationInfo","presetFieldValue","setCountryValue","hideComAddressLabelsDataAnalytics","cityParent","districtParent","dispatchEvent","Event","displayCommunicationForm","url","webservices","account","address","editCommunicationAddress","response","success","communicationAddressContainerElement","mainDiv","displayCommunicationFormDataAnalytics","fieldsBlockAnimate","setFormValues","countryList","onCancelButtonClicked","displayLeaveCancelDialog","dialogElm","popin","open","html","role","modifiers","manageFocus","forceInert","modal","focusBack","action","outerClose","onEscapeButtonClicked","key","keyCode","onDialogCancelButtonClicked","stopImmediatePropagation","hide","removeEventListener","find","postalCode","city","townCity","line1","line2","municipality","village","district","fieldsBlock","CLIENT_HEIGHT","onDialogLeaveButtonClicked","getCountry","options","selectedIndex","zipCodeVariation","hideDynamicFields","communicationAddressLabels","onRemoveAddressButtonClicked","removeButtonElm","parseInt","addressElm","modalAddressTemplate","modalAddressElement","modalBody","modalRemoveBtn","displayRemoveCancelDialog","removeButtonAnalytics","onModalCancelButtonClicked","closeModal","zipCode","selectCountry","index","onModalRemoveButtonClicked","removeCommunicationAddress","res","onModalShow","crossButtonElm","modalEditBtn","setTimeout","onModalOpened","dom","removeAriaLabel","modalTitle","passwordField","onModalClosed","removeBtn","title","validateUserAccount","withdrawAccount","deleteAccountModal","ongoingOrder","displayConfirmPasswordModal","onUpdatedeleteAccountAnalytics","revealPasswordChange","nodeElement","copyEl","cloneNode","selectAll","togglePassword","displayAccountDeletedModal","password","passwordForm","selectedReason","selectedReasonValue","deleteUserAccount","reason","loginPage","location","formError","onAccountDeletedAnalytics","element","displayPioneerPhoneMessage","bind","subscribe","MODAL_IS_SHOW","MODAL_IS_OPEN","MODAL_IS_CLOSED","Account","itemsContainer","accountDetailsPage","resetPasswordForm","subscriptionForm","preferencesCommunicationForm","preferencesCommunicationChannelUpdate","eachchannelSelector","unsubscribeLink","unsubscribeForm","eachCommunicationSelector","eachNewsletterAoiSelector","titleH","cardDefault","gigyaRegisterForm","homepageLinks","membersDesktopLinks","membersMobileLink","membersOpenLink","emailEl","moiMobileBag","moiDesktopBag","moiMobileLogo","moiDesktopLogo","moiImage","moiPdpLink","currentPrefChkbxStatus","firstItem","link","clickedLink","currentTarget","GAObject","dataLayer","isMobileScreen","isTabletScreen","href","concat","openApp","onerror","moiMainDiv","moiBagDiv","moiPurchaseDiv","noAvailaibleInfo","buttonId","isiOS","checkBoxElm","checked","addAddressStatus","formIsEdited","heightOfNewsletterRule","popinResetPassword","popinMergeDecision","detailPage","resetPassword","subscription","preferenceSetting","notifyAction","text","getItemFocusElement","categoryId","itemIndex","cardSectionHeading","categoryEl","selectedCardSection","firstElementChild","items","nextItem","handleManageAction","item","type","manage","postData","itemCategory","itemList","nextItemIndex","Array","prototype","indexOf","call","children","defaultTitle","defaultArticleId","cardInfo","defaultCardInto","defaultTitleSiblings","ease","Power2","easeOut","elem","scrollTo","offsetTop","updateItemsPayment","updateDom","findHiddenElm","hiddenElArticle","map","ele","defaultElem","newItemIndex","from","delay","displayMore","ordersList","allOrtClaims","li","ulTemp","orders","claimType","manageLoadMoreButton","loaderEl","next","loadmore","loadMore","api","more","ortclaim","loader","Loader","enableSyncCol","referenceEl","create","viewMoreDLPush","noop","notifierOpened","closeButtonContainer","closeButton","messageElement","nbPaymentMethod","paymentSize","handleCheckBox","loginRemember","onDefaultAddressLinkClicked","formIsActive","defaultAddressElm","origin","setAsDefault","addressesElm","onDefaultEuAddressLinkClicked","buttonElm","eu","get","sAD","pages","addresses","template","cross","page","divElm","btnConfirmEvent","onDefaultAddressEuModalOpened","props","onAddAddressFormStatus","Object","assign","onSampleReorderStart","targetElm","productCode","dataLayerGA","hasOwnProperty","JSON","parse","dlReorderSampleData","localStorage","stringify","updatePreferences","subscribed","unSubscribed","updatedPreferences","unSubscribedWithNoChnge","category","unsubscribeFomUS","unSubscribedUS","onGoBackHiddenLinkClicked","gigyaDivElm","activeTabElm","onUpdateLaListAnalytics","handleTrackItemAnalytics","productName","handleDownloadVoiceAnalytics","orderNumber","onClickReturnNote","allproduct","productNameVal","onClickPrepaidshippingLabel","allproducts","productNameValue","preferencesNewsletterElm","preferencesSetting","preferencesRulesElm","subscribePreferences","toString","toggle","chanelSubscribe","allOptionOpt","preferencesOpt","communicationBlock","checkBoxInput","getOrderCode","displayCode","displayPara","divEl","intellipostUrl","authorizationCode","displayReturnLabel","authCode","after","handleCommunicationOption","count","handleCommunicationChannels","createViewDetailsAnalytics","isClosedRequest","onblur","onload","includes","moiHeading","scrollX","scrollY","backStick","narrowHeader","isSafari","backStickStyles","getComputedStyle","zIndex","headerStep","footerElement","isInViewPort","updateSerialAnalytics","updateCorrectSerialAnalytics","submitSerialNumberForm","serialForm","submitButton","submit","destroy","cancelOrder","serviceSectionoverlayOpen","serviceSectionoverlayRestoring","handleOpenPdfs","setFocusOnErrMsg","pymtError","pdfContainer","checkIfLoginPageLoaded","loginWrapper","loginContent","loaderInner","LOGIN_FORM_LOADED","checkBackStickyFromOAB","stepperNavigation","stepperBackNavigation","stickyHeader","OAB_NAVIGATION_BAR_HEIGHT","stickyHeaderDiv","transform","top","ACCOUNT_ADD_ADDRESS_STATUS","chanelandmoiPLP","chanelwarrantyClose","chanelwarrantyTitle","chanelwarrantyParagraphOne","chanelwarrantyParagraphTwo","chanelwarrantyParagraphThree","ACC","encodedContextPath","chanelwarrantyParagraphUrlText","chanelandmoiPLPTitle","popinModal","chanelrestoringClose","chanelrestoringTitle","chanelrestoringParagraphOne","chanelrestoringParagraphTwo","chanelrestoringParagraphThree","chanelrestoringsubTitle","chanelrestoringsubTitleSubtext","chanelrestoringLabelOne","commonResourcePath","chanelrestoringLabeltextOne","chanelrestoringLabelTwo","chanelrestoringLabeltextTwo","chanelrestoringLabelThree","chanelrestoringLabeltextThree","chanelrestoringLabelFour","chanelrestoringLabeltextFour","chanelrestoringLabelFive","chanelrestoringLabeltextFive","popinWrapper","servicesToggleInfo","cardtextInfo","cardImage","servicecardbutton","hideTextinfo","displayImage","cardTilebutton","j","k","l","orderNumberEl","orderType","CancelOrder","constructor","clickedElm","isWideScreen","links","tabIndexToZero","orderDetailUrl","buttonClose","buildTemplate","orderCancelled","closePopUp","popUpHeading","popUpMessage","popUpMessageApple","btnConfirm","closeBtn","onOpenPopin","setDomElements","cancelOrderDLPush","onConfirmCancelDlPush","onCloseBtnDlPush","popinEl","buttonContinue","onCloseAnchorDlPush","anchorClose","buttonConfirmOrder","buttonValidate","onConfirmCancel","confirmPopUp","orderCurrency","popinText","confirmedMessage","userEmail","continueBtn","redirectToOrderPageDlPush","hiddenSpan","closePopUpConfirmed","onEscapeKeyClicked","redirectToOrderPageOnEscape","notChangeTabIndex","ecommerce","initCancelOrder","COOKIE_KEY","POPIN_SELECTOR","FORM_SELECTOR","isVisible","followRedirect","userData","handleFromLogin","removeCookie","showPopin","handleFromOPC","hiddenEmailEl","sourceEl","formContainerEl","passwordForcedUpdate","fixRevealPassword","closeButtonDataTest","checkAPI","json","inEmailEl","outEmailEl","handleSuccess","redirectURL","forceUpdate","promptPasswordMode","readCookie","CHECK_API","handlePreferenceSetting","newsletterElm","newsletterRulesElm","isChecked","pageName","autoAlpha","eventCallback","gigyaEmailStatusElm","handleResetPassword","successMessage","handleSubmitResetPassword","resetPasswordPage","getElementsByClassName","lastUsedEmail","emailId","resetPasswordEmail","FIELD_SELECTOR","FIELD_SELECTOR_COMMUNICATION","COMMUNICATION_CHANNEL_SELECTOR","FIELD_SELECTOR_PREFERENCES","TITLE_SELECTOR","CHECKBOX_SELECTOR","checkboxSelectors","checkboxesAOI","checkboxEmail","euEmailCheckbox","elementCC","elementAOI","prefContent","inert","paramsData","inputs","userMedias","checkedInputs","mainCheckbox","isPushRequired","preferenceCount","checkCount","checkErrors","handleSubscriptionUpdate","loaderButton","unset","handlePreferences","communicationChannelElm","consentList","listItem","seeMoreButton","toggleSeeMore","seeMoreBtn","seeMoreContent","nextElementSibling","conciergeDelivery","seeLessBtn","marketingCom","unsubscribeCommunication","sectionPreferences","onNotificationClosed","titleElm","handleCheckbox","arrCheckedInputs","check","isUnsubscribed","handleMailCheckbox","checkbox","selector","inputMarketing","checkboxesAOIUK","checkboxesCC","handleInputChange","checkIfOneAOIUKChecked","disabled","handleCheckBoxCC","checkboxes","newsLetter","checkIfAOIUKChecked","boxChecked","checkIfCChecked","checkIfOneCChecked","removeErrorMsg","createErrorMessage","preferencesErrorCC","a11yDescription","preferencesErrorAOI","msg","insertAdjacentElement","elements","communicationCC","preventScroll","isAreaSelected","some","isCCSelected","unsubscribeFormBtn","click"],"mappings":"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","file":"chunks/account.js?v=3.23.0","sourcesContent":["import bind from 'delegate'\nimport * as xhr from 'modules/fetch'\nimport notifier from 'modules/notifier'\nimport config from 'lib/config'\nimport {decodePasswords, encodePasswords, focusElement, isValidEmail, isValidMobilePhone} from 'lib/helpers'\nimport {select, selectAll, closest, getCollection} from 'lib/selectors'\nimport {Manager, MODAL_IS_OPEN, MODAL_IS_SHOW, MODAL_IS_CLOSED} from 'lib/events'\nimport popin from 'modules/popin'\nimport zipCodeVariation from '../account/zip-code-variation'\nimport {validateUserAge} from 'ui/forms/dob-errors-validation'\n\nconst ERROR_MESSAGE_ATTRIBUTE = 'data-error-message'\nconst SUCCESS_UPDATE_EMAIL = '#success-update-email'\nconst EMAIL_INFO = '#email-info'\nconst UPDATE_EMAIL_FORM = 'chanelUpdateEmailForm'\nconst COM_ADD_LABELS_SELECTOR = 'communicationAddressLabels'\nconst COUNTRY_SELECTED = config.country.toLowerCase()\nconst countryCodes = {ca:\"+1 (CA)\", au:\"+61 (AU)\"} \n\nconst countryCodeSDefault = countryCodes[COUNTRY_SELECTED]\n\nexport default function details(el) {\n  if (config.country.toUpperCase() === 'CN') {\n    import ('./cn-address').then((module) => {\n        module.default.init()\n    })\n  }\n  const params = {\n    updatedEmail: false,\n    addressId: null,\n    formData: null\n  }\n  window.addEventListener('DOMContentLoaded', selectOptionBlank)\n\n  if(window.config.visitedMarket === 'RU'){\n    const countryFieldOne = select('[id=\"edit-address.countryCode1\"]')\n    const countryFieldTwo = select('[id=\"edit-address.countryCode2\"]') \n    if(countryFieldOne && countryFieldTwo) {\n      countryFieldOne.setAttribute('aria-required', true) \n      countryFieldTwo.setAttribute('aria-required', true)\n    }        \n  }\n\n  if(window.config.visitedMarket === 'CA'){\n\t const defaultCountySelected = select('[id=\"edit-address.countryCode1-GB\"]')\n    const phoneCCodeEle = select('span', select('.selectbox__wrapper.phone_selectbox'))\n    if (phoneCCodeEle && defaultCountySelected) {\n      phoneCCodeEle.innerHTML = countryCodeSDefault\n    }\n  }\n  \n  function displayHiddenForm(e) {\n    const button = e.delegateTarget\n    const target = button.dataset.formToggleDisplay\n    const targetEl = document.getElementById(target)\n    const hiddenEl = button.dataset.hiddenToggled\n    button.removeAttribute('aria-checked')\n\n\n    if (targetEl.hidden) {\n      targetEl.removeAttribute('hidden')\n    }\n    if (hiddenEl) {\n      button.classList.add('is-hidden')\n    }\n    // Focus stuff\n    let focusable = select('select:not([hidden]), input:not([hidden]), button:not([hidden])', targetEl)\n    if (!focusable) {\n      targetEl.setAttribute('tabindex', -1)\n      focusable = targetEl\n    }\n\n    if (target === \"addcommunicationAddress\") {\n      hideComAddressLabels()\n    }\n\n    focusable.focus()\n  }\n\n  function displayPasswordSuccess(form) {\n    const parentEl = form.parentElement\n    const currentHeight = parentEl.clientHeight\n\n\n    const message = document.getElementById('passwordSuccess')\n\n    form.style.display = 'none'\n    message.classList.remove('is-hidden')\n    message.removeAttribute('aria-hidden')\n\n    const nextHeight = parentEl.clientHeight\n\n    form.removeAttribute('style')\n\n    parentEl.style.overflow = 'hidden'\n\n    TweenLite.to(form, 0.2, {\n      opacity: 0,\n      onComplete: () => {\n        form.classList.add('is-hidden')\n        form.setAttribute('aria-hidden', true)\n        form.reset()\n        TweenLite.set(form, { clearProps: 'all' })\n      }\n    })\n\n    TweenLite.fromTo(message, 0.2, {\n      opacity: 0\n    }, {\n      opacity: 1,\n      onComplete: () => {\n        TweenLite.set(message, { clearProps: 'all' })\n        const infoText = select('.password-success-msg', message)\n\n        if (infoText) {\n          infoText.focus()\n        }\n        else {\n          message.setAttribute('tabindex', -1)\n          message.focus()\n        }\n      }\n    })\n\n    TweenLite.fromTo(parentEl, 0.5, {\n      height: currentHeight\n    }, {\n      height: nextHeight,\n      onComplete: () => {\n        TweenLite.set(parentEl, { clearProps: 'all' })\n      }\n    })\n  }\n\n  function handleDetailUpdate(data, form) {\n    const formType = form.dataset.formType\n    const personalDetails = data.chanelUpdateContactForm\n    const editFormData = data.editUpdateContactForm\n    \n    if(personalDetails) {\n       const isEdited = select('input[id=\"edited\"]')\n       isEdited.value = \"saved\"\n       const showSavedCommunicationAddress = select('div[id=\"communicationAddressContainer\"]')\n       if (showSavedCommunicationAddress) {\n         showSavedCommunicationAddress.innerHTML = personalDetails\n         showSavedCommunicationAddress.classList.remove('is-hidden') \n       }\n \t     const hideCommunicationAddressForm = select('div[id=\"addcommunicationAddress\"]')\n       if (hideCommunicationAddressForm) {\n \t       hideCommunicationAddressForm.classList.add('is-hidden')\n       }\n \t     const cancelBtn = select('button[id=\"cancelButton\"]')\n       if (cancelBtn) {\n \t       cancelBtn.classList.add('is-hidden')\n       }\n \t}\n\n    if (data.htmlEmailUpdated) {\n      params.updatedEmail = true\n      const emailInfoBlock = select(EMAIL_INFO, document.body)\n      const elToUpdate = select(SUCCESS_UPDATE_EMAIL, document.body)\n\n      emailInfoBlock.setAttribute('hidden', true)\n      elToUpdate.innerHTML = data.htmlEmailUpdated\n    }\n    if (formType !== 'password') {\n      if (form.id === 'chanelUpdateEmailForm') {\n        const elToUpdate = select(SUCCESS_UPDATE_EMAIL, document.body)\n        data.focusElement = elToUpdate\n      }\n\n      else {\n        data.focusElement = form.querySelector('[type=\"submit\"]')\n      }\n\n\n      notifyUpdate(data)\n      return\n    }\n\n    displayPasswordSuccess(form)\n  }\n\n  function handleSubmit(e) {\n    const form = e.delegateTarget\n    const formId = (form ? form.id : '')\n    \n    const communicationAddressInfo = select('div[id=\"addcommunicationAddress\"]')\n    if (communicationAddressInfo) {\n      if (communicationAddressInfo.classList.contains('is-hidden')) {\n    \t getCollection('p.error', communicationAddressInfo).forEach(elm => elm.parentNode.removeChild(elm))\n\t\t   getCollection('.has-error',communicationAddressInfo).forEach((elm) => elm.classList.remove('has-error'))\n\n       const inputLabels = getCollection('input', communicationAddressInfo)\n\t\t   inputLabels.forEach (inputElm => {\n\t\t\t  if (inputElm.value === \"\") {\n\t\t\t\t   if (inputElm.validity.valueMissing) {\n\t\t\t\t     form.invalid.pop(inputElm)\n\t\t\t\t   }\n\t\t\t   }\n\t\t   })\n     }\n   }\n   \n    if (formId === \"updateProfileForm\") {\n      if (window.config.visitedMarket === 'KR' ) {\n        validateUserAge()\n      }\n      form.checkValidity()\n      if (form.invalid.length) {\n        e.preventDefault()\n        return\n      }\n    }\n    \n    if (form.invalid.length) {\n      // check if the form is 'update email' , new email is not empty and matches the pattern, we send check email validation again\n      const newEmail = select('[name=\"newEmail\"]', form)\n      if (formId === UPDATE_EMAIL_FORM && newEmail && !newEmail.validity.valueMissing && !newEmail.validity.patternMismatch) {\n        checkEmailValidity(newEmail, form)\n      }\n      else if (formId === UPDATE_EMAIL_FORM && newEmail && newEmail.validity.valueMissing) {\n        // Check if the new email field is empty after first submit, update error message if needed\n        newEmail.setCustomValidity('')\n        newEmail.checkValidity()\n        Manager.publish('CHECK_ERROR', newEmail)\n      }\n      else {\n        return\n      }\n    }\n\n    e.preventDefault()\n\n    switch (formId) {\n      case 'updateProfileForm': updateProfileDetails(form)\n        break\n      case 'chanelUpdateEmailForm': updateEmailDetails(form)\n        break\n      case 'updateContactForm': updateContactDetails(form)\n        break\n      case 'updatePasswordForm': updatePasswordDetails(form)\n        break\n      default:\n        break\n    }\n  }\n\n  function notifyUpdate(data) {\n    if (!data.message) {\n      return\n    }\n\n    notifier.show({\n      name: config.locales.notifier.accountDetails.label,\n      message: data.message,\n      close: config.locales.notifier.accountDetails.close,\n      opener: data.focusElement,\n      noFocus: !document.body.classList.contains('is-using-keyboard')\n    })\n  }\n\n  function selectOptionBlank(e) {\n    // With 'select > option[value=\"blank\"]'\n    const optionBlank = e.target.querySelectorAll('select option[value=\"blank\"]')\n    for (let i = 0; i < optionBlank.length; i++) {\n      optionBlank[i].remove()\n    }\n  }\n\n  /**\n   * Manage profile section\n   * @param form {HTMLFormElement}: current selected form\n   */\n  function updateProfileDetails(form) {\n    const firstName = select('[name=\"firstName\"]', form)\n    const lastName = select('[name=\"lastName\"]', form)\n    if(firstName.value !== \"\" && lastName.value !== \"\"){\n      // Send data\n      submitData(form)\n    }\n  }\n\n  /**\n   * Manage contact section\n   * @param form {HTMLFormElement}: current selected form\n   */\n  function updateEmailDetails(form) {\n    const passwordSelector = ['input#login-password']\n\n    const currentEmail = select('[name=\"currentEmail\"]', form)\n    const newEmail = select('[name=\"newEmail\"]', form)\n\n    if (newEmail && currentEmail && newEmail.value.toLowerCase().trim() === currentEmail.value) {\n      const textError = config.locales.errors.form.fields.sameEmailAddress\n      setErrorMessage(newEmail, textError)\n      return\n    }\n    if (!newEmail.validity.valueMissing && !newEmail.validity.patternMismatch) {\n      checkEmailValidity(newEmail, form)\n      .then((isValid) => {\n        // check if isValid is true and not an object\n        if (isValid === true) {\n          // Encode password before sending to the BE and update Analitics\n          encodePasswords(passwordSelector, form)\n          onUpdateEmailAnalytics()\n  \n          // Send data\n          submitData(form)\n          // Restore passwords once they are sent\n          decodePasswords(passwordSelector, form)\n          window.sessionStorage.setItem('lastUsedEmail', newEmail.value)\n        }\n        else {\n          // if we get an object, there's an error and we focus on the newEmail field\n          newEmail.focus()\n          return false\n        }\n      })\n    }\n  }\n\n  /**\n   * Manage contact section\n   * @param form {HTMLFormElement}: current selected form\n   */\n  function updateContactDetails(form) {\n    let countryCode = select('[name=\"countryCode1\"]', form)\n    let phoneNumberElm = select('[name=\"phone1\"]', form)\n\n\n    if ((window.config.visitedMarket === 'GB' || window.config.visitedMarket === 'JP' || window.config.visitedMarket === 'CA') && phoneNumberElm && countryCode.value && phoneNumberElm.value) {\n      countryCode = countryCode.value.replace(/[^0-9]/g, '')\n      let phoneNumber = phoneNumberElm.value.replace(/[^0-9]/g, '')\n      return isValidMobilePhone(countryCode, phoneNumber)\n        .then(function (isValid) {\n          if (!isValid) {\n            // if we get an object, there's an error and we focus on the phone field\n            const textError = config.locales.errors.form.fields.invalidMobilePhone.notAccepted\n            setErrorMessage(phoneNumberElm, textError)\n            phoneNumberElm.focus()\n          } else {\n            phoneNumberElm.setCustomValidity('')\n            submitData(form);\n          }\n        })\n        .catch((err) => {\n          console.error(\"an error occurred during the verification of phone number\")\n        })\n    }\n    submitData(form);\n  }\n\n  /**\n   * Manage password section\n   * @param form {HTMLFormElement}: current selected form\n   */\n  function updatePasswordDetails(form) {\n    const selectors = ['input#password-currentPassword', 'input#password-newPassword']\n\n    // Encode (current and new password) to base64\n    encodePasswords(selectors, form)\n\n    // Send data\n    submitData(form)\n\n    // Restore passwords once they are sent\n    decodePasswords(selectors, form)\n  }\n  /**\n   * Called before validation process\n   * That mean errors must be managed manually\n   * @param data {object}: returned by Gigya process\n   * @param data {HTMLFormElement}: form element\n   * @param data {HTMLElement}: email element\n   * @returns {Promise<any> | Promise}:\n   *  resolve + error parameter => make validation KO\n   *  resolve + empty object => make validation OK\n   */\n  function checkEmailValidity(newEmail, formElm) {\n    return new Promise((resolve) => {\n      const email = newEmail.value\n      return isValidEmail(email, true)\n        .then((isValid) => {\n          if (!isValid) {\n            // mark email element as invalid\n            // and check also others fields\n            newEmail.setCustomValidity('email.invalid')\n            formElm.checkValidity()\n\n            resolve({ fieldName: 'email', errorCode: 400027 })\n          } else {\n            newEmail.setCustomValidity('')\n            Manager.publish('CHECK_ERROR', formElm)\n            resolve(isValid)\n          }\n        })\n    })\n  }\n\n  /**\n   * Update analytics on Update Email submit button click\n   */\n  function onUpdateEmailAnalytics() {\n    window.document.DLKit.push('on-tracking', {\n      event: window.config.dl.event,\n      eventAction: 'update',\n      eventLabel: 'update email address',\n      eventCategory: 'contact'\n    })\n  }\n\n  /**\n   * Set custom error messages\n   */\n\n  function setErrorMessage(input, message) {\n    if (!input) {\n      return\n    }\n    const field = input.closest('.field')\n\n    input.setAttribute('aria-invalid', true)\n\n    if (field) {\n      field.classList.add('has-error')\n    }\n\n    // Write error message\n    errorMessage(input, message)\n  }\n\n    /**\n   * Build and applied a message error and applied some accessibility stuff\n   * @param input {HTMLInputElement}: element to check\n   * @param message {string}: error message to applied to error Element\n   */\n  function errorMessage(input, message) {\n    if (!input) {\n      return\n    }\n\n    const selectorId = '.js-custom-error'\n    const parent = input.closest('.field') || input.parentNode\n    let area = parent.querySelector('.error')\n\n    // Create error message if not there\n    if (!area) {\n      area = document.createElement('p')\n      area.classList.add('error')\n      area.setAttribute('tabindex', '-1')\n      area.innerHTML = message\n\n      const parentField = parent.closest('.fields-block')\n\n      if (input.hasAttribute('data-error-before')) {\n        parent.insertBefore(area, parent.firstChild)\n      }\n      else if (input.hasAttribute('data-error-custom')) {\n        // Case where the p should append in a special div\n        const errorDivElm = input.closest(selectorId) || select(selectorId, parent)\n        errorDivElm.appendChild(area)\n        // add animation for paddings in order to prevent fields from overlapping\n        if (parentField) {\n          TweenLite.fromTo(parent, .5, { paddingBottom: 0 }, { paddingBottom: area.clientHeight })\n        }\n      }\n      else {\n        parent.appendChild(area)\n      }\n\n      const attribValue = input.getAttribute('data-error-custom')\n      if (attribValue && attribValue !== 'ignore-focus') {\n        area.focus()\n      }\n    }\n    else {\n      area.innerHTML = message\n    }\n    focusFirstError()\n\n    // Create aria-describedby attribute and store current attribute\n    const id = input.id\n\n    if (id) {\n      const errorId = `error-${id}`\n      let ariaDescribedby = input.getAttribute('aria-describedby')\n\n      if (ariaDescribedby) {\n        const attributes = ariaDescribedby.split(' ').filter((attr) => attr.lastIndexOf('error-', 0) !== 0)\n\n        if (attributes.length) {\n          input.dataset.ariaDescribedby = attributes.join(' ')\n        }\n\n        attributes.unshift(errorId)\n        ariaDescribedby = attributes.join(' ')\n      }\n      else {\n        ariaDescribedby = errorId\n      }\n\n\n      const dataErr = input.dataset.testError\n      const dataTestError = dataErr || errorId\n      area.setAttribute('data-test', dataTestError)\n\n      area.setAttribute('id', errorId)\n\n      input.setAttribute('aria-describedby', ariaDescribedby)\n    }\n  }\n\n  function focusFirstError(form) {\n    // Focus on first error\n    const first = select(`[${ERROR_MESSAGE_ATTRIBUTE}], [aria-invalid]`,form)\n    if (!first) {\n      return\n    }\n    if (first.hasAttribute(ERROR_MESSAGE_ATTRIBUTE)) {\n      first.setAttribute('tabindex', '-1')\n    }\n\n    first.focus()\n  }\n\n\n  /**\n   * Submit data\n   * @param form {HTMLFormElement}: current selected form\n   */\n  function submitData(form) {\n    if (window.config.visitedMarket != 'CN' ) {\n    xhr.submit(form)\n      .then(data => handleDetailUpdate(data, form))\n      .catch(err => {\n       // console.error(err)\n      })\n    } else {\n      xhr.submit(form, (form && form.id === \"updateContactForm\")? {data : manageField(form)} : {} )\n      .then(data => handleDetailUpdate(data, form))\n      .catch(err => {\n       // console.error(err)\n      })\n    }\n  }\n\n  function manageField(form) {\n    const province = select('[id=\"address.provincia\"]')\n    const cnDistrict = select('[id=\"address.district\"]')\n    const cnCity = select('[id=\"address.townCity\"]')\n    let formObj = form.serialize()\n    formObj['provincia'] = province.selectedOptions[0].innerText\n    formObj['district'] = cnDistrict.selectedOptions[0].innerText\n    formObj['city'] = cnCity.selectedOptions[0].innerText\n    return formObj\n  }\n\n  /**\n   * \n   * Hide Communication Address Labels\n   */\n  function hideComAddressLabels() {\n    const btnSubmit = select('button[id=\"btnSubmit\"]')\n\t  if (btnSubmit) {\n\t\t   btnSubmit.classList.remove('is-disabled')\n\t  }\n\n\t  const communicationInfo = document.getElementById(COM_ADD_LABELS_SELECTOR);\n\t  communicationInfo.classList.add('is-hidden')\n\t  const cancelBtn = select('button[id=\"cancelButton\"]')\n\t  cancelBtn.classList.remove('is-hidden')\n    if(window.config.visitedMarket === 'CN') {\n      presetFieldValue()  \n    }\n    setCountryValue()\n\t  hideComAddressLabelsDataAnalytics() \n  }\n\n  function presetFieldValue() {\n    const province = select('[id=\"address.provincia\"]')\n    const cnCity = select('[id=\"address.townCity\"]')\n    const cnDistrict = select('[id=\"address.district\"]')\n    const cityParent = document.getElementById(\"address.townCity\").parentElement\n    const districtParent = document.getElementById(\"address.district\").parentElement\n    province.value = null\n    province.dispatchEvent(new Event(\"change\"))\n    cnCity.value = null\n    cnDistrict.value = null\n    cnCity.dispatchEvent(new Event(\"change\"))\n    cnDistrict.dispatchEvent(new Event(\"change\"))\n    cityParent.classList.add('is-disabled')\n    districtParent.classList.add('is-disabled')\n    province.focus()\n  }\n\n  \n  /**\n   * \n   * Add a communication address button click analytics\n   */\n  \n  function hideComAddressLabelsDataAnalytics() {\n\t  window.document.DLKit.push('on-tracking', {\n\t      event: window.config.dl.event,\n\t      eventAction: 'add',\n\t      eventLabel: 'communication address',\n\t      eventCategory: 'my account'\n\t    })\n  }\n  \n  /**\n   * \n   * Display communication address form on Edit\n   */\n  function displayCommunicationForm() {\n\t  \n\t  const url = `${window.config.webservices.account.address.editCommunicationAddress}`\n\t\t  \n\t  xhr.get(url)  \n\t      .then((response) => {\n           if (response.success == true) {\n\t    \t      params.formData = response.editUpdateContactForm\n\n              const isEdited = select('input[id=\"edited\"]')\n\t    \t        if (isEdited && isEdited.value === \"\") {\n\t    \t            isEdited.value = \"saved\"\n                }   \n\t  const btnSubmit = select('button[id=\"btnSubmit\"]')\n\t  if(btnSubmit) {\n\t\t  btnSubmit.classList.remove('is-disabled')\n\t  }\n\t  \n\t  const communicationAddressContainerElement = select('div[id=\"communicationAddressContainer\"]')\n    if(communicationAddressContainerElement) {\n\t    communicationAddressContainerElement.classList.add('is-hidden') \n    }\n\t  const communicationInfo = document.getElementById(COM_ADD_LABELS_SELECTOR);\n\t  communicationInfo.classList.add('is-hidden')\n\t  const mainDiv = select('div[id=\"communicationAddressForm\"]')\n\t  mainDiv.classList.remove('is-hidden')\n\t  const communicationAddressInfo = select('div[id=\"addcommunicationAddress\"]')\n\t  communicationAddressInfo.classList.remove('is-hidden')\n\t  \n\t  const cancelBtn = select('button[id=\"cancelButton\"]')\n\t  cancelBtn .classList.remove('is-hidden')\n    displayCommunicationFormDataAnalytics()\n    if (window.config.visitedMarket != 'CN' ) {\n      fieldsBlockAnimate()\n    }\n\t  setFormValues()\n    if (communicationAddressInfo) {\n\t    const countryList = select('select[id=\"communication-country\"]')\n      const province = select('[id=\"address.provincia\"]')\n\t    if (countryList) {\n\t\t     countryList.focus()\n\t    }\n      if(province && window.config.visitedMarket == 'CN') {\n        province.focus()\n      }\n\t  }\n   }\n })\n}\n  \n  /**\n   * \n   * Edit button Analytics\n   */\n  function displayCommunicationFormDataAnalytics(){\n\t  window.document.DLKit.push('on-tracking', {\n\t      event: window.config.dl.event,\n\t      eventAction: 'edit',\n\t      eventLabel: 'communication address',\n\t      eventCategory: 'my account'\n\t    })\n  }\n  \n  /**\n   * \n   * Handle cancel button click \n   */\n  function onCancelButtonClicked() {\n\t    displayLeaveCancelDialog()\n  }\n  \n  \n  /**\n   * \n   * Method to open pop up \n   */\n  function displayLeaveCancelDialog() {\n\t    \n\t   const dialogElm = select('div[id=\"js-modal-prompt-leave-modify-address-form\"]', el)\n\t    popin.open({\n\t      html: dialogElm.innerHTML,\n\t      role: 'dialog',\n\t      modifiers: '',\n\t      opener: null,\n\t      manageFocus: false,\n\t      forceInert: true,\n\t      modal: false,\n        focusBack: false,\n\t      action: 'dialogLeaveCancel',\n\t      outerClose: false\n\t    })\n\t    // Catch keyboard inputs (enter, a, b, esp ...)\n\t    window.addEventListener('keydown', onEscapeButtonClicked)\n   }\n  \n  \n    function onEscapeButtonClicked(e){\n\t    if ((e.key === 'Escape'|| e.key === 'Esc'|| e.keyCode === 27)) {\n\t      onDialogCancelButtonClicked(e)\n\t    }\n\t}\n   /**\n     * Popup is closed if want to continue editing address\n     * \n     */\n    function onDialogCancelButtonClicked(e) {\n\t  e.stopImmediatePropagation()\n\t  popin.hide()\n\t  window.removeEventListener('keydown', onEscapeButtonClicked)\n   }\n    \n    \n   /**\n    * set edited values\n    * \n    */\n    function setFormValues() {\n\t   const communicationAddressInfo = select('div[id=\"addcommunicationAddress\"]')\n\t   const inputLabels = getCollection('input.label-input__input', communicationAddressInfo)\n\t\t  inputLabels.find(function (inputElm) {\n\t\t\t  inputElm.focus()\n\t\t\t  \n        if (params.formData.postalCode != \"\") {\t\t\t\n\t\t\t    const postalCode = select('input[id=\"address.postcode\"]')\n          if (postalCode) {\n\t\t\t      postalCode.value = params.formData.postalCode\n          }\n        }\n\n        if (params.formData.city != \"\") {\n\t\t\t    const townCity = select('input[id=\"address.townCity\"]')\n          if (townCity) {\n\t\t\t      townCity.value = params.formData.city\n          }\n        }\n\n        if (params.formData.line1 != \"\") {\n\t\t\t    const line1 = select('input[id=\"address.line1\"]')\n          if (line1) {\n\t\t\t      line1.removeAttribute('disabled')\n\t\t\t      line1.value = params.formData.line1\n          }\n        }\n\t\t\t  \n\t\t\t  if (params.formData.line2 != \"\") {\n\t\t\t    const line2 = select('input[id=\"address.line2\"]')\n          if (line2) {\n\t\t\t      line2.removeAttribute('disabled')\n\t\t\t      line2.value = params.formData.line2\n          }\n\t\t\t  }\n\t\t\t  \n\t\t\t  if (params.formData.province != \"\" ) {\n\t\t\t    const province = select('input[id=\"address.provincia\"]')\n          if (province) {\n\t\t\t      province.value = params.formData.province\n          }\n\t\t\t  }\n\t\t\t  \n\t\t\t  if (params.formData.municipality != \"\") {\n\t\t\t    const municipality = select('input[id=\"address.municipality\"]')\n          if (municipality) {\n\t\t\t       municipality.value = params.formData.municipality\n          }\n\t\t\t  }\n\t\t\t  \n\t\t\t  if (params.formData.village != \"\") {\n\t\t\t    const village = select('input[id=\"address.village\"]')\n          if (village) {\n\t\t\t      village.value = params.formData.village\n          }\n\t\t\t  }\n\t\t\t  \n\t\t\t  if (params.formData.district != \"\") {\n\t\t\t    const district = select('input[id=\"address.district\"]')\n          if (district) {\n\t\t\t      district.value = params.formData.district\n          }\n\t\t\t  }\n\t\t})\n\t}\n    \n   /**\n   * open hidden fields\n   * \n   */\n   function fieldsBlockAnimate() {\n\t    const fieldsBlock = select('.dynamic-complementary-fields-block', document.body)\n      let CLIENT_HEIGHT = 0\n\t\tfieldsBlock.style.opacity = 1\n\t\tfieldsBlock.removeAttribute('hidden')\n\t\t// calculate element real height and reset it to 0\n\t\tfieldsBlock.style.height = 'auto'\n\t\tCLIENT_HEIGHT = fieldsBlock.clientHeight\n\t\tfieldsBlock.style.height = 0\n\t\t// Start animation\n\t\tTweenLite.fromTo(fieldsBlock, .5, { height: 0, opacity:0 }, {height: CLIENT_HEIGHT, opacity:1})\n      const line2 = select('input[id=\"address.line2\"]')\n\t\t if (line2 && line2.hasAttribute('disabled')) {\n\t\t    line2.removeAttribute('disabled')\n\t\t  }\n\t}\n  \n    /**\n     * Popup is closed if don't want to continue editing and will see saved address\n     * \n     */\n   function onDialogLeaveButtonClicked(e) {\n    if (window.config.visitedMarket != 'CN' ) {\n      if (params.formData && params.formData.country !== '') {\n        const getCountry = select('select[id=\"communication-country\"]')\n        getCountry.value = params.formData.country\n        select('.js-address-country .selectbox__wrapper > span', document.body).innerHTML = getCountry.options[getCountry.selectedIndex].innerHTML\n        getCountry.dispatchEvent(new Event('change'))\n        zipCodeVariation()\n      }\n    }\n   \n\t   \n\t  const communicationAddressInfo = select('div[id=\"addcommunicationAddress\"]')\n\t  communicationAddressInfo.classList.add('is-hidden')\n\t  const communicationAddressContainerElement = select('div[id=\"communicationAddressContainer\"]')\n\t  const isEdited = document.getElementById(\"edited\") \n\t  onDialogCancelButtonClicked(e)\n  \n\t  if(isEdited.value != \"\") {\n\t     communicationAddressContainerElement.classList.remove('is-hidden') \n\t  }\n\t  \n\t  else {\n\t\t  const inputLabels = getCollection('input.label-input__input', communicationAddressInfo)\n\t\t  inputLabels.find(function (inputElm) {\n          inputElm.value = ''\n\t\t  })\n\t\t  \n\t\t  getCollection('p.error', communicationAddressInfo).forEach(elm => elm.parentNode.removeChild(elm))\n\t\t  getCollection('.has-error',communicationAddressInfo).forEach((elm) => elm.classList.remove('has-error'))\n\t\t\n      hideDynamicFields()\n      \n\t\t  const communicationAddressLabels = select('div[id=\"communicationAddressLabels\"]')  \n\t\t  communicationAddressLabels.classList.remove('is-hidden')\n\t  }\t\n\t  const cancelBtn = select('button[id=\"cancelButton\"]')\n\t  cancelBtn .classList.add('is-hidden')\n\t  \n   }\n   \n  /**\n    * Remove Button Clicked\n    * \n    */\n   function onRemoveAddressButtonClicked(e) {\n\t   const removeButtonElm = e.target.closest('button')\n\t   const addressId = parseInt(removeButtonElm.dataset.addressId, 10)\n\t   const addressElm = removeButtonElm.dataset.modalAddressTemplate\n     const modalAddressElement = select('p[id=\"modal_body_message\"]')\n     const modalBody = select('p[id=\"modal_body_info\"]')\n     const modalRemoveBtn = select('button[id=\"modal_remove_button\"]')\n\t   params.addressId = addressId\n     \n       if (modalBody) {  \n\t       modalBody.classList.add('is-hidden')\n       }\n\n        if (modalAddressElement) {\n\t         modalAddressElement.innerHTML = addressElm\n\t     }\n\t   \n\t   modalRemoveBtn.classList.remove('is-disabled')\n\t   displayRemoveCancelDialog({ address: addressElm, addressId })\n\t   removeButtonAnalytics()\n\t}\n   \n   /**\n    * Remove Button Analytics\n    * \n    */\n   function removeButtonAnalytics(){\n\t\t  window.document.DLKit.push('on-tracking', {\n\t\t      event: window.config.dl.event,\n\t\t      eventAction: 'remove',\n\t\t      eventLabel: 'communication address',\n\t\t      eventCategory: 'my account'\n\t\t    })\n   }\n\t  \n   /**\n    * Popup is open on remove button click\n    * \n    */\n   function displayRemoveCancelDialog(data) {\n\t    \n\t      const dialogElm = select('div[id=\"js-modal-prompt-remove-an-address\"]', el)\n\t      popin.open({\n\t        html: dialogElm.innerHTML,\n\t        role: 'dialog',\n\t        modifiers: '',\n\t        opener: null,\n\t        manageFocus: false,\n\t        forceInert: true,\n\t        modal: true,\n\t        focusBack: false,\n\t        action: 'removeCancelModal',\n\t        address : data.address,\n\t        outerClose: false\n\t        })\n\n\t      // To catch the esc key\n\t      window.addEventListener('keydown', onEscapeButtonClicked)\n   }\n   \n   /**\n    * Modal cancel button click\n    * \n    */\n   function onModalCancelButtonClicked() {\n\t   closeModal()\n   }\n   \n   /**\n    * close the modal\n    * \n    */\n   function closeModal() {\n\t   window.removeEventListener('keydown', onEscapeButtonClicked)\n\t   popin.hide()\n   }\n   \n   /**\n    * Hide Dynamic fields\n    * \n    */\n    function hideDynamicFields() {\n      if (window.config.visitedMarket != 'CN') {\n        const zipCode = select('.js-address-zip-code', document.body)\n        const townCity = select('.js-address-town-city', document.body)\n        if (zipCode.value === '' && townCity.value === '') {\n          const fieldsBlock = select('.dynamic-complementary-fields-block', document.body)\n          if (fieldsBlock && !fieldsBlock.hasAttribute('hidden')) {\n            fieldsBlock.setAttribute('hidden', true)\n            fieldsBlock.style.height = 0\n            fieldsBlock.style.opacity = 0\n          }\n        }\n      }\n\t  }\n\n  /**\n   * set selected country\n   * \n   */\n   function setCountryValue() {\n    \t    \t\n      const getCountry = select('select[id=\"communication-country\"]') \n      if (getCountry) {\n         const selectCountry = select('option[selected=\"selected\"]', getCountry)\n         select('.js-address-country .selectbox__wrapper > span', document.body).innerHTML = selectCountry.innerHTML\n         getCountry.selectedIndex = selectCountry.index\n         getCountry.options[getCountry.selectedIndex].value = selectCountry.value\n         getCountry.dispatchEvent(new Event('change')) \n         zipCodeVariation()\n      }\n    }\n\n   /**\n    * Modal remove button click\n    * \n    */\n   function onModalRemoveButtonClicked() {\n\t\n\t   xhr.post(`${window.config.webservices.account.address.removeCommunicationAddress}`, { data: {\n          addressId: params.addressId\n       }}).then((res) => {\n           if(res.success == true) {\n        \n             const communicationAddressContainerElement = select('div[id=\"communicationAddressContainer\"]')\n             communicationAddressContainerElement.innerHTML = \" \"\n             communicationAddressContainerElement.classList.add('.is-hidden')\n             closeModal()\n        \t   \n        \t  const communicationAddressInfo = select('div[id=\"addcommunicationAddress\"]')\n\t   \n\t          const inputLabels = getCollection('input.label-input__input', communicationAddressInfo)\n\t\t        inputLabels.find(function (inputElm) {\n\t\t\t                    inputElm.value = ''\n\t\t           })\n\t\t       \n\t\t       hideDynamicFields()\n\t\t       \n\t\t       communicationAddressInfo.classList.add('is-hidden')\n    \t\t   const isEdited = select('input[id=\"edited\"]')\n           isEdited.value = \"\"\n    \t\t   const mainDiv = select('div[id=\"communicationAddressForm\"]')  \n           mainDiv.classList.remove('is-hidden')\n           const communicationAddressLabels = select('div[id=\"communicationAddressLabels\"]')  \n    \t\t   communicationAddressLabels.classList.remove('is-hidden')\n    \t\t  }\n       })  \n    }\n\n\n  function onModalShow(params) {\n      if(params.el.options.opener.id === 'cancelButton' || params.el.options.opener.id === 'removeBtn') {\n         const crossButtonElm = select('div.yes-no-modal button.popin__close.js-popin-close', params.el)\n         if (crossButtonElm) {\n\t       focusElement(crossButtonElm)  \n           params.el.setAttribute('role', 'dialog')\n         }\n       \n        const modalEditBtn = select('button[id=\"modal_leave_buttons_ko\"]')\n        if (modalEditBtn && modalEditBtn.classList.contains('is-disabled')) {\n          modalEditBtn.classList.remove('is-disabled')\n\t     }\n\t    }\n\t\n    else  {\n      setTimeout(() => {\n        const crossButtonElm = select('button.popin__close.js-popin-close', params.el)\n         if (crossButtonElm) {\n          focusElement(crossButtonElm)\n        }\n\t   }, 1000)\n \t }\n   } \n\t  \n  function onModalOpened(params) {\n   if (params.action === 'dialogLeaveCancel' || params.action === 'removeCancelModal') {\n\t const crossButtonElm = select('div.yes-no-modal button.popin__close.js-popin-close', params.dom)\n\t if (crossButtonElm) {\n\t  focusElement(crossButtonElm)  \n\t }\n     \n\t \n\t const modalEditBtn = select('button[id=\"modal_leave_buttons_ko\"]')\n     if (modalEditBtn.classList.contains('is-disabled')) {\n       modalEditBtn.classList.remove('is-disabled')\n     }\n\n     removeAriaLabel('button[id=\"modal_leave_buttons_ok\"]')\n\t removeAriaLabel('button[id=\"modal_leave_buttons_ko\"]')\n    }\n   \n    if (params.action === 'accountDeletionModal') {\n   \t    const modalTitle = select('div[id=\"delete_modalTitle\"]', params.modal.el)\n   \t    \n   \t    if (params.modal.el) {\n\t\t  params.modal.el.setAttribute('role', 'dialog')\n\t\t  params.modal.el.classList.add('delete-account')\n\t\t \n\t\t  if (params.modal.el.hasAttribute('aria-labelledby')) {\n\t    \t params.modal.el.removeAttribute('aria-labelledby')\n\t      }\n\t\t  \n   \t      if (modalTitle) {\n\t\t    params.modal.el.setAttribute('aria-label', modalTitle.innerHTML)\n\t    }\n      }\n    }\n   \t    \n    if (params.action === 'confirmPasswordModal') {\n   \t    const modalTitle = select('div[id=\"password_modalTitle\"]', params.modal.el)\n   \t    const passwordField = select('input[id=\"confirm-user-password-popin\"]', params.modal.el)\n   \t    \n   \t    if (params.modal.el) {\n\t\t  params.modal.el.setAttribute('role', 'dialog')\n\t\t  params.modal.el.classList.add('confirm-password')\n\t\t  if (params.modal.el.hasAttribute('aria-labelledby')) {\n\t    \t   params.modal.el.removeAttribute('aria-labelledby')\n\t       }\n\t\t  \n\t\t   if (modalTitle) {\n\t   \t       params.modal.el.setAttribute('aria-label', modalTitle.innerHTML)\n\t   \t   }\n\t   \t }\n\t\t\n\t\tsetTimeout(() => {\n\t      if (!document.body.classList.contains('has-modal')) {\n    \t    document.body.classList.add('has-modal') \n          }\n        } ,1000)\n   \t    \n\t\tif (passwordField) {\n\t\t  if (passwordField.hasAttribute('disabled')) {\n\t\t\t    passwordField.removeAttribute('disabled') \n\t\t    }\n\t\t}\n\n    if (passwordField.hasAttribute('tabindex')) {\n\t   \tpasswordField.removeAttribute('tabindex')\n\t  }\n }\n    \n    if (params.action === 'accountDeletedModal' || params.action === 'ongoingOrderPopin') {\n      const modalTitle = select('div[id=\"modal_body_title\"]', params.modal.el)\n      \n      if (params.modal.el) {\n        params.modal.el.setAttribute('role', 'dialog')\n        if (params.modal.el.hasAttribute('aria-labelledby')) {\n    \t  params.modal.el.removeAttribute('aria-labelledby')\n        }\n      }\n      \n      if (modalTitle) {\n   \t     params.modal.el.setAttribute('aria-label', modalTitle.innerHTML)\n   \t  }\n    }\n  }\n\n  function onModalClosed(params) {\n    if (params.action === 'removeCancelModal') {\n      const removeBtn = select('#removeBtn')\n      if (removeBtn) {\n        focusElement(removeBtn)\n        return\n      }\n    }\n\n    if (params.action === 'dialogLeaveCancel') {\n      const communicationAddressInfo = select('#addcommunicationAddress')\n      if(communicationAddressInfo && !communicationAddressInfo.classList.contains('is-hidden')) {\n        const countryList = select('select[id=\"communication-country\"]')\n        const province = select('[id=\"address.provincia\"]')\n        if (countryList) {\n          focusElement(countryList)\n          return\n        }\n        if(province && window.config.visitedMarket == 'CN') {\n          focusElement(province)\n          return\n        }\n      }\n    }\n\n    if (params.action === 'removeCancelModal' || params.action === 'dialogLeaveCancel') {\n      const title = select('#communicationAddress')\n      if (!title) return\n      title.setAttribute('tabindex', '-1');\n      focusElement(title)\n    }\n  }\n\n  function validateUserAccount() {\n\t  xhr.get(`${window.config.webservices.account.withdrawAccount}`).\n\t  then((res) => {\n\t       if(res.success == true && res.message == \"\") {\n            const dialogElm = select('div[id=\"js-modal-prompt-delete-user-account\"]', el)\n            popin.open({\n              html: dialogElm.innerHTML,\n              role: 'dialog',\n              modifiers: '',\n              opener: null,\n              manageFocus: false,\n              forceInert: true,\n              modal: true,\n              action: 'accountDeletionModal',\n              outerClose: false\n            })\n\t      } else {\n            const dialogElm = select('div[id=\"js-modal-ongoing-order\"]', el)\n            popin.open({\n              html: dialogElm.innerHTML,\n              role: 'dialog',\n              modifiers: 'ongoing-order-popin',\n              label: config.webservices.account.deleteAccountModal.ongoingOrder.label,\n              opener: null,\n              manageFocus: false,\n              forceInert: true,\n              modal: false,\n              action: 'ongoingOrderPopin',\n              outerClose: false\n            })\n\t      }\n        window.addEventListener('keydown', onEscapeButtonClicked)\n\t    })\n\t  }\n  \n   function displayConfirmPasswordModal() {\n      closeModal()\n      onUpdatedeleteAccountAnalytics()\n      const dialogElm = select('div[id=\"js-modal-prompt-confirm-password\"]', el)\n        popin.open({\n          html: revealPasswordChange(dialogElm).innerHTML,\n          role: 'dialog',\n          modifiers: '',\n          opener: null ,\n          manageFocus: false,\n          forceInert: true,\n          modal: true,\n          action: 'confirmPasswordModal',\n          outerClose: false\n        })\n      window.addEventListener('keydown', onEscapeButtonClicked)\n   } \n\t \n  function revealPasswordChange(nodeElement) {\n    const copyEl = nodeElement.cloneNode(true)\n    selectAll('input[type=password]', copyEl).forEach(el => el.setAttribute('id', `${el.id}-popin`))\n    selectAll('[data-toggle-password]', copyEl).forEach(el => el.setAttribute('data-toggle-password', `${el.dataset.togglePassword}-popin`))\n    selectAll('label[for]', copyEl).forEach(el => el.setAttribute('for', `${el.getAttribute('for')}-popin`))\n    return copyEl\n  }\n\t  \n  function displayAccountDeletedModal(e) {\n    e.preventDefault()\n    \n    if (e.delegateTarget.invalid.length === 0) {\n        const password = select('input[id=\"confirm-user-password-popin\"]').value\n        const passwordForm = select('div .password-change-form')\n        const selectedReason = select('.popin-wrapper .confirm-password-modal .selectbox__wrapper span') \n        const selectedReasonValue = selectedReason.innerHTML\n        xhr.post(`${window.config.webservices.account.deleteUserAccount}`, { data: {\n              password: password,\n              reason: selectedReasonValue\n          }}).then((res) => {\n              if (res.success) {\n            \tcloseModal()\n                onUpdatedeleteAccountAnalytics()\n                window.sessionStorage.setItem('isDeleted', true)\n                const url = config.webservices.account.loginPage\n                window.location.replace(url)\n              }\n          }).catch(e => {\n            if (e.formError) {\n              const passwordField = select('input[id=\"confirm-user-password-popin\"]')\n              const textError = e.formError\n              setErrorMessage(passwordField, textError)\n            }\n          })\n    }\n  }\n\n  function onUpdatedeleteAccountAnalytics() {\n\t    window.document.DLKit.push('on-tracking', {\n        eventCategory: 'account', \n        eventAction: 'delete my account',  \n        eventLabel: '',  \n        event: 'uaevent'\n\t    })\n  }\n  \n  function onAccountDeletedAnalytics() {\n\t    window.document.DLKit.push('on-tracking', {\n        eventCategory: 'account',  \n        eventAction: 'account deleted',  \n        eventLabel: '',  \n        event: 'nievent'\n\t    })\n   }\n\n function removeAriaLabel(id) {\n\t   getCollection(id).forEach((element) => {\n\t\t   if (element.hasAttribute('aria-label')) {\n\t\t     element.removeAttribute('aria-label')\n\t\t   }\n\t })\n }\n\n \n function displayPioneerPhoneMessage(e) {\n  select(\".important-message\")?.classList.remove(\"is-sr-only\")\n }\n\n  bind(document.body, 'input[id=\"address.phone1\"]', 'focusin', displayPioneerPhoneMessage)\n  bind(el, 'form[novalidate]', 'submit', handleSubmit)\n  bind(el, 'button[data-form-toggle-display]', 'click', displayHiddenForm)\n  bind(el, 'button.js-user-modify-communication-address', 'click', displayCommunicationForm)\n  bind(el, 'button[id=\"cancelButton\"]', 'click', onCancelButtonClicked)\n  bind(document.body, 'button[id=\"modal_leave_buttons_ko\"]', 'click', onDialogCancelButtonClicked)\n  bind(document.body, 'button[id=\"modal_leave_buttons_ok\"]', 'click', onDialogLeaveButtonClicked) \n  bind(document.body, 'button.js-user-remove-communication-address', 'click', onRemoveAddressButtonClicked)\n  bind(document.body, 'button[id=modal_cancel_button]', 'click', onModalCancelButtonClicked)\n  bind(document.body, 'button[id=modal_remove_button]', 'click', onModalRemoveButtonClicked)\n  Manager.subscribe(MODAL_IS_SHOW, onModalShow)\n  Manager.subscribe(MODAL_IS_OPEN, onModalOpened)\n  Manager.subscribe(MODAL_IS_CLOSED, onModalClosed)\n  bind(document.body, 'button[id=\"delete-user-account\"]', 'click', validateUserAccount)\n  bind(document.body, 'button[id=\"delete_account_button\"]', 'click', displayConfirmPasswordModal)\n  bind(document.body, 'form[id=\"js-modal-prompt-confirm-password-form\"]', 'submit', displayAccountDeletedModal)\n}\n","import config from 'lib/config'\nimport * as xhr from 'modules/fetch'\nimport bind from 'delegate'\nimport notifier from 'modules/notifier'\nimport detailPage from './details'\nimport resetPassword from './resetPassword'\nimport popinResetPassword from './popinResetPassword'\nimport popinMergeDecision from './popinMergeDecision'\nimport subscription from './subscription'\nimport preferenceSetting from './preference-setting'\nimport cancelOrder from './order-cancel'\nimport { Manager, ACCOUNT_ADD_ADDRESS_STATUS, LOGIN_FORM_LOADED } from 'lib/events'\nimport { select, selectAll, closest, getCollection } from 'lib/selectors'\nimport { focusElement, isMobileScreen, isiOS, isTabletScreen, isSafari, isInViewPort } from 'lib/helpers'\nimport {OAB_NAVIGATION_BAR_HEIGHT} from 'config/constants'\nimport popin from 'modules/popin'\nimport Loader from './../../ui/widgets/loader'\n\nfunction Account(el) {\n  if (config.country.toUpperCase() === 'CN') {\n    import(/* webpackChunkName: \"chinaPayment\" */'../opc/china-payment').then((module) => {\n      module.default.init()\n    })\n  }\n  const itemsContainer = el.querySelector('.customer__content.is-narrow')\n  const accountDetailsPage = el.querySelector('.account__details')\n  const resetPasswordForm = el.querySelector('.js-reset-password-form')\n  const subscriptionForm = el.querySelector('[data-subscriptions]')\n  const preferencesCommunicationForm = el.querySelector('#preferencesCommunication')\n  const preferencesCommunicationChannelUpdate = select('#preferencesOptForm')\n  const eachchannelSelector = selectAll('[data-communication-channels]')\n  const unsubscribeLink = el.querySelector('.js-account-unsubscribe-link')\n  const unsubscribeForm = el.querySelector('#unsubscribeForm')\n  const eachCommunicationSelector = selectAll('[data-communication-means]')\n  const eachNewsletterAoiSelector = selectAll('[data-preference-division]')\n  const titleH = 'h3'\n  const cardDefault = '#card-default'\n  const gigyaRegisterForm = select('#gigya-register-form')\n  const homepageLinks = getCollection('.js-myaccount-cta')\n  const membersDesktopLinks = select('.desktop-links')\n  const membersMobileLink = select('#open-download-app-mobile')\n  const membersOpenLink = select('#membership-app-open-mobile')\n  const emailEl = select('#email')\n  const moiMobileBag = select('div.is-mobile.js-moi-bag')\n  const moiDesktopBag = select('div.is-desktop.js-moi-bag')\n  const moiMobileLogo = select('div.is-mobile.js-moi-logo')\n  const moiDesktopLogo = select('div.is-desktop.js-moi-logo')\n  const moiImage = select('#chanelMoiImage')\n  const moiPdpLink = select('a.is-moi-pdp-link')\n\n  let currentPrefChkbxStatus = []\n  let firstItem = \"\"\n\n  homepageLinks.forEach((link) => {\n    link.addEventListener('click', (e) => {\n      let clickedLink = e.currentTarget.attributes[\"data-event-label\"].value\n      let GAObject = {\n        eventCategory: 'my account',\n        eventAction: 'click',\n        eventLabel: clickedLink ? clickedLink : '',\n        event: 'uaevent'\n      }\n      dataLayer.push(GAObject)\n    })\n  })\n\n  if (moiMobileLogo && moiDesktopLogo) {\n    if (isMobileScreen() || isTabletScreen()) {\n      moiMobileLogo.classList.remove('is-hidden')\n    }\n\n    else {\n      moiDesktopLogo.classList.remove('is-hidden')\n    }\n  }\n\n  if (moiMobileBag && moiDesktopBag) {\n    if (isMobileScreen()) {\n        moiMobileBag.classList.remove('is-hidden')\n    }\n\n    else {\n        moiDesktopBag.classList.remove('is-hidden')\n    }\n  }\n\n  if (moiPdpLink) {\n    if (isMobileScreen()) {\n      moiPdpLink.href = moiPdpLink.href.concat('#moiSection');\n    }\n  }\n\n  if (membersDesktopLinks && membersMobileLink) {\n    if (isMobileScreen()) {\n      membersMobileLink.removeAttribute('hidden')\n      membersDesktopLinks.setAttribute('hidden','')\n      openApp(membersMobileLink)\n    }\n    else {\n      membersDesktopLinks.removeAttribute('hidden')\n      membersMobileLink.setAttribute('hidden','')\n      membersOpenLink ? membersOpenLink.setAttribute('hidden','') : ''\n    }\n  }\n\n  if (membersOpenLink && isMobileScreen()) {\n     membersOpenLink.removeAttribute('hidden')\n     openApp(membersOpenLink)\n  }\n\n  if (moiImage) {\n    moiImage.onerror = () => {\n       moiImage.remove()\n       const moiMainDiv = select('div.moi-main-div')\n       const moiBagDiv = select('div.moi-hand-bag', moiMainDiv)\n       const moiPurchaseDiv = select('div.moi-purchase-details', moiMainDiv)\n       const noAvailaibleInfo = select('p.no-available-info', moiMainDiv)\n\n       if (moiMainDiv) {\n          if (moiBagDiv) {\n            moiBagDiv.classList.add('moi-no-image')\n          }\n\n          if (moiPurchaseDiv && !noAvailaibleInfo) {\n            moiPurchaseDiv.classList.add('moi-no-image')\n          }\n       }\n    }\n  }\n\n  function openApp(buttonId) {\n    if (isiOS()) {\n      buttonId.setAttribute('href','https://apps.apple.com/kr/app/chanel-code/id1467865119')\n    } else {\n      buttonId.setAttribute('href','https://play.google.com/store/apps/details?id=com.chanel.fnb.kapp')\n\t}\n  }\n\n  getCollection('li:not(.is-hidden) span .js-preference-subscribe-unsubscribe', document.body).forEach((checkBoxElm) => {\n    currentPrefChkbxStatus.push(checkBoxElm.checked)\n  })\n  let addAddressStatus = {\n    formIsEdited: false\n  }\n  let heightOfNewsletterRule = 0\n\n  popinResetPassword()\n  popinMergeDecision()\n\n  if (accountDetailsPage) {\n    detailPage(accountDetailsPage)\n  }\n\n  if (resetPasswordForm) {\n    resetPassword(resetPasswordForm)\n  }\n\n  if (subscriptionForm) {\n    subscription(subscriptionForm)\n  }\n\n  if (unsubscribeLink) {\n    subscription(unsubscribeForm)\n  }\n\n  if (preferencesCommunicationForm) {\n    subscription(preferencesCommunicationForm)\n  }\n\n  if (preferencesCommunicationChannelUpdate) {\n\tsubscription(preferencesCommunicationChannelUpdate)\n  }\n\n  if (gigyaRegisterForm) {\n    preferenceSetting(el)\n  }\n\n  /**\n   * display the success notification\n   * @param {object} data - server response width focusElement key\n   */\n  function notifyAction(data) {\n    if (!data.message) {\n      return\n    }\n\n    notifier.show({\n      name: data.message.label,\n      message: data.message.text,\n      close: data.message.close,\n      opener: data.focusElement,\n      noFocus: !document.body.classList.contains('is-using-keyboard')\n    })\n  }\n\n  /**\n   * find the element to focus on notification close based on-ONE-1927 accessibility requirement\n   * @param {string} categoryId - id of the category that the item is from\n   * @param {number} itemIndex - position of the item to focus in case theres no\n   * category title displayed\n   */\n  function getItemFocusElement(categoryId, itemIndex, cardSectionHeading) {\n    let categoryEl = document.getElementById(categoryId)\n    let focusElement\n\n    // if categoryId is not present in the dom\n    // select the first child of the items list\n    // can be another category or the message saying theres no items\n    if (!categoryEl) {\n      const selectedCardSection = select(`#${cardSectionHeading}`)\n      if (selectedCardSection) {\n        categoryEl = selectedCardSection\n      }\n    }\n\n    //  category title is still present\n    if (categoryEl.firstElementChild.classList.contains('heading')) {\n      focusElement = categoryEl.firstElementChild\n    }\n    else {\n      // look for list of itemss\n      const items = categoryEl.querySelectorAll('.account__listing-entry')\n\n      if (items.length) {\n        // select the previous item in the item list or fallback to the first one\n        const nextItem = items[itemIndex] || items[0]\n\n        focusElement = nextItem.firstElementChild\n      }\n      // when theres no items set the element to focus to the first child of the item list\n      else {\n        focusElement = categoryEl.firstElementChild\n      }\n    }\n\n    // prepare the element to receive the focus on notification close\n    focusElement.setAttribute('tabindex', '-1')\n\n    return focusElement\n  }\n\n  /**\n   * Manage edit/set as default /remove action on my account sub pages\n   * like addresses or payment methods\n  * @param {object} e - click event\n   */\n  function handleManageAction(e) {\n    const button = e.delegateTarget\n    const item = button.closest('[id]')\n    const type = button.closest('[data-manage]').dataset.manage\n    const action = button.dataset.action\n    const postData = {\n      data: {}\n    }\n\n    if (!item) {\n      return\n    }\n\n    postData.data[`${type}Id`] = item.id\n\n    const itemCategory = item.closest('[id]')\n    const itemList = item.closest('.account__categories')\n    let nextItemIndex = -1\n\n    if (itemList) {\n      nextItemIndex = Array.prototype.indexOf.call(itemList.children,\n      item.parentNode) - 1\n    }\n\n    button.setAttribute('disabled', true)\n    const cardSectionHeading = button.closest('section').id\n\n    if (action === 'delete') {\n      // apply a css transition to fade the item that we are deleting\n      item.style.opacity = 0.2\n    }\n    const defaultTitle = select(cardDefault)\n    const defaultArticleId = defaultTitle ? select('article', defaultTitle).id : null\n    if (action === 'setDefault') {\n      if (defaultTitle) {\n        const cardInfo = select(titleH, item)\n        const defaultCardInto = select(titleH, defaultTitle)\n        const defaultTitleSiblings = getCollection('h3 ~ p', defaultTitle)\n        TweenLite.to(defaultCardInto, .3, {\n          opacity: 0,\n          ease: Power2.easeOut\n        })\n        TweenLite.to(cardInfo, .3, {\n          opacity: 0,\n          ease: Power2.easeOut\n        })\n        if (defaultTitleSiblings) {\n          defaultTitleSiblings.forEach(elem => {\n            TweenLite.to(elem, .3, {\n              opacity: 0,\n              ease: Power2.easeOut\n            })\n          })\n        }\n\n         // apply scroll to default selected\n        window.scrollTo(0, defaultTitle.offsetTop)\n      }\n    }\n\n    // ajax call\n    xhr.post(config.webservices.account[type][action], postData)\n      .then((data) => updateItemsPayment(data))\n      .then((data) => updateDom(data, itemCategory.id, defaultArticleId, nextItemIndex, cardSectionHeading))\n      .then((data) => {\n        notifyAction(data)\n      })\n      .catch(() => {\n        if (action === 'delete') {\n          item.removeAttribute('style')\n        }\n\n        button.removeAttribute('disabled')\n      })\n  }\n\n  /**\n   * replace the DOM and get the element to focus on notification close\n   * @param {object} data - server response\n   * @param {string} categoryId - id of the category that the item is from\n   * @param {number} nextItemIndex - position of the item to focus in case theres no\n   * category title displayed\n   */\n  function updateDom(data, categoryId, defaultArticleId, nextItemIndex, cardSectionHeading) {\n    if (!data.html && data.html !== '') {\n      return data\n    }\n\n    itemsContainer.innerHTML = data.html\n\n    const findHiddenElm = getCollection('.has-opacity-hidden:not(p)', itemsContainer)\n    const hiddenElArticle = findHiddenElm.map(ele => ele.closest('article'))\n\n    const defaultElem = select(cardDefault)\n    const defaultCardInto = select(titleH, defaultElem)\n\n    hiddenElArticle && hiddenElArticle.forEach((element, index) => {\n      if (defaultArticleId) {\n        // as nextItemIndex begins with -1, to find the item index in the new array with a additional Default Card Element, we need to subtract 2 instead of 1\n        const newItemIndex = index - 2\n        if (element.id !== defaultArticleId && element.id !== defaultCardInto.parentElement.id && newItemIndex !== nextItemIndex) {\n          Array.from(element.children).forEach(ele => ele.classList.remove('has-opacity-hidden'))\n        } else {\n          Array.from(element.children).forEach(ele => {\n            if (ele.classList.contains('has-opacity-hidden')) {\n              TweenLite.fromTo(ele, 0.3, {\n                opacity: 0,\n                onComplete: () => {\n                  ele.classList.remove('has-opacity-hidden')\n                }\n              }, {\n                delay: 0.2,\n                opacity: 1,\n                ease: Power2.easeOut\n              })\n            }\n          })\n        }\n      }\n      else {\n        Array.from(element.children).forEach(ele => ele.classList.remove('has-opacity-hidden'))\n      }\n    })\n\n\n    data.focusElement = getItemFocusElement(categoryId, nextItemIndex, cardSectionHeading)\n    return data\n  }\n\n  function displayMore(data) {\n    let ordersList = el.querySelector('.js-orders-list')\n    const allOrtClaims = document.querySelectorAll('.claimsHistory-wrapper >ul >li')\n    allOrtClaims.forEach(li => {\n          if (li.hasAttribute('tabindex')) {\n            li.removeAttribute('tabindex')\n          }\n    })\n\n    const ulTemp = document.createElement('ul')\n    ulTemp.innerHTML = data.orders\n\n    if (data.claimType) {\n      let claimType = data.claimType\n      if (claimType==='active') ordersList = el.querySelector('.js-active-Ort-ClaimData')\n      if (claimType==='archived') ordersList = el.querySelector('.js-archived-Ort-ClaimData')\n    }\n\n   firstItem = ulTemp.firstElementChild\n\n    Array.from(ulTemp.children).forEach(li => {\n      ordersList.appendChild(li)\n    })\n\n\n    return data\n  }\n\n  function manageLoadMoreButton(data, button) {\n    // update the load more button url\n\tconst loaderEl = select('.loader', button)\n\n    if (data.next) {\n      button.dataset.loadmore = data.next\n      if (loaderEl) {\n        button.removeChild(loaderEl)\n      }\n    }\n\n    // remove it if theres no more items to display\n    else {\n      button.parentElement.removeChild(button)\n    }\n\n    firstItem.setAttribute(\"tabindex\", -1)\n    firstItem.focus()\n\n  }\n\n  function loadMore(e) {\n    const button = e.delegateTarget\n    // get the api call from the confif or directly from the button if theres no match in the config\n    const api = config.webservices.more[button.dataset.loadmore] || button.dataset.loadmore\n    if (button.dataset.ortclaim) {\n      const loader = new Loader(button, {\n        enableSyncCol: true,\n        referenceEl: button\n      })\n      loader.init()\n      loader.create()\n      viewMoreDLPush()\n    }\n\n    xhr.get(api)\n      .then(displayMore)\n      .then(data => manageLoadMoreButton(data, button))\n\n      .catch(config.noop)\n  }\n\n  function notifierOpened() {\n    const closeButtonContainer = select('.notifier__wrapper.is-visible')\n    const closeButton = select('.button.is-icon.notifier__close.js-notifier-close', closeButtonContainer)\n    focusElement(closeButton)\n  }\n\n  /**\n   * This function is called once xhr.post return a response\n   * It allow to update the payment method message\n   * Don't use it for other purposes\n   * @param data {Object}: contains xhr.post response\n   * @return {*}: return data to call next promise\n   */\n  function updateItemsPayment(data) {\n    const messageElement = select('[data-payment-size]', el)\n    if (data.message && messageElement) {\n      let nbPaymentMethod = parseInt(messageElement.dataset.paymentSize, 10)\n      messageElement.setAttribute('data-payment-size', --nbPaymentMethod)\n      if (nbPaymentMethod === 0) {\n        messageElement.classList.remove('is-hidden')\n        focusElement(messageElement)\n      }\n\n      Manager.subscribe('onNotifierIn', notifierOpened)\n      notifyAction(data)\n    }\n    return data\n  }\n\n  function handleCheckBox(e) {\n    const loginRemember = select('#login-remember')\n    if (loginRemember) {\n      if (loginRemember.checked) {\n        loginRemember.setAttribute('checked', 'checked')\n      }\n      else {\n        loginRemember.removeAttribute('checked')\n      }\n    }\n  }\n\n  /**\n   * Triggered once user click on US \"Set as default address\"\n   * Don't use it for other purposes\n   * @param e {MouseEvent}: contains some event properties\n   */\n  function onDefaultAddressLinkClicked(e) {\n    if (!addAddressStatus.formIsActive) {\n      const defaultAddressElm = e.target.closest('button')\n      const addressId = parseInt(defaultAddressElm.dataset.addressId, 10)\n      const url = `${window.location.origin}${window.config.webservices.account.address.setAsDefault}${addressId}`\n      xhr.post(url, {})\n        .then((data) => {\n          const addressesElm = select('div[data-manage]')\n          addressesElm.innerHTML = data.html\n          return data\n        })\n        .then(() => {\n          const defaultAddressElm = select('section[id=address-default] h2')\n          focusElement(defaultAddressElm)\n        })\n    }\n  }\n\n  /**\n   * Triggered once user click on EU \"Set as default address\"\n   * Don't use it for other purposes\n   * @param e {MouseEvent}: contains some event properties\n   */\n  function onDefaultEuAddressLinkClicked(e) {\n    const buttonElm = e.delegateTarget\n    const addressId = buttonElm.dataset.addressId\n\n    xhr.post(`${config.webservices.account.address.eu.setAsDefault.get}${addressId}`, {})\n      .then((data) => {\n        const sAD = config.pages.account.addresses.eu.modal.setAsDefault\n        const template = `<div class=\"popin-text text-center account-set-as-default\" data-title-label data-close-label=\"${sAD.cross}\">\n          <div role=\"heading\" aria-level=\"1\" class=\"heading is-5 title text-cesadnter\" id=\"titleSetAddressAsDefault\">\n            <h1 id=\"setAsDefaultModalTitleId\" data-test=\"lblYourDefaultAddressFor\">${sAD.title}</h1>\n          </div>\n\n          <div class=\"js-modal-set-default-address-eu\"></div>\n        </div>`\n        return popin.open({\n          html: template,\n          label: `${config.pages.account.addresses.eu.modal.setAsDefault.label}`,\n          role: 'dialog',\n          modifiers: 'is-medium',\n          opener: null,\n          manageFocus: true,\n          forceInert: true,\n          modal: true,\n          outerClose: false,\n          page: 'Addresses-Account-OPC',\n          action: 'SetEuDefaultAddress'\n        }).then((modal) => {\n          return {modal, data}\n        })\n      })\n      .then(({modal, data}) => {\n        const divElm = select('.js-modal-set-default-address-eu', modal.params.dom)\n        divElm.innerHTML = data.html\n\n        select('.js-set-address-as-default-confirm', divElm)\n          .addEventListener('click', (btnConfirmEvent) => {\n            btnConfirmEvent.preventDefault()\n            xhr.submit(select('form', divElm)).then(({html}) => {\n\n              // Manage the focus\n              focusElement(select('h1.heading'))\n\n              // Update the addresses content\n              const addressesElm = select('div[data-manage]')\n              addressesElm.innerHTML = html\n\n              // Close the modal\n              popin.hide()\n            })\n          })\n\n        select('.js-set-address-as-default-cancel', divElm)\n          .addEventListener('click', () => {\n            popin.hide()\n          })\n      })\n  }\n\n  function onDefaultAddressEuModalOpened(props) {}\n\n  /**\n   * Triggered once user open or close the \"add an address form\"\n   * @param data {Object}: contains form parameters\n   */\n  function onAddAddressFormStatus(data) {\n    addAddressStatus = Object.assign({}, data)\n  }\n\n  function onSampleReorderStart(e) {\n    const targetElm = e.delegateTarget\n    const productCode = targetElm.getAttribute('data-id')\n    if (productCode) {\n      if (dataLayerGA['productList'].hasOwnProperty(productCode) && dataLayerGA['productList'][productCode].hasOwnProperty('reorderFromSample')) {\n        const dataset = JSON.parse(targetElm.getAttribute('data-datalayer'))\n        const dlReorderSampleData = dataLayerGA['productList'][productCode]['reorderFromSample']\n        window.localStorage.setItem('dataDlReorderSample', JSON.stringify(dlReorderSampleData))\n        window.document.DLKit.push('on-tracking', dataset)\n      }\n    }\n  }\n\n  function updatePreferences() {\n    let subscribed = []\n    let unSubscribed = []\n    let updatedPreferences = []\n    let unSubscribedWithNoChnge = []\n    getCollection('li:not(.is-hidden) span .js-preference-subscribe-unsubscribe', document.body).forEach((checkBoxElm, index) => {\n      updatedPreferences.push(checkBoxElm.checked)\n      if (currentPrefChkbxStatus[index] !== checkBoxElm.checked) {\n        if (checkBoxElm.checked) {\n          if (subscribed.length > 0) subscribed[0].category += (' | ' + checkBoxElm.getAttribute('name').toLowerCase())\n          else subscribed.push({\n            eventAction: 'subscribe',\n            category: checkBoxElm.getAttribute('name').toLowerCase()\n          })\n        } else {\n          if (unSubscribed.length > 0) unSubscribed[0].category += (' | ' + checkBoxElm.getAttribute('name').toLowerCase())\n          else unSubscribed.push({\n            eventAction: 'unsubscribe',\n            category: checkBoxElm.getAttribute('name').toLowerCase()\n          })\n        }\n      }\n      else if (!(checkBoxElm.checked)){\n        unSubscribedWithNoChnge.push(checkBoxElm.checked)\n      }\n\n    })\n    if (subscribed.length > 0) {\n      dataLayer.push({\n        eventCategory: 'preferences',\n        eventAction: subscribed[0].eventAction + '_cta',\n        eventLabel: subscribed[0].category,\n        event: 'uaevent'\n      })\n    }\n    if (unSubscribed.length > 0) {\n      dataLayer.push({\n        eventCategory: 'preferences',\n        eventAction: unSubscribed[0].eventAction + '_cta',\n        eventLabel: unSubscribed[0].category,\n        event: 'uaevent'\n      })\n    }\n    if(unSubscribedWithNoChnge.length > 2) {\n      dataLayer.push({\n        eventCategory: 'preferences',\n        eventAction: 'unsubscribe_cta',\n        eventLabel: 'none',\n        event: 'uaevent'\n      })\n\n    }\n    currentPrefChkbxStatus = updatedPreferences\n\n  }\n\n  function unsubscribeFomUS() {\n    let unSubscribedUS = []\n    let updatedPreferences = []\n    getCollection('li:not(.is-hidden) span .js-preference-subscribe-unsubscribe', document.body).forEach((checkBoxElm, index) => {\n      updatedPreferences.push(checkBoxElm.checked ? !(checkBoxElm.checked):checkBoxElm.checked)\n        if (checkBoxElm.checked) {\n          if (unSubscribedUS.length > 0) {\n            unSubscribedUS[0].category += (' | ' + checkBoxElm.getAttribute('name').toLowerCase())\n          } else {\n            unSubscribedUS.push({\n              eventAction: 'unsubscribe',\n              category: checkBoxElm.getAttribute('name').toLowerCase()\n            })\n          }\n        }\n\n    })\n\n    if (unSubscribedUS.length > 0) {\n      dataLayer.push({\n        eventCategory: 'preferences',\n        eventAction: unSubscribedUS[0].eventAction + '_text',\n        eventLabel: unSubscribedUS[0].category,\n        event: 'uaevent'\n      })\n    }\n    else{\n      dataLayer.push({\n        eventCategory: 'preferences',\n        eventAction: 'unsubscribe_text',\n        eventLabel: 'none',\n        event: 'uaevent'\n      })\n    }\n    currentPrefChkbxStatus = updatedPreferences\n\n  }\n\n\n  /**\n   * A11Y stuff: please dont use this fn for other purpose\n   * The link is appear when user navigate through elements thanks to tab key\n   * The link is located after the CTA (login or register)\n   * @param e {MouseEvent}: js event object\n   */\n  function onGoBackHiddenLinkClicked(e) {\n    const gigyaDivElm = select('#gigya-wrapper_content', el)\n    const activeTabElm = select('li a[aria-current=\"true\"]', gigyaDivElm)\n    activeTabElm.focus()\n  }\n\n  function onUpdateLaListAnalytics() {\n    window.document.DLKit.push('on-tracking', {\n      event: window.config.dl.event,\n      eventAction: 'click',\n      eventLabel: 'la liste',\n      eventCategory: 'account'\n    })\n  }\n\n  function handleTrackItemAnalytics(e) {\n    const targetElm = e.delegateTarget\n    const productName = targetElm.getAttribute('data-product-name')\n    window.document.DLKit.push('on-tracking', {\n      event: window.config.dl.event,\n      eventAction: 'reorder',\n      eventLabel: productName ? productName : '',\n      eventCategory: 'order history'\n    })\n  }\n\nfunction handleDownloadVoiceAnalytics(e) {\n  const targetElm = e.delegateTarget\n  const orderNumber = targetElm.getAttribute('data-order-details')\n  window.document.DLKit.push('on-tracking', {\n  event: 'uaevent',\n  eventAction: 'download e-invoice',\n  eventLabel: orderNumber ? orderNumber : '',\n  eventCategory: 'order history'\n  })\n}\n\nfunction onClickReturnNote() {\n  const allproduct = selectAll('.js-track-item')\n  const productNameVal = allproduct ? allproduct[0].getAttribute('data-product-name') : null\n    window.dataLayer.push({\n      event: 'uaevent',\n      eventAction: 'download return note',\n      eventLabel: productNameVal,\n      eventCategory: 'order history'\n    })\n}\n\n  function onClickPrepaidshippingLabel() {\n    const allproducts = selectAll('.js-track-item')\n    const productNameValue = allproducts ? allproducts[0].getAttribute('data-product-name') : null\n      window.dataLayer.push({\n        event: 'uaevent',\n        eventAction: 'prepaid shipping label download',\n        eventLabel: productNameValue,\n        eventCategory: 'order history'\n      })\n  }\n\n  /**\n   * on the select of the concent checkbox all communication checkboxes gets selected.\n   * on uncheck all get selected communication boxes gets removed.\n   */\n  function preferencesNewsletterElm(elem) {\n  \tconst preferencesSetting = elem.target.checked\n  \tconst preferencesRulesElm = selectAll('.subscirbe-section')\n  \txhr.post(config.webservices.account.subscribePreferences, {data : {subscribe:preferencesSetting.toString()}})\n  \t.then((response) => {\n  \t  preferencesRulesElm.forEach((el) => el.classList.toggle('is-hidden', !elem.target.checked))\n  \t  eachCommunicationSelector.forEach((checkBoxElm) => {\n  \t\tif (!checkBoxElm.classList.contains('hiddenInput')) {\n  \t\t  checkBoxElm.checked = elem.target.checked\n  \t\t}\n  \t  })\n  \t  eachNewsletterAoiSelector.forEach((checkBoxElm) => {\n  \t\tif (!checkBoxElm.classList.contains('hiddenInput')) {\n  \t\t  checkBoxElm.checked = elem.target.checked\n  \t\t}\n  \t  })\n  \t})\n  }\n\n  function chanelSubscribe(e) {\n    const allOptionOpt = e.target\n    const preferencesOpt = selectAll('.js-preferences-optOut')\n    const communicationBlock = select('.communication-chanel')\n\n    if (allOptionOpt.checked) {\n\t  preferencesOpt.forEach((checkBoxInput) => {\n\t    checkBoxInput.value = true\n\t    checkBoxInput.checked = true\n\t    checkBoxInput.setAttribute('checked', '')\n\t  })\n\t  communicationBlock.classList.remove('channelOpt')\n    communicationBlock.classList.remove('is-disabled')\n\t} else {\n\t  preferencesOpt.forEach((checkBoxInput) => {\n\t    checkBoxInput.value = false\n\t    checkBoxInput.checked = false\n\t\tcheckBoxInput.removeAttribute('checked')\n\t  })\n\t  communicationBlock.classList.add('channelOpt')\n    communicationBlock.classList.add('is-disabled')\n\t}\n\n    eachchannelSelector.forEach((checkBoxElm) => {\n      if (checkBoxElm) {\n        if (allOptionOpt.checked) {\n          checkBoxElm.value = true\n          checkBoxElm.checked = true\n          checkBoxElm.setAttribute('checked', '')\n          checkBoxElm.setAttribute('aria-disabled', false)\n        }\n        else {\n          checkBoxElm.value = false\n          checkBoxElm.checked = false\n          checkBoxElm.removeAttribute('checked')\n          checkBoxElm.setAttribute('aria-disabled', true)\n        }\n      }\n    })\n  }\n\t//to get order code from intellipost\n  function getOrderCode() {\n    let displayCode = select('.codeDisplay')\n    let displayPara = select('.displayCC')\n    let divEl = select('.button-parent-label')\n    if(displayCode) {\n      displayCode.remove()\n    }\n    const api = config.webservices.account.intellipostUrl\n    xhr.get(api).then(res => {\n      const {authorizationCode,displayReturnLabel} = res\n      if (displayReturnLabel && authorizationCode !== '') {\n        let displayCode = document.createElement('p')\n        displayCode.innerHTML = `${window.config.webservices.account.authCode}${authorizationCode}`\n        displayCode.classList.add('codeDisplay')\n        divEl.after(displayCode)\n        displayCode.setAttribute('tabindex', '-1')\n        displayCode.focus()\n      } else {\n        divEl.parentElement.removeChild(divEl)\n        displayPara?.removeAttribute('hidden')\n        displayPara?.focus()\n\t    }\n    })\n  }\n\n  function handleCommunicationOption(e) {\n    const allOptionOpt = selectAll('.js-preferences-optOut')\n    const communicationBlock = select('.communication-chanel')\n    let count = 0\n\n    eachchannelSelector.forEach((checkBoxElm) => {\n      if (checkBoxElm.checked) {\n        count++\n      }\n    })\n\n    if (count == 0) {\n      allOptionOpt.forEach((checkBoxInput) => {\n    \tcheckBoxInput.value = false\n    \tcheckBoxInput.checked = false\n    \tcheckBoxInput.removeAttribute('checked')\n  \t  })\n      communicationBlock.classList.add('channelOpt')\n      communicationBlock.classList.add('is-disabled')\n      eachchannelSelector.forEach((checkBoxElm) => {\n        checkBoxElm.setAttribute('aria-disabled', true)\n      })\n    }\n  }\n\n  function handleCommunicationChannels() {\n    eachCommunicationSelector.forEach((checkBoxElm) => {\n      if (checkBoxElm) {\n        if (checkBoxElm.checked) {\n          checkBoxElm.value = true\n          checkBoxElm.setAttribute('checked', '')\n        } else {\n          checkBoxElm.value = false\n          checkBoxElm.removeAttribute('checked')\n        }\n      }\n    })\n    eachNewsletterAoiSelector.forEach((checkBoxElm) => {\n      if (checkBoxElm) {\n        if (checkBoxElm.checked) {\n          checkBoxElm.value = true\n          checkBoxElm.setAttribute('checked', '')\n        } else {\n          checkBoxElm.value = false\n          checkBoxElm.removeAttribute('checked')\n        }\n      }\n    })\n  }\n\n  function createViewDetailsAnalytics(e) {\n    let isClosedRequest = e.target.classList.contains(\"closed-request\")\n    window.dataLayer.push({\n\t   eventCategory: 'service requests',\n\t   eventAction: 'details',\n\t   eventLabel: isClosedRequest ? 'closed' : 'in progress',\n\t   event: 'uaevent'\n\t})\n  }\n\n  if (emailEl && window.config.visitedMarket === 'KR') {\n    emailEl.onblur = function () {\n      emailEl.value =  emailEl.value.toLowerCase()\n    }\n  }\n\nwindow.onload = function () {\n    if (window.location.href.includes('#moiSection')) {\n      const moiHeading = select('h2[id=\"moiSection\"]')\n      if (isMobileScreen()) {\n        window.scrollTo(window.scrollX, window.scrollY - 70)\n        moiHeading.setAttribute('tabindex', -1)\n        moiHeading.focus()\n      }\n    }\n  }\n\n  window.addEventListener('scroll',(event) => {\n    let backStick =  select('.js-step-navigation .is-fixed')\n    let narrowHeader = select('.js-header.is-narrow')\n\n    if ( isSafari() &&  narrowHeader != null && !isMobileScreen() && backStick) {\n      let backStickStyles = window.getComputedStyle(backStick)\n      if(backStickStyles.zIndex == 0) backStick.style.zIndex = 60\n    }\n\n    let headerStep = select('.js-step-navigation div')\n    if(headerStep && narrowHeader && !isMobileScreen() && !isTabletScreen()) {\n      let footerElement = select('.subfooter')\n        if(footerElement && isInViewPort(footerElement, footerElement.clientHeight))  {\n            headerStep.classList.remove('is-fixed')\n            headerStep.classList.add('is-static')\n        } else {\n            headerStep.classList.add('is-fixed')\n            headerStep.classList.remove('is-static')\n        }\n    }\n  })\n\n  function viewMoreDLPush() {\n    dataLayer.push({\n      eventCategory: 'service requests',\n      eventAction: 'view_more',\n      eventLabel: '',\n      event: 'uaevent'\n    })\n  }\n\n  function updateSerialAnalytics() {\n    dataLayer.push({\n      eventCategory: 'chanel et moi',\n      eventAction: 'access information',\n      eventLabel: 'try',\n      event: 'uaevent'\n    })\n  }\n\n  function updateCorrectSerialAnalytics() {\n    dataLayer.push({\n      eventCategory: 'chanel et moi',\n      eventAction: 'access information',\n      eventLabel: 'success',\n      event: 'nievent'\n    });\n  }\n\n  function submitSerialNumberForm() {\n   updateSerialAnalytics()\n   const serialForm = select('form[id=\"serialNumberForm\"]')\n   const submitButton = select('button[id=\"serialFormSubmit\"]', serialForm)\n   const loader = new Loader(submitButton, {\n    button: true,\n    delay: 200\n   })\n\n    if (serialForm.invalid.length === 0) {\n      try {\n       updateCorrectSerialAnalytics()\n       serialForm.submit()\n       loader.init()\n       loader.create()\n      }\n\n    catch(err) {\n      loader.destroy()\n    }\n   }\n  }\n\n  bind(document.body, '.js-cancel-order', 'click' , cancelOrder)\n  bind(el, '[data-manage] [data-action]', 'click', handleManageAction)\n  bind(el, '#login-remember', 'change', handleCheckBox)\n  bind(el, '[data-loadmore]', 'click', loadMore)\n  bind(el, 'button.js-user-addresses', 'click', onDefaultAddressLinkClicked)\n  bind(el, '.warrantyOverlayOpen', 'click', serviceSectionoverlayOpen)\n  bind(el, '.restoringOverlayOpen', 'click', serviceSectionoverlayRestoring)\n  bind(el, 'button.js-set-default-address-eu', 'click', onDefaultEuAddressLinkClicked)\n  bind(el, 'button.js-sample-reorder', 'click', onSampleReorderStart)\n  bind(el, 'a.is-sr-only-focusable', 'click', onGoBackHiddenLinkClicked)\n  bind(el, '#accountLaListChanel', 'click', onUpdateLaListAnalytics)\n  bind(el, '.return-note', 'click', onClickReturnNote)\n  bind(el, '.prepaid-shipping-label', 'click', onClickPrepaidshippingLabel)\n  bind(el, '.open-pdfs', 'click', handleOpenPdfs)\n  bind(el, '.js-track-item', 'click', handleTrackItemAnalytics)\n  bind(el, '.js-track-item', 'click', onClickReturnNote)\n  bind(el, '.js-track-item', 'click', onClickPrepaidshippingLabel)\n  bind(el, '.js-download-invoice', 'click', handleDownloadVoiceAnalytics)\n  bind(el, 'input#preferences-subscribe', 'change', preferencesNewsletterElm)\n  bind(el, '[data-communication-means] , [data-preference-division]','change', handleCommunicationChannels)\n  bind(el, '.js-preferences-optOut', 'change', chanelSubscribe)\n  bind(el, '[data-communication-channels]','change', handleCommunicationOption)\n  bind(document.body, '.js-update-preferences', 'click' , updatePreferences)\n  bind(document.body, '.js-account-unsubscribe-link', 'click' , unsubscribeFomUS)\n  bind(document.body, 'p.claimsHistory-link >a', 'click' , createViewDetailsAnalytics)\n  bind(document.body, 'form[id=\"serialNumberForm\"]' ,'submit' , submitSerialNumberForm)\n  bind(document.body, '.js-intellipost-shipping-label', 'click', getOrderCode)\n\n  window.addEventListener('load', setFocusOnErrMsg)\n\n  function setFocusOnErrMsg() {\n    const pymtError = select(\".pending-payment-error\")\n    if (pymtError) {\n      pymtError.focus()\n      dataLayer.push({\n        'eventCategory': 'payment in progresss',\n        'eventAction': 'display',\n        'eventLabel': '',\n        'event':  'uaevent'\n      });\n    }\n  }\n\n  function handleOpenPdfs(event) {\n    const pdfContainer = selectAll('#downloadPdfUrlContainer input')\n\n    if( pdfContainer.length > 0 ) {\n      event.preventDefault()\n      pdfContainer.map(item => window.open(item.value, '_blank'))\n    }\n  }\n\n  let loader\n\n  function checkIfLoginPageLoaded() {\n    if (location.href.includes('login') && !(location.href.includes('password'))) {\n      let loginWrapper = select('.loader_container')\n      let loginContent = select('#gigya-wrapper_content')\n      if (!loginContent) {\n        if (!loader) {\n          loginWrapper.removeAttribute('hidden')\n          let loaderInner = document.createElement('div')\n          loginWrapper.appendChild(loaderInner)\n          loader = new Loader(loginWrapper, {\n            button: false\n          })\n          loader.init()\n          loader.create()\n        }\n        setTimeout(checkIfLoginPageLoaded, 1000)\n      } else {\n        if (loader) {\n          Manager.publish(LOGIN_FORM_LOADED)\n          loader.destroy()\n          loginWrapper.setAttribute('hidden', '')\n          checkBackStickyFromOAB()\n        }\n      }\n    }\n  }\n  checkIfLoginPageLoaded()\n\n  function checkBackStickyFromOAB () {\n    let narrowHeader = select('.js-header.is-narrow')\n    const stepperNavigation =  select('.js-step-navigation')\n    if (!isMobileScreen() && stepperNavigation) {\n      const stepperBackNavigation = select('p', stepperNavigation)\n      stepperNavigation && !stepperNavigation.classList.contains('js-sticky-item') ? stepperNavigation.classList.add('js-sticky-item') : ''\n      const stickyHeader = select('.js-step-navigation.js-sticky-item')\n\n      if (stickyHeader) stickyHeader.style.height = `${OAB_NAVIGATION_BAR_HEIGHT}px` // override sticky item height for OAB navigation element\n       const stickyHeaderDiv = select('div', stickyHeader)\n       if(narrowHeader && stickyHeaderDiv) {\n          stickyHeaderDiv.classList.contains('is-static') ? stickyHeaderDiv.classList.remove('is-static') : \"\"\n          !stickyHeaderDiv.classList.contains('is-fixed') ? stickyHeaderDiv.classList.add('is-fixed') : \"\"\n       }\n\n       stickyHeaderDiv.style.transform = narrowHeader && !stepperBackNavigation.classList.contains('tablet-transform') ? isTabletScreen() ? \"translateY(70px)\" : \"translateY(80px)\" :  stickyHeaderDiv.style.transform\n       if(narrowHeader) stepperBackNavigation.style.top = \"auto\"\n    }\n  }\n\n  Manager.subscribe(ACCOUNT_ADD_ADDRESS_STATUS, onAddAddressFormStatus)\n}\n\nfunction serviceSectionoverlayOpen(e) {\n\n      const template = `<div><div class=\"popin-text text-center account-set-as-default\" data-title-label data-close-label=\"` + config.chanelandmoiPLP.chanelwarrantyClose + `\">\n        <p role=\"heading\" aria-level=\"1\" class=\"heading title is-1 text-heading\">` + config.chanelandmoiPLP.chanelwarrantyTitle + `</p>\n        <div class=\"popinWarrantyBody\">\n          <p>` + config.chanelandmoiPLP.chanelwarrantyParagraphOne + `</p>\n          <p>` + config.chanelandmoiPLP.chanelwarrantyParagraphTwo + `</p>\n          <p>` + config.chanelandmoiPLP.chanelwarrantyParagraphThree + `</p>\n        </div>\n        <div class=\"popin-Warranty-Terms-Conditions\">\n          <p class=\"link is-underlink\">\n            <a href=\"`+ACC.config.encodedContextPath +`/fashion/services/chanel-et-moi/terms-and-conditions/\" class=\"link is-underline\">\n              <span>` + config.chanelandmoiPLP.chanelwarrantyParagraphUrlText + `</span>\n            </a>\n          </p>\n        </div></div>\n      </div>`\n      window.dataLayer.push({\n        'eventCategory': 'chanel et moi',\n        'eventAction': 'services',\n        'eventLabel': 'chanel warranty',\n        'event': 'uaevent' // associated event\n        });\n      return popin.open({\n        html: template,\n        label: config.chanelandmoiPLP.chanelandmoiPLPTitle,\n        modal: true,\n        role: 'dialog',\n        modifiers: 'is-medium ChanelAndMoi chanel-warranty',\n        opener: null,\n        manageFocus: true,\n        forceInert: true,\n        outerClose: false,\n        page: 'ChanelandMoi-PLP',\n        action: 'SetEuDefaultAddress'\n      }).then((modal) => {\n        let popinModal = select(\".ChanelAndMoi\")\n        popinModal.setAttribute('aria-modal', true)\n        return {modal}\n      })\n}\n\nfunction serviceSectionoverlayRestoring(e) {\n  const template = `<div><div class=\"popin-text text-center account-set-as-default\" data-title-label data-close-label=\"` + config.chanelandmoiPLP.chanelrestoringClose + `\">\n        <p role=\"heading\" aria-level=\"1\" class=\"heading restoring-title title text-heading\">`+ config.chanelandmoiPLP.chanelrestoringTitle +`</p>\n        <div class=\"popinWarrantyBody\">\n          <p>` + config.chanelandmoiPLP.chanelrestoringParagraphOne + `</p>\n          <p>` + config.chanelandmoiPLP.chanelrestoringParagraphTwo + `</p>\n          <p>` + config.chanelandmoiPLP.chanelrestoringParagraphThree + `</p>\n        </div>\n\n        <div class=\"chanelandMoi-careTips\">\n        <p role=\"heading\" aria-level=\"2\" class=\"heading is-3 title text-heading\">` + config.chanelandmoiPLP.chanelrestoringsubTitle + `</p>\n        <p class=\"caretipsMessage\">` + config.chanelandmoiPLP.chanelrestoringsubTitleSubtext + `</p>\n\n        <div class=\"chanelandMoi-fluidcomponent chanelandMoi-card\">\n          <div role=\"heading\" aria-level=\"3\" class=\"chanelandMoi-card-blocks\">\n           <button type=\"button\" aria-expanded=\"false\" class=\"chanelandMoi-card-button\">` + config.chanelandmoiPLP.chanelrestoringLabelOne + `</button>\n          </div>\n          <div class=\"chanelandMoi-card-text\">\n              <div class=\"chanelandMoi-card-ImgBlock\">\n                <img src=\" `+ ACC.config.commonResourcePath +`/images/wear.png\" alt=\"\" class=\"chanelandMoi-card-Image chanelandMoi-card-wear\"/>\n              </div>\n              <p class=\"chanelandMoi-card-ImgInfo is-hidden\">` + config.chanelandmoiPLP.chanelrestoringLabeltextOne + `</p>\n          </div>\n        </div>\n\n        <div class=\"chanelandMoi-fluidcomponent chanelandMoi-card\">\n          <div role=\"heading\" aria-level=\"3\" class=\"chanelandMoi-card-blocks\">\n              <button type=\"button\" aria-expanded=\"false\" class=\"chanelandMoi-card-button\">` + config.chanelandmoiPLP.chanelrestoringLabelTwo + `</button>\n          </div>\n          <div class=\"chanelandMoi-card-text\">\n              <div class=\"chanelandMoi-card-ImgBlock\">\n                <img src=\" `+ ACC.config.commonResourcePath +`/images/protect.png\" alt=\"\" class=\"chanelandMoi-card-Image chanelandMoi-card-protect\"/>\n              </div>\n              <p class=\"chanelandMoi-card-ImgInfo is-hidden\">` + config.chanelandmoiPLP.chanelrestoringLabeltextTwo + `</p>\n          </div>\n        </div>\n\n        <div class=\"chanelandMoi-fluidcomponent chanelandMoi-card\">\n          <div role=\"heading\" aria-level=\"3\" class=\"chanelandMoi-card-blocks\">\n              <button type=\"button\" aria-expanded=\"false\" class=\"chanelandMoi-card-button\">` + config.chanelandmoiPLP.chanelrestoringLabelThree + `</button>\n          </div>\n          <div class=\"chanelandMoi-card-text\">\n              <div class=\"chanelandMoi-card-ImgBlock\">\n                <img src=\" `+ ACC.config.commonResourcePath +`/images/care.png\" alt=\"\" class=\"chanelandMoi-card-Image chanelandMoi-card-care\"/>\n              </div>\n              <p class=\"chanelandMoi-card-ImgInfo is-hidden\">` + config.chanelandmoiPLP.chanelrestoringLabeltextThree + `</p>\n          </div>\n        </div>\n\n        <div class=\"chanelandMoi-fluidcomponent chanelandMoi-card\">\n          <div role=\"heading\" aria-level=\"3\" class=\"chanelandMoi-card-blocks\">\n              <button type=\"button\" aria-expanded=\"false\" class=\"chanelandMoi-card-button\">` + config.chanelandmoiPLP.chanelrestoringLabelFour + `</button>\n          </div>\n          <div class=\"chanelandMoi-card-text\">\n              <div class=\"chanelandMoi-card-ImgBlock\">\n                <img src=\" `+ ACC.config.commonResourcePath +`/images/storage.png\" alt=\"\" class=\"chanelandMoi-card-Image chanelandMoi-card-storage\"/>\n              </div>\n              <p class=\"chanelandMoi-card-ImgInfo is-hidden\">` + config.chanelandmoiPLP.chanelrestoringLabeltextFour + `</p>\n          </div>\n        </div>\n\n        <div class=\"chanelandMoi-fluidcomponent chanelandMoi-card\">\n          <div role=\"heading\" aria-level=\"3\" class=\"chanelandMoi-card-blocks\">\n              <button type=\"button\" aria-expanded=\"false\" class=\"chanelandMoi-card-button\">` + config.chanelandmoiPLP.chanelrestoringLabelFive + `</button>\n          </div>\n          <div class=\"chanelandMoi-card-text\">\n              <div class=\"chanelandMoi-card-ImgBlock\">\n                <img src=\" `+ ACC.config.commonResourcePath +`/images/appreciate.png\" alt=\"\" class=\"chanelandMoi-card-Image chanelandMoi-card-appreciate\"/>\n              </div>\n              <p class=\"chanelandMoi-card-ImgInfo is-hidden\">` + config.chanelandmoiPLP.chanelrestoringLabeltextFive + `</p>\n          </div>\n        </div>\n        </div>\n      </div>\n      </div>`\n\n      window.dataLayer.push({\n        'eventCategory': 'chanel et moi',\n        'eventAction': 'services',\n        'eventLabel': 'chanel restoring care',\n        'event': 'uaevent' // associated event\n      })\n\n      return popin.open({\n        html: template,\n        label: config.chanelandmoiPLP.chanelrestoringTitle,\n        role: 'dialog',\n        modifiers: 'is-medium ChanelAndMoi restoring-care-popup',\n        modal: true,\n        opener: null,\n        manageFocus: true,\n        forceInert: true,\n        outerClose: true,\n        page: 'ChanelandMoi-PLP',\n        action: 'SetEuDefaultAddress'\n      }).then((modal) => {\n          let popinWrapper = selectAll(\".chanelandMoi-card\")\n          for (let i = 0 ; i < popinWrapper.length; i++) {\n            popinWrapper[i].addEventListener('click', servicesToggleInfo)\n          }\n          let popinModal = select(\".ChanelAndMoi\")\n          popinModal.setAttribute('aria-modal', true)\n        return {modal}\n      })\n}\n\nfunction servicesToggleInfo(e) {\n  const cardtextInfo = this.children[1].children[1]\n  const cardImage = this.children[1].children[0].children[0]\n  const servicecardbutton = this.children[0].children[0]\n  if(cardtextInfo.classList.contains(\"is-hidden\")){\n    const hideTextinfo = selectAll(\".chanelandMoi-card-ImgInfo\")\n    const displayImage = selectAll(\".chanelandMoi-card-Image\")\n    const cardTilebutton = selectAll(\".chanelandMoi-card-button\")\n    for (let j = 0 ; j < hideTextinfo.length; j++) {\n      hideTextinfo[j].classList.add('is-hidden')\n    }\n    for (let k = 0 ; k < displayImage.length; k++) {\n      displayImage[k].classList.remove('is-hidden')\n    }\n    for (let l = 0 ; l < cardTilebutton.length; l++) {\n      cardTilebutton[l].setAttribute('aria-expanded', false)\n    }\n    servicecardbutton.setAttribute('aria-expanded', true)\n    cardImage.classList.add('is-hidden')\n    cardtextInfo.classList.remove('is-hidden')\n  }\n  else {\n    servicecardbutton.setAttribute('aria-expanded', false)\n    cardImage.classList.remove('is-hidden')\n    cardtextInfo.classList.add('is-hidden')\n  }\n}\nexport default function (el) {\n  return new Account(el)\n}\n","import {select, selectAll} from 'lib/selectors'\nimport {focusElement, isWideScreen, tabIndexToZero} from 'lib/helpers'\nimport popin from 'modules/popin'\nimport config from 'lib/config'\nimport * as xhr from 'modules/fetch'\nimport {cloneDeep} from 'lodash'\nimport * as dBind from 'delegate'\n\n// Selectors\nconst orderNumberEl = select('.js-cancel-order')\nconst orderNumber = orderNumberEl ? orderNumberEl.getAttribute('data-order-code') : ''\nconst orderType = orderNumberEl ? orderNumberEl.getAttribute('data-order-type') : ''\n\nclass CancelOrder {\n  constructor(el) {\n    this.el = el\n    this.buttonClose = null\n    this.params = {\n    }\n  }\n\n  async init() {\n    this.buildTemplate()\n  }\n\n  // templates\n  buildTemplate() {\n    this.template =\n      `<div class=\"popin-text text-center\" data-close-label=\"${window.config.locales.account.orderCancelled.closePopUp}\" data-test=\"secCancelOrderPopin\">\n        <div class=\"modal-body\">\n          <form id=\"cancelOrderForm\" novalidate=\"true\" method=\"\" action=\"#\">\n            <h1 id=\"title-cancel-order\" class=\"heading is-5\">\n              ${window.config.locales.account.orderCancelled.popUpHeading}\n            </h1>\n            <p id=\"js-order-sub-heading\" class=\"sub-heading\">${orderType === 'notRefunded' ? window.config.locales.account.orderCancelled.popUpMessage : window.config.locales.account.orderCancelled.popUpMessageApple}</p>\n            <div id=\"js-order-cancel-button\">\n              <div class=\"button__wrapper\">\n                  <button type=\"button\" class=\"button is-secondary validate js-confirm-cancel-order\" data-test=\"btnCancelOrderSubmit\">\n                    <span class=\"button__wrapper\">\n                      <span class=\"label\">${window.config.locales.account.orderCancelled.btnConfirm}</span>\n                    </span>\n                  </button>\n              </div>\n              <button type=\"button\" class=\"link is-underline js-popin-close\">\n                <span>${window.config.locales.account.orderCancelled.closeBtn}</span>\n              </button>\n            </div>\n          </form>\n        </div>\n      </div>`\n  }\n\n\n  onOpenPopin() {\n    this.setDomElements()\n    this.cancelOrderDLPush()\n  }\n  \n  cancelOrderDLPush() {\n    window.document.DLKit.push('on-tracking', {\n      event: 'uaevent',\n      eventAction: 'cancel order',\n      eventLabel: orderNumber,\n      eventCategory: 'order history'\n    })\n  }\n  \n  onConfirmCancelDlPush() {\n    window.document.DLKit.push('on-tracking', {\n      event: 'uaevent',\n      eventAction: 'confirm cancellation',\n      eventLabel: orderNumber,\n      eventCategory: 'cancel order'\n    })\n  }\n  \n  onCloseBtnDlPush() {\n    this.popinEl = select('.cancelOrder')\n    this.buttonContinue = select('.js-confirmationBtn', this.popinEl)\n    window.document.DLKit.push('on-tracking', {\n      event: 'uaevent',\n      eventAction: 'close_cross',\n      eventLabel: orderNumber,\n      eventCategory: this.buttonContinue ? 'order cancelled' : 'cancel order'\n    })\n\n    if (this.buttonContinue) {\n     const url = select('.js-cancel-order').getAttribute('data-order-cancel-url')\n     const orderDetailUrl = url.replace('/cancel', '/')\n     window.location = orderDetailUrl\n    }\n  }\n  \n  onCloseAnchorDlPush() {\n    window.document.DLKit.push('on-tracking', {\n      event: 'uaevent',\n      eventAction: 'close_btn',\n      eventLabel: orderNumber,\n      eventCategory: 'cancel order'\n    })   \n  }\n  \n  setDomElements() {\n    this.popinEl = select('.cancelOrder')\n    this.buttonClose = select('button.popin__close', this.popinEl)\n    this.anchorClose = select('button.js-popin-close:not(.popin__close)', this.popinEl)\n    this.buttonConfirmOrder = select('.js-confirm-cancel-order', this.popinEl)\n    this.buttonValidate = select('button.validate', this.popinEl)\n    this.buttonValidate.addEventListener('click', this.onConfirmCancel.bind(this))\n    this.buttonConfirmOrder.addEventListener('click', this.onConfirmCancelDlPush.bind(this))\n    this.buttonClose ? this.buttonClose.addEventListener('click', this.onCloseBtnDlPush.bind(this)) : ''\n    this.anchorClose ? this.anchorClose.addEventListener('click', this.onCloseAnchorDlPush.bind(this)) : ''\n    if (this.popinEl) {\n      this.popinEl.removeAttribute('aria-labelledby')\n      this.popinEl.setAttribute('aria-label', config.locales.account.orderCancelled.popUpHeading)\n    }\n  }\n\n  onConfirmCancel(event) {\n    event.preventDefault()\n    const url = select('.js-cancel-order').getAttribute('data-order-cancel-url')\n    const email = select('.js-cancel-order').getAttribute('data-user-email') ? select('.js-cancel-order').getAttribute('data-user-email') : ''\n    if (url) {\n      xhr.post(url, {\"type\" : 'text'}).then(data=> {\n    \tthis.confirmPopUp(url,email)\n      })\n       .catch(data => {\n         console.error(data)\n         const url = select('.js-cancel-order').getAttribute('data-order-cancel-url')\n         const orderDetailUrl = url.replace('/cancel', '/')\n         window.location = orderDetailUrl\n       })\n     }\n   }\n  \n  confirmPopUp (url,email) {\n    const orderCurrency = select('.js-cancel-order').getAttribute('data-order-currency')\n    const orderDetailUrl = url.replace('/cancel', '/')\n    const popinText = select('div.popin-text')\n    popinText ? popinText.classList.add('confirmed') : ''\n    select('#title-cancel-order').innerHTML =  config.locales.account.orderCancelled.confirmedMessage\n    select('#js-order-sub-heading').innerHTML = config.locales.account.orderCancelled.userEmail +' '+ email\n    select('#js-order-cancel-button').innerHTML = '<button class=\"button js-confirmationBtn is-tertiary\" role=\"link\" href='+orderDetailUrl+'><span><span>'+config.locales.account.orderCancelled.continueBtn+'</span><span></button>'\n    this.buttonClose = select('.js-popin-close', this.popinEl)\n    this.buttonContinue = select('.js-confirmationBtn', this.popinEl)\n    this.buttonContinue.addEventListener('click', this.redirectToOrderPageDlPush.bind(this))\n    this.popinEl.setAttribute('aria-label', config.locales.account.orderCancelled.confirmedMessage)\n    const hiddenSpan = select('span.is-sr-only', this.buttonClose)\n    hiddenSpan ? hiddenSpan.innerHTML = config.locales.account.orderCancelled.closePopUpConfirmed : ''\n    this.buttonClose ? this.buttonClose.setAttribute('role', 'link') : ''\n    window.removeEventListener('keydown', this.onEscapeKeyClicked)\n    window.addEventListener('keydown', this.redirectToOrderPageOnEscape.bind(this))\n    focusElement(this.buttonClose, {notChangeTabIndex: true})\n    window.document.DLKit.push('on-tracking', {\n      event: 'nievent',\n      eventAction: 'confirmation',\n      eventLabel: orderNumber,\n      eventCategory: 'order cancelled',\n      ecommerce: {\n         \"currencyCode\": orderCurrency ? orderCurrency : '',\n         \"refund\": {\n            \"actionField\": {\n               \"id\": orderNumber\n             }\n          }\n       }\n    })\n  } \n  \n  redirectToOrderPageDlPush() {\n    window.document.DLKit.push('on-tracking', {\n      event: 'uaevent',\n      eventAction: 'continue',\n      eventLabel: orderNumber,\n      eventCategory: 'order cancelled', \n    })  \n  }\n\n  /**\n   * display a yes(remove) or no(cancel) dialog\n   * @param data {Object}: contains additional params\n   */\n  open() {\n    popin.open({\n      html: this.template,\n      role: 'dialog',\n      modifiers: 'is-relative cancelOrder',\n      opener: null,\n      manageFocus: true,\n      forceInert: true,\n      modal: true,\n      action: 'removeCancelModal',\n      outerClose: false\n    }).then(() => {\n      this.onOpenPopin()\n    })\n    // To catch the esc key\n    window.addEventListener('keydown', this.onEscapeKeyClicked)\n  }\n\n  /**\n   * Close the active modal\n   */\n  closeModal() {\n    window.removeEventListener('keydown', this.onEscapeKeyClicked)\n    popin.hide() \n  }\n\n  /**\n   * Triggered once user clicked on the modal cancel button\n   * @param params {MouseEvent}: contains MouseEvent parameters\n   */\n  onModalCancelButtonClicked = (e) => {\n    this.closeModal()\n    focusElement(this.params.clickedElm)\n    if (!isWideScreen()) {\n      const links = selectAll('.collapse-panel__header .js-collapse-button')\n      if (links) {\n        tabIndexToZero(links)\n      }\n    }\n  }\n\n\n  /**\n   * Triggered once user clicked on keyboard inputs\n   * @param e {MouseEvent}: MouseEvent parameters \n   */\n\n  onEscapeKeyClicked = (e) => {\n    if ((e.key === 'Escape' || e.key === 'Esc' || e.keyCode === 27)) {\n      this.onModalCancelButtonClicked(e)\n    }\n  }\n  \n  redirectToOrderPageOnEscape = (e) => {\n    if ((e.key === 'Escape' || e.key === 'Esc' || e.keyCode === 27)) {\n      const url = select('.js-cancel-order').getAttribute('data-order-cancel-url')\n      const orderDetailUrl = url.replace('/cancel', '/')\n      window.location.href = orderDetailUrl\n      setTimeout(function() {\n        window.location.href = orderDetailUrl\n      }, 100)\n     }\n   }\n }\n\n\nconst initCancelOrder = () => {\n  const cancelOrder = new CancelOrder()\n  cancelOrder.init().then(() => {\n\t  cancelOrder.open()\n  })\n}\n\nexport default initCancelOrder","import bind from 'delegate'\nimport * as xhr from 'modules/fetch'\nimport popin from 'modules/popin'\nimport { select, selectAll, getCollection } from 'lib/selectors'\nimport { read as readCookie, remove as removeCookie } from 'modules/cookie'\nimport config from 'lib/config'\nimport { Manager, CHECK_API } from 'lib/events'\nimport { encodePasswords, decodePasswords } from 'lib/helpers'\n\n// This cookie can be created manually in your browser\n// to display the popin after a page refresh\n// ie. forceResetPassword=true\nconst COOKIE_KEY = 'forceResetPassword'\nconst POPIN_SELECTOR = '#js-modal-prompt-password-update'\nconst FORM_SELECTOR = '#js-modal-prompt-password-update-form'\n\nexport default function resetPassword() {\n  let isVisible = false\n  let followRedirect = true\n  let userData\n\n  // Redirect is not followed from opc\n  function handleFromLogin() {\n    removeCookie(COOKIE_KEY)\n    showPopin(select(POPIN_SELECTOR), 'login')\n  }\n\n  function handleFromOPC(data) {\n    // Let Gigya handle the login\n    followRedirect = false\n    // Save userData from later use\n    userData = data\n    // Set reset password hidden email to sign in value if necessary\n    const hiddenEmailEl = document.getElementById('emailID')\n    if (hiddenEmailEl.value.length === 0) {\n      const sourceEl = document.getElementById('login-email')\n      if (sourceEl) {\n        hiddenEmailEl.value = sourceEl.value\n      }\n    }\n    showPopin(select(POPIN_SELECTOR), 'checkout')\n  }\n\n  function showPopin(formContainerEl, page) {\n    isVisible = true\n\n    popin.open({\n      label: config.locales.modal.passwordForcedUpdate.label,\n      html: fixRevealPassword(formContainerEl).innerHTML,\n      role: 'dialog',\n      modifiers: 'is-big is-my-account',\n      opener: null,\n      manageFocus: false,\n      forceInert: true,\n      modal: true,\n      closeButton: 'is-popin-close',\n      closeButtonDataTest: 'btnClosePasswordUpdateRequired',\n      page\n    })\n  }\n\n  function checkAPI(json) {\n    // 403100 Gigya status: Pending password change\n    // The password is flagged and has to be updated\n    if (json.errorCode === 403100) {\n      // Set hidden field to previously entered email value\n      const inEmailEl = document.getElementById('login-email')\n      const outEmailEl = document.getElementById('emailID')\n      outEmailEl.value = inEmailEl.value\n      isVisible = false\n      if (!isVisible) {\n        handleFromLogin()\n      }\n    }\n  }\n\n  function handleSubmit(e) {\n    function handleSuccess(data) {\n      popin.hide()\n      isVisible = false\n      // From login: redirect to the given URL\n      if (followRedirect) {\n        window.location = data.redirectURL\n      }\n      // From OPC: validate login and move to next step\n      else if (userData) {\n        delete userData.forceUpdate\n        Manager.publish('gigyaLogin', userData)\n      }\n    }\n\n    const form = e.delegateTarget\n    const selectors = ['input#password-currentPassword-popin', 'input#password-newPassword-popin']\n    if (form.invalid.length) {\n      return\n    }\n\n    e.preventDefault()\n\n    // Encodes password (current and new) before sent\n    encodePasswords(selectors, form)\n\n    xhr.submit(form)\n      .then(handleSuccess)\n      .catch(err => {\n        console.error(err)\n      })\n\n    // Restore passwords once they are sent\n    decodePasswords(selectors, form)\n\n  }\n\n\n  const promptPasswordMode = readCookie(COOKIE_KEY)\n\n  Manager.subscribe(CHECK_API, checkAPI)\n  bind(document.body, FORM_SELECTOR, 'submit', handleSubmit)\n  if (promptPasswordMode) {\n    handleFromLogin()\n  }\n\n  return { handleFromOPC }\n}\n\n// Helpers that updates the ids so the JS bindings remains active after cloning\n// ie. use of the show password relies on ids, duplicate ids messes it up\nfunction fixRevealPassword(nodeElement) {\n  const copyEl = nodeElement.cloneNode(true)\n  selectAll('input[type=password]', copyEl).forEach(el => el.setAttribute('id', `${el.id}-popin`))\n  selectAll('[data-toggle-password]', copyEl).forEach(el => el.setAttribute('data-toggle-password', `${el.dataset.togglePassword}-popin`))\n  selectAll('label[for]', copyEl).forEach(el => el.setAttribute('for', `${el.getAttribute('for')}-popin`))\n  return copyEl\n}\n","import {select, selectAll, getCollection} from 'lib/selectors'\nimport config from 'lib/config'\nimport bind from 'delegate'\n\n/**\n * Triggered once user change newsletter checkbox value\n * @param evt {object}: click event\n */\nexport default function preferenceSetting(el) {\n  \n  let heightOfNewsletterRule = 0 \n  \n  function handlePreferenceSetting(e) {\n    const newsletterElm = e.delegateTarget\n\n    if (newsletterElm) {\n      const newsletterRulesElm = select('div#newsletter-rules')\n      const isChecked = newsletterElm.checked\n      \n      if(newsletterRulesElm) {\n        if (config.country === 'GB' && config.pageName === 'checkout') {\n          if (isChecked) {\n            if (newsletterRulesElm.hasAttribute('hidden')) {\n              newsletterRulesElm.classList.remove('is-hidden')\n              newsletterRulesElm.removeAttribute('hidden')\n            }\n            newsletterRulesElm.classList.add('has-margin-bottom-sm')\n          } else {\n            newsletterRulesElm.setAttribute('hidden', '')\n            newsletterRulesElm.classList.remove('has-margin-bottom-sm')\n            newsletterRulesElm.classList.add('is-hidden')\n          }\n          \n        } else {\n        // Add/Remove class to avoid margin mistake\n          newsletterRulesElm.classList.remove('is-hidden')\n          newsletterRulesElm.removeAttribute('hidden')\n        } \n\n        // Used only for first times to get height\n        if (!heightOfNewsletterRule) {\n          newsletterRulesElm.classList.remove('is-hidden')\n          heightOfNewsletterRule = newsletterRulesElm.clientHeight\n          newsletterRulesElm.style.height = 0\n        }\n\n        // Start animation for both check and unchecked\n        TweenLite.fromTo(newsletterRulesElm, (isChecked ? 1 : .4),\n          { autoAlpha: isChecked ? 0 : .5, height: isChecked ? 0 : heightOfNewsletterRule },\n          { autoAlpha: isChecked ? 1 : .0, height: isChecked ? heightOfNewsletterRule : 0 }\n        ).eventCallback('onComplete',() => {\n          if (isChecked) {\n            newsletterRulesElm.removeAttribute('hidden')\n          } else {\n            newsletterRulesElm.setAttribute('hidden', '')\n          }\n        })\n      }\n\n      // Stuff for the Newsletter interest\n      getCollection('.gigya-status', el).forEach((elm) => {\n        elm.value = isChecked ? 'INTERESTED' : 'UNSET'\n      })\n\n      const gigyaEmailStatusElm = selectAll('.gigya-status-value', el)\n      gigyaEmailStatusElm.forEach(el => {\n        el.value = isChecked ? 'OPTIN' : 'UNSET'\n      })\n        \n    }\n  }\n  \n  bind(el, 'input#newsletter-subscribe', 'change', handlePreferenceSetting)\n  \n}\n","import bind from 'delegate'\nimport * as xhr from 'modules/fetch'\nimport { select } from 'lib/selectors'\n\nexport default function resetPassword(el) {\n  function handleResetPassword(data, form) {\n    const message = data.successMessage\n    const area = document.createElement('p')\n    const target = form.parentNode\n\n    form.parentNode.removeChild(form)\n    area.innerHTML = message\n\n    target.appendChild(area)\n    area.setAttribute('tabindex', '-1')\n    area.focus()\n  }\n\n  function handleSubmitResetPassword(e) {\n    const form = e.delegateTarget\n\n    if (form.invalid.length) {\n      return\n    }\n\n    e.preventDefault()\n\n    xhr.submit(form)\n      .then(data => handleResetPassword(data, form))\n      .catch(err => {\n        console.error(err)\n      })\n  }\n\n  // Saves e-mail after password reset for displaying it on a sign-in page\n  const resetPasswordPage = document.getElementsByClassName('js-reset-password-form')\n  if (resetPasswordPage.length > 0) {\n    if (window.sessionStorage.lastUsedEmail) {\n      const emailId = select('#email')\n      if (emailId) {\n        emailId.value = window.sessionStorage.lastUsedEmail\n        emailId.focus()\n      }\n    }\n    resetPasswordPage[0].addEventListener('focusout', () => {\n      const resetPasswordEmail = document.getElementById('email')\n      window.sessionStorage.setItem('lastUsedEmail', resetPasswordEmail.value)\n    }, false)\n  }\n\n  bind(el, 'form[novalidate]', 'submit', handleSubmitResetPassword)\n}\n","import * as xhr from 'modules/fetch'\nimport notifier from 'modules/notifier'\nimport Loader from 'ui/widgets/loader'\nimport inert from 'lib/inert'\nimport { select, getCollection, selectAll } from 'lib/selectors'\nimport { Manager } from 'lib/events'\nimport { focusElement } from 'lib/helpers' \nimport config from 'lib/config'\n\nconst FIELD_SELECTOR = '[data-subscription-field]'\nconst FIELD_SELECTOR_COMMUNICATION = '[data-communication-means]'\nconst COMMUNICATION_CHANNEL_SELECTOR = '[data-communication-channels]'\nconst FIELD_SELECTOR_PREFERENCES = '.customer-preferences'\nconst TITLE_SELECTOR = 'h1.heading'\nconst CHECKBOX_SELECTOR = '[data-preference-division]'\n\nexport default function subscription(el) {\n  const checkboxSelectors = getCollection(CHECKBOX_SELECTOR, document.body)\n  const checkboxesAOI = getCollection('input[data-preference-division]', document.body)\n  const checkboxEmail = select('[data-communication-means=\"email\"]', document.body)\n  const euEmailCheckbox = select('.chkbxEmailEu')\n  const elementCC = select('#communication')\n  const elementAOI = select('#area-of-interest')\n\n  function handleSubmit(e) {\n    const form = e.delegateTarget\n    const formId = form.getAttribute('id')\n    const parentEl = document.querySelector('.js-main-content')\n    const prefContent = document.querySelector('.customer')\n    const loader = new Loader(parentEl, {\n      referenceEl: parentEl,\n      delay: 0\n    })\n    if (formId === 'unsubscribeForm') {\n      loader.init()\n      loader.create()\n      inert.set(prefContent)\n    }\n\n    if (form.invalid.length) {\n      return\n    }\n\n    e.preventDefault()\n\n    var paramsData = {}\n    let inputs\n    if (formId === 'preferencesCommunication') {\n      inputs = form.querySelectorAll(FIELD_SELECTOR_COMMUNICATION)\n      form.action = config.webservices.account.userMedias\n    } else {\n      inputs = form.querySelectorAll(FIELD_SELECTOR)\n    }\n\n    var checkedInputs = [];\n    const mainCheckbox = select('input#preferences-subscribe')\n    const preferencesRulesElm = selectAll('.subscirbe-section')\n    const eachNewsletterAoiSelector = selectAll('[data-preference-division]')\n    inputs.forEach(input => {\n      paramsData[input.name] = input.checked\n      if (input.checked && !input.classList.contains('is-hidden')) {\n        checkedInputs.push(input)\n      }\n    })\n    if (checkedInputs.length == 0 ) {\n    \tif (mainCheckbox) {\n    \t\tmainCheckbox.checked = false\n    \t}\n    \tif (formId === 'preferencesCommunication') {\n    \t\tform.action = config.webservices.account.subscribePreferences\n    \t\tparamsData = {subscribe:\"false\"}\n    \t} \n    \teachNewsletterAoiSelector.forEach((el) => {\n    \t\tif (!el.classList.contains('hiddenInput')) {\n    \t\t\tel.checked = false\n    \t\t\tpreferencesRulesElm.forEach((el) => el.classList.add('is-hidden'))\n    \t\t}\n    \t})\n\n\n    }\n    else {\n        var isPushRequired = false\n        var preferenceCount = 0 \n        var checkCount = select(\"#checkCount\") ? select(\"#checkCount\").value : null\n        checkedInputs.forEach((input) => { \n          if (input.classList.contains('communication-channel')) {\n            isPushRequired = true\n            preferenceCount++\n          }\n        })\n        \n        if ( ( checkCount == null) || ( isPushRequired && checkCount != null && preferenceCount > checkCount ) ) {\n          dataLayer.push(\n              { 'eventCategory': 'preference center',\n                'eventAction': 'newsletter',\n                'eventLabel': 'subscription',\n                'event': 'uaevent'\n              }\n          )\n        }\n    }\n \n    if (config.country === 'GB' || config.country === 'CA') {\n      checkErrors(formId)\n      if ((elementCC.classList.contains('error-shown') || elementAOI.classList.contains('error-shown')) && formId !== 'unsubscribeForm') {\n        return\n      } else {\n        xhr.submit(form, {\n          data: paramsData\n        })\n        .then(data => {\n          handleSubscriptionUpdate(data, form)\n          if (formId === 'unsubscribeForm') {\n            const loaderButton = select('[type=submit]', form)\n            if (loaderButton) loaderButton.classList.remove('is-disabled')\n            unsubscribeForm(formId, loader, unsubscribeForm)\n          }\n        })\n        .catch(err => {\n          if (formId === 'unsubscribeForm') {\n            inert.unset(prefContent)\n            return new Promise(resolve => loader.destroy(resolve))\n          }\n          return console.error(err)\n        })\n      }\n    } else {\n      xhr.submit(form, {\n        data: paramsData\n      })\n      .then(data => {\n        handleSubscriptionUpdate(data, form)\n        if (formId === 'unsubscribeForm') {\n          const loaderButton = select('[type=submit]', form)\n          if (loaderButton) loaderButton.classList.remove('is-disabled')\n          unsubscribeForm(formId, loader, unsubscribeForm)\n        }\n      })\n      .catch(err => {\n        if (formId === 'unsubscribeForm') {\n          inert.unset(prefContent)\n          return new Promise(resolve => loader.destroy(resolve))\n        }\n        return console.error(err)\n      })\n    }\n  }\n  \n  function handlePreferences(e) {\n    const form = e.delegateTarget\n    let count = 0\n    if (form.invalid.length) {\n      return\n    }\n    e.preventDefault()\n    var paramsData = {}\n    let inputs = selectAll(FIELD_SELECTOR_PREFERENCES)\n    inputs.forEach(input => {\n      paramsData[input.name] = input.checked\n    })\n    if (config.country === 'KR') {\n      let communicationChannelElm = selectAll(COMMUNICATION_CHANNEL_SELECTOR)\n      if (communicationChannelElm) {\n        communicationChannelElm.forEach(input => {\n          if (input.checked) {\n            count ++\n          }     \n        })\n      }\n      if (count > 0) {\n        dataLayer.push ({ \n          'eventCategory': 'preference center',\n          'eventAction': 'newsletter',\n          'eventLabel': 'subscription',\n          'event': 'uaevent'\n        }) \n      }\n    }\n    xhr.submit(form, {data: paramsData}).then(data => {\n      handleSubscriptionUpdate(data, form)\n    })\n    .catch(err => {\n      console.error(err)\n    }) \n  }\n  \n   const consentList = select('ul.preference-checkbox')  \n   const listItem = selectAll('li', consentList)\n   if (listItem) {\n     listItem.forEach((element) => {\n       const seeMoreButton = select('.concierge-see-more', element)\n       if (seeMoreButton) {\n         seeMoreButton.addEventListener('click', toggleSeeMore)\n       }\n     })\n   }\n   \n  function toggleSeeMore(e) {\n    const seeMoreBtn = e.target\n    const seeMoreContent = seeMoreBtn.closest('div').nextElementSibling\n    if (seeMoreContent.hasAttribute('hidden')) {\n      seeMoreContent.removeAttribute('hidden');\n      e.target.innerText = config.conciergeDelivery.seeLessBtn\n      seeMoreContent.focus()\n    } else {\n      seeMoreContent.setAttribute('hidden', '')\n      e.target.innerText = config.conciergeDelivery.seeMoreBtn\n      seeMoreBtn ? seeMoreBtn.focus() : e.target\n    }\n  }\n\t            \n\n  function handleSubscriptionUpdate(data, form) {\n    data.focusElement = form.querySelector('[type=\"submit\"]')\n    notifyUpdate(data)\n  }\n\n  function notifyUpdate(data) {\n    if (!data.message) {\n      return\n    }\n\n    notifier.show({\n      name: data.message.label,\n      message: data.message.message || data.message,\n      close: data.message.close,\n      opener: data.focusElement,\n      noFocus: !document.body.classList.contains('is-using-keyboard')\n    })\n  }\n\n  function unsubscribeForm(formId, loader, prefContent) {\n    getCollection('.js-preference-subscribe-unsubscribe', document.body).forEach((checkBoxElm) => {\n      checkBoxElm.checked = false\n    })\n    const marketingCom = select('#marketing-communications')\n    if(marketingCom) {\n      const unsubscribeCommunication = select('.context.unsubscribe')\n      marketingCom.checked = false\n      focusElement(marketingCom)\n      if(sectionPreferences) {\n        sectionPreferences.classList.add('is-hidden')\n      }\n      if (unsubscribeCommunication) unsubscribeCommunication.setAttribute('hidden', '')\n    }\n    checkboxEmail.checked = false\n\n    inert.unset(prefContent)\n\n    return new Promise(resolve => loader.destroy(resolve))\n  }\n\n  function onNotificationClosed() {\n    const titleElm = select(TITLE_SELECTOR)\n    if (titleElm) {\n      focusElement(titleElm)\n    }\n  }\n\n  function handleCheckbox() {\n    const arrCheckedInputs = checkboxesAOI.map(check => check.checked)\n\n    const isChecked = arrCheckedInputs.find(input => input === true)\n    if (isChecked && !euEmailCheckbox && checkboxEmail && (config.country !== 'GB' && config.country !== 'CA')) {\n      checkboxEmail.checked = true\n    }\n\n    isUnsubscribed()\n  }             \n \n  function handleMailCheckbox(e) {\n    const input = e.target\n    if (input.checked === false && !euEmailCheckbox && (config.country !== 'GB' && config.country !== 'CA')) {\n      checkboxesAOI.forEach(checkbox => { checkbox.checked = false })\n    }\n  }\n  if (config.country === 'KR' || config.country === 'CN') { \n    el.addEventListener('submit', handlePreferences)\n  } else {\n    el.addEventListener('submit', handleSubmit)\n  }\n  checkboxSelectors.forEach(selector => selector.addEventListener('change', handleCheckbox))\n  if (checkboxEmail)\n    checkboxEmail.addEventListener('change', handleMailCheckbox)\n  Manager.subscribe('notificationClosed', onNotificationClosed)\n\n\n  // For UK purpose\n  const inputMarketing = select('#marketing-communications')\n  const sectionPreferences = select('.preferences-user.for-uk')\n  const checkboxesAOIUK = selectAll('.preference-division')\n  const checkboxesCC = selectAll('.communication-channel')\n  \n  inputMarketing && inputMarketing.addEventListener('change', handleInputChange)  \n  \n    if (inputMarketing && checkIfOneAOIUKChecked()) { \n      inputMarketing.checked = true\n      if(config.country !== 'BR') {\n        sectionPreferences && sectionPreferences.classList.remove('is-hidden')\n      } else {       \n        const newsletterRulesElm = select('div#newsletter-rules')\n        newsletterRulesElm.removeAttribute('hidden')\n      }    \n    }       \n  \n  if (checkboxesCC) {\n    if (!checkIfOneAOIUKChecked()) {\n      checkboxesCC.forEach(checkbox => {\n        checkbox.disabled = true\n      })\n    }\n    checkboxesCC.forEach(checkbox => {\n      checkbox.addEventListener('change', handleCheckBoxCC)\n    })\n  }\n\n  function handleCheckBoxCC(e) {\n    isUnsubscribed()\n  }\n\n  function handleInputChange(e) { \n    const checkboxes = selectAll('.preferences-user [type=\"checkbox\"]')\n    const unsubscribeCommunication = select('.context.unsubscribe')\n    const newsLetter = select('#newsletter-rules')\n    if(config.country !== 'BR') {\n      if (e.currentTarget.checked === true) {\n        sectionPreferences.classList.remove('is-hidden')  \n        if (unsubscribeCommunication) unsubscribeCommunication.removeAttribute('hidden')\n      } else {\n        sectionPreferences.classList.add('is-hidden')\n        if (unsubscribeCommunication) unsubscribeCommunication.setAttribute('hidden', '')\n      }\n    } else if (e.currentTarget.checked === true) {\n        newsLetter.removeAttribute('hidden')\n      } else {\n        newsLetter.setAttribute('hidden', '') \n      }        \n    if (checkboxes) {\n      checkboxes.forEach(checkbox => { \n        checkbox.checked = e.currentTarget.checked\n        checkbox.disabled = false\n      })\n    }\n    checkboxesCC.forEach(checkbox => {\n      if (!checkIfOneAOIUKChecked()) {\n        checkbox.checked = false\n        checkbox.disabled = true\n      } else {\n        checkbox.disabled = false\n      }\n    })\n    \n  }\n\n  function checkIfAOIUKChecked() {\n    let boxChecked = selectAll('.preference-division:checked')\n    if (boxChecked.length == checkboxesAOIUK.length) {\n      return true\n    } else {\n      return false\n    }\n  }\n\n  function checkIfOneAOIUKChecked() { \n    let boxChecked = selectAll('.preference-division:checked')\n    if (boxChecked.length > 0) {\n      return true\n    } else {\n      return false\n    }\n  }\n\n  function checkIfCChecked() {\n    let boxChecked = selectAll('.communication-channel:checked')\n    if (boxChecked.length == checkboxesCC.length) {\n      return true\n    } else {\n      return false\n    }\n  }\n\n  function checkIfOneCChecked() {\n    let boxChecked = selectAll('.communication-channel:checked')\n    if (boxChecked.length > 0) {\n      return true\n    } else {\n      return false\n    }\n  }\n\n  function checkErrors(formId) {\n    if(!checkIfOneCChecked() && !checkIfOneAOIUKChecked()) {\n      removeErrorMsg(elementCC)\n      removeErrorMsg(elementAOI)\n      return\n    }\n    if (!checkIfOneCChecked()) {\n      createErrorMessage(window.config.webservices.account.preferencesErrorCC, elementCC)\n      a11yDescription('add', checkboxesCC, elementCC)\n    } else {\n      removeErrorMsg(elementCC)\n      a11yDescription('remove', checkboxesCC)\n    }\n    if (!checkIfOneAOIUKChecked()) {\n    \t if (!(formId === 'unsubscribeForm')) {\t\n    \t     createErrorMessage(window.config.webservices.account.preferencesErrorAOI, elementAOI)\n    \t    }\n      a11yDescription('add', checkboxesAOI, elementAOI)\n    } else {\n      removeErrorMsg(elementAOI)\n      a11yDescription('remove', checkboxesAOI)\n    }\n  }\n\n  function createErrorMessage(msg, el) {\n    if(!el.classList.contains('error-shown')) {\n      el.classList.add('error-shown')\n      let errorMessage = document.createElement('p')\n      errorMessage.id = `error-${el.id}`\n      errorMessage.classList.add('error')\n      errorMessage.setAttribute('tabindex', '-1')\n      errorMessage.innerHTML = msg\n      el.insertAdjacentElement('beforebegin', errorMessage)\n    }\n  }\n\n  function removeErrorMsg(el) {\n    if(el.classList.contains('error-shown')) {\n      el.classList.remove('error-shown')\n      let errorMessage = select(`#error-${el.id}`)\n      errorMessage && el.parentNode.removeChild(errorMessage)\n    }\n  }\n\n  function a11yDescription(action, elements, communicationCC) {\n    if(elements) {\n      if(action === 'add') {\n        elements.forEach(el => {\n          el.setAttribute(\"aria-describedby\", `error-${communicationCC.id}`)\n        })\n        elements[0].focus({preventScroll:true})\n      }\n      if(action === 'remove') {\n        elements.forEach(el => {\n          el.removeAttribute(\"aria-describedby\")\n        })\n      }\n    }\n  }\n  /*\n  * Check if user opt out all the comm channels \n  */\n  function isUnsubscribed() {\n    let isAreaSelected = checkboxesAOI.some((element) => element.checked == true)\n    let isCCSelected = checkboxesCC.some((element) => element.checked == true)\n    \n    if (!isAreaSelected && !isCCSelected) {\n      inputMarketing.checked = false\n      const unsubscribeFormBtn = select(\"form[id='unsubscribeForm'] .js-account-unsubscribe-link\")\n      if (unsubscribeFormBtn)\n        unsubscribeFormBtn.click()\n    }\n  }\n}\n"],"sourceRoot":""}