{"version":3,"sources":["webpack:///./patterns/scripts/pages/bridal/index.js"],"names":["BRIDAL_FORM_SELECTOR","BRIDAL_PAGE_CONTAINER","bridal","bind","document","body","onBridalSaveButtonClicked","form","select","radioBtn","catalogRequestRadio","submitButton","i","length","addEventListener","clearRadioButtons","value","checked","catalogRequest","previousElementSibling","name","setAttribute","getAttribute","removeAttribute","e","delegateTarget","invalid","dataLayer","push","getErrors","preventDefault","getRequestType","serialize","MobilePhoneValidation","then","isValid","submitBridalForm","formData","requestType","paper","pdf","invalidFields","errors","fieldName","error","el","headers","bridalContainer","xhr","type","response","blob","filename","disposition","get","indexOf","filenameRegex","matches","exec","replace","link","createElement","href","window","URL","createObjectURL","download","click","config","webservices","confirmation","innerHTML","bridalConTitle","focusElement","onBridalConfirmRedirect","optInNewsletter","catch","data","console","log","bridalscrollTop","url","target","open","scrollTop","documentElement"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AAGA,MAAMA,oBAAoB,GAAG,qBAA7B;AACA,MAAMC,qBAAqB,GAAG,2BAA9B;;AAEA,SAASC,MAAT,GAAkB;AAChBC,iDAAI,CAACC,QAAQ,CAACC,IAAV,EAAeL,oBAAf,EAAqC,QAArC,EAA+CM,yBAA/C,CAAJ;AACD,MAAIC,IAAI,GAAGC,4DAAM,CAACR,oBAAD,CAAjB;AACA,MAAIS,QAAQ,GAAGF,IAAI,CAACG,mBAApB;AACA,MAAIC,YAAY,GAAGH,4DAAM,CAAC,mBAAD,EAAsBD,IAAtB,CAAzB;;AACA,OAAK,IAAIK,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGH,QAAQ,CAACI,MAA7B,EAAqCD,CAAC,EAAtC,EAA0C;AACzCH,YAAQ,CAACG,CAAD,CAAR,CAAYE,gBAAZ,CAA6B,QAA7B,EAAuC,YAAW;AACjDC,uBAAiB,CAACN,QAAD,CAAjB;AACA,WAAKO,KAAL,GAAa,IAAb;AACA,WAAKC,OAAL,GAAe,IAAf;AACM,UAAIC,cAAc,GAAG,KAAKC,sBAA1B;AACAD,oBAAc,CAACF,KAAf,GAAuB,KAAKA,KAA5B;;AACA,UAAIE,cAAc,CAACE,IAAf,IAAuB,KAAvB,IAAgCF,cAAc,CAACE,IAAf,IAAuB,MAA3D,EAAmE;AAClET,oBAAY,CAACU,YAAb,CAA0B,OAA1B,EAAkC,KAAKC,YAAL,CAAkB,mBAAlB,CAAlC;AACA,OAFD,MAEO;AACNX,oBAAY,CAACY,eAAb,CAA6B,OAA7B;AACA;AACJ,KAXJ;AAYA;AACD;;AACD,SAASR,iBAAT,CAA2BN,QAA3B,EAAoC;AACnC,OAAK,IAAIG,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGH,QAAQ,CAACI,MAA7B,EAAqCD,CAAC,EAAtC,EAA0C;AACzCH,YAAQ,CAACG,CAAD,CAAR,CAAYI,KAAZ,GAAoB,KAApB;AACAP,YAAQ,CAACG,CAAD,CAAR,CAAYO,sBAAZ,CAAmCH,KAAnC,GAA2C,KAA3C;AACA;;AACD,OAAK,IAAIJ,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGH,QAAQ,CAACI,MAA7B,EAAqCD,CAAC,EAAtC,EAA0C;AACzCH,YAAQ,CAACG,CAAD,CAAR,CAAYK,OAAZ,GAAsB,KAAtB;AACAR,YAAQ,CAACG,CAAD,CAAR,CAAYO,sBAAZ,CAAmCF,OAAnC,GAA6C,KAA7C;AACA;AACD;;AAED,SAASX,yBAAT,CAAoCkB,CAApC,EAAsC;AACrC,QAAMjB,IAAI,GAAGiB,CAAC,CAACC,cAAf;;AACG,MAAIlB,IAAI,CAACmB,OAAL,CAAab,MAAjB,EAAyB;AACxBc,aAAS,CAACC,IAAV,CAAe;AACd,uBAAiB,gBADH;AAEd,qBAAe,OAFD;AAGd,oBAAcC,SAAS,CAACtB,IAAI,CAACmB,OAAN,CAHT;AAId,eAAS;AAJK,KAAf;AAMC;AACD;;AACJF,GAAC,CAACM,cAAF;AACAC,gBAAc,CAACxB,IAAI,CAACyB,SAAL,EAAD,CAAd;AACAC,+EAAA,GACKC,IADL,CACWC,OAAD,IAAa;AACnBC,oBAAgB,CAAC7B,IAAD,CAAhB;AACC,GAHL;AAIA;;AACD,SAASwB,cAAT,CAAwBM,QAAxB,EAAiC;AAChC,MAAIC,WAAW,GAAG,EAAlB;;AACA,MAAID,QAAQ,CAACE,KAAT,IAAkB,MAAtB,EAA6B;AAC5BD,eAAW,GAAG,OAAd;AACA,GAFD,MAEO,IAAID,QAAQ,CAACG,GAAT,IAAgB,MAApB,EAA2B;AACjCF,eAAW,GAAG,KAAd;AACA,GAFM,MAEA;AACNA,eAAW,GAAG,WAAd;AACA;;AACDX,WAAS,CAACC,IAAV,CAAe;AACX,qBAAiB,gBADN;AAEX,mBAAe,SAFJ;AAGd,kBAAcU,WAHA;AAId,aAAS;AAJK,GAAf;AAMA;;AACD,SAAST,SAAT,CAAmBY,aAAnB,EAAiC;AAChC,MAAIC,MAAM,GAAG,EAAb;AAAA,MAAiBC,SAAS,GAAG,EAA7B;AAAA,MAAiCC,KAAK,GAAG,EAAzC;;AACA,OAAI,IAAIhC,CAAC,GAAG,CAAZ,EAAeA,CAAC,GAAG6B,aAAa,CAAC5B,MAAjC,EAAyCD,CAAC,EAA1C,EAA8C;AAC1C+B,aAAS,GAAGF,aAAa,CAAC7B,CAAD,CAAb,CAAiBiC,EAAjB,CAAoBvB,YAApB,CAAiC,cAAjC,CAAZ;;AACA,QAAIV,CAAC,IAAI,CAAT,EAAY;AACXgC,WAAK,GAAGD,SAAS,GAAG,cAApB;AACA,KAFD,MAEO;AACNC,WAAK,GAAG,MAAMD,SAAN,GAAiB,cAAzB;AACA;;AACDD,UAAM,IAAIE,KAAV;AACA;;AACJ,SAAOF,MAAP;AACA;;AAED,SAASN,gBAAT,CAA0B7B,IAA1B,EAA+B;AAC9B,MAAIuC,OAAO,GAAG,EAAd;AACA,MAAIC,eAAe,GAAGvC,4DAAM,CAACP,qBAAD,CAA5B;AACA+C,sDAAA,CAAWzC,IAAX,EAAgB;AAAC0C,QAAI,EAAC;AAAN,GAAhB,EACCf,IADD,CACM,UAASgB,QAAT,EAAkB;AACvBJ,WAAO,GAAGI,QAAQ,CAACJ,OAAnB;AACA,WAAOI,QAAQ,CAACC,IAAT,EAAP;AACA,GAJD,EAIGjB,IAJH,CAISgB,QAAD,IAAc;AAClB,QAAIA,QAAQ,CAACD,IAAb,EAAmB;AAClB,UAAIG,QAAQ,GAAG,EAAf;AACG,UAAIC,WAAW,GAAGP,OAAO,CAACQ,GAAR,CAAY,qBAAZ,CAAlB;;AACA,UAAID,WAAW,IAAIA,WAAW,CAACE,OAAZ,CAAoB,YAApB,MAAsC,CAAC,CAA1D,EAA6D;AACzD,YAAIC,aAAa,GAAG,wCAApB;AACA,YAAIC,OAAO,GAAGD,aAAa,CAACE,IAAd,CAAmBL,WAAnB,CAAd;;AACA,YAAII,OAAO,IAAI,IAAX,IAAmBA,OAAO,CAAC,CAAD,CAA9B,EAAmC;AACjCL,kBAAQ,GAAGK,OAAO,CAAC,CAAD,CAAP,CAAWE,OAAX,CAAmB,OAAnB,EAA4B,EAA5B,CAAX;AACD;AACJ;;AACJ,UAAIC,IAAI,GAACxD,QAAQ,CAACyD,aAAT,CAAuB,GAAvB,CAAT;AACGD,UAAI,CAACE,IAAL,GAAUC,MAAM,CAACC,GAAP,CAAWC,eAAX,CAA2Bf,QAA3B,CAAV;AACAU,UAAI,CAACM,QAAL,GAAed,QAAf;AACAQ,UAAI,CAACO,KAAL;AACH;;AACDnB,qDAAA,CAAQoB,kDAAM,CAACC,WAAP,CAAmBnE,MAAnB,CAA0BoE,YAAlC,EAA+C;AAACrB,UAAI,EAAC;AAAN,KAA/C,EAA8Df,IAA9D,CACCgB,QAAQ,IAAI;AACfH,qBAAe,CAACwB,SAAhB,GAA4BrB,QAA5B;AACA,UAAIsB,cAAc,GAAGhE,4DAAM,CAAC,+BAAD,EAAiCuC,eAAjC,CAA3B;;AACA,UAAIyB,cAAJ,EAAoB;AACnBC,wEAAY,CAACD,cAAD,CAAZ;AACA;;AACDrE,qDAAI,CAAC4C,eAAD,EAAiB,yBAAjB,EAA4C,OAA5C,EAAqD2B,uBAArD,CAAJ;;AACA,UAAInE,IAAI,CAACyB,SAAL,GAAiB2C,eAArB,EAAsC;AACpChD,iBAAS,CAACC,IAAV,CAAe;AACX,2BAAiB,aADN;AAEX,yBAAe,WAFJ;AAGX,wBAAc,iBAHH;AAIX,mBAAS;AAJE,SAAf;AAME;AACJ,KAhBE,EAgBAgD,KAhBA,CAgBOC,IAAD,IAAU;AACdC,aAAO,CAACC,GAAR,CAAY,gDAAZ;AACD,KAlBD;AAmBAC,mBAAe;AACf,GAxCJ,EAwCMJ,KAxCN,CAwCaC,IAAD,IAAU;AACjBC,WAAO,CAACC,GAAR,CAAY,+CAAZ;AACD,GA1CJ;AA2CA;;AAED,SAASL,uBAAT,CAAiClD,CAAjC,EAAoC;AACnCA,GAAC,CAACM,cAAF;AACCH,WAAS,CAACC,IAAV,CAAe;AACX,qBAAiB,gBADN;AAEX,mBAAe,OAFJ;AAGX,kBAAc,kBAHH;AAIX,aAAS;AAJE,GAAf;AAMD,MAAIqD,GAAG,GAAGzD,CAAC,CAAC0D,MAAF,CAAS5D,YAAT,CAAsB,MAAtB,CAAV;AACAyC,QAAM,CAACoB,IAAP,CAAYF,GAAZ,EAAiB,OAAjB;AACA;;AAED,SAASD,eAAT,GAA2B;AACzB5E,UAAQ,CAACC,IAAT,CAAc+E,SAAd,GAA0B,CAA1B;AACAhF,UAAQ,CAACiF,eAAT,CAAyBD,SAAzB,GAAqC,CAArC;AACD;;AAGc,yEAAUvC,EAAV,EAAc;AAC3B,SAAO,IAAI3C,MAAJ,CAAW2C,EAAX,CAAP;AACD,C","file":"chunks/bridal.js?v=3.23.0","sourcesContent":["import { getCollection, select, closest } from \"lib/selectors\"\nimport * as xhr from 'modules/fetch'\nimport bind from 'delegate'\nimport { isMobileScreen, removeElement,focusElement } from 'lib/helpers'\nimport config from \"lib/config\"\nimport * as MobilePhoneValidation from '../../config/mobile-phone-validation'\n\n\nconst BRIDAL_FORM_SELECTOR = 'form[id=bridalForm]'\nconst BRIDAL_PAGE_CONTAINER = \".js-bridal-main-container\"\n\nfunction bridal() {\t\n  bind(document.body,BRIDAL_FORM_SELECTOR, 'submit', onBridalSaveButtonClicked)\n\tlet form = select(BRIDAL_FORM_SELECTOR)\n\tlet radioBtn = form.catalogRequestRadio\n\tlet submitButton = select('.js-bridal-submit', form)\n\tfor (let i = 0; i < radioBtn.length; i++) {\n\t\tradioBtn[i].addEventListener('change', function() {\n\t\t\tclearRadioButtons(radioBtn)\n\t\t\tthis.value = true\n\t\t\tthis.checked = true\n\t        let catalogRequest = this.previousElementSibling\n\t        catalogRequest.value = this.value \n\t        if (catalogRequest.name == 'pdf' || catalogRequest.name == 'both') {\n\t        \tsubmitButton.setAttribute('title',this.getAttribute(\"data-pdf-fullname\"))\n\t        } else {\n\t        \tsubmitButton.removeAttribute('title')\n\t        }\n\t    });\n\t}\n}\nfunction clearRadioButtons(radioBtn){\n\tfor (let i = 0; i < radioBtn.length; i++) {\n\t\tradioBtn[i].value = false\n\t\tradioBtn[i].previousElementSibling.value = false\n\t}\n\tfor (let i = 0; i < radioBtn.length; i++) {\n\t\tradioBtn[i].checked = false\n\t\tradioBtn[i].previousElementSibling.checked = false\n\t}\n}\n\nfunction onBridalSaveButtonClicked (e){\n\tconst form = e.delegateTarget\n    if (form.invalid.length) {\n    \tdataLayer.push({ \n\t     'eventCategory': 'bridal_catalog',\n\t     'eventAction': 'error', \n\t     'eventLabel': getErrors(form.invalid),\n\t     'event': 'nievent'\n\t\t}); \n      return\n    }\n\te.preventDefault()\n\tgetRequestType(form.serialize())\n\tMobilePhoneValidation.getUserNumber()\n     .then((isValid) => {\n    \tsubmitBridalForm(form)\n     })\n}\nfunction getRequestType(formData){\n\tlet requestType = ''\n\tif (formData.paper == \"true\"){\n\t\trequestType = \"paper\"\n\t} else if (formData.pdf == \"true\"){\n\t\trequestType = \"pdf\"\n\t} else {\n\t\trequestType = \"pdf|paper\"\n\t}\n\tdataLayer.push({ \n     'eventCategory': 'bridal_catalog',\n     'eventAction': 'request', \n\t 'eventLabel': requestType,\n\t 'event': 'uaevent'\n\t})\n}\nfunction getErrors(invalidFields){\n\tlet errors = \"\", fieldName = \"\", error = \"\"\n\tfor(let i = 0; i < invalidFields.length; i++) {\n  \t  fieldName = invalidFields[i].el.getAttribute('autocomplete')\n  \t  if (i == 0) {\n  \t\t  error = fieldName + \" is required\"\n  \t  } else {\n  \t\t  error = \"|\" + fieldName +\" is required\"\n  \t  }\n  \t  errors += error\n    }\n\treturn errors\n}\n\nfunction submitBridalForm(form){\n\tlet headers = \"\"\n\tlet bridalContainer = select(BRIDAL_PAGE_CONTAINER)\n\txhr.submit(form,{type:\"blob\"})\n\t.then(function(response){\n\t\theaders = response.headers\n\t\treturn response.blob()\n\t}).then((response) => {\n    \tif (response.type) {\n    \t\tlet filename = \"\"\n    \t    let disposition = headers.get('Content-Disposition')\n    \t    if (disposition && disposition.indexOf('attachment') !== -1) {\n    \t        let filenameRegex = /filename[^;=\\n]*=((['\"]).*?\\2|[^;\\n]*)/\n    \t        let matches = filenameRegex.exec(disposition)\n    \t        if (matches != null && matches[1]) { \n    \t          filename = matches[1].replace(/['\"]/g, '')\n    \t        }\n    \t    }\n\t    \tlet link=document.createElement('a');\n\t        link.href=window.URL.createObjectURL(response)\n\t        link.download= filename\n\t        link.click()\n    \t}  \t\n    \txhr.get(config.webservices.bridal.confirmation,{type:\"text\"}).then(\n    \t\tresponse => {\n\t\t\tbridalContainer.innerHTML = response\n\t\t\tlet bridalConTitle = select('.js-bridal-confirmation-title',bridalContainer)\n\t\t\tif (bridalConTitle) {\n\t\t\t\tfocusElement(bridalConTitle)\n\t\t\t}\n\t\t\tbind(bridalContainer,'.js-bridal-confirmation', 'click', onBridalConfirmRedirect)\n\t\t\tif (form.serialize().optInNewsletter) {\n\t\t\t\t dataLayer.push({ \n\t\t\t\t     'eventCategory': 'preferences',\n\t\t\t\t     'eventAction': 'subscribe', \n\t\t\t\t     'eventLabel': 'jewelry_watches',\n\t\t\t\t     'event': 'uaevent'\n\t\t\t\t }); \n\t    \t} \n\t\t}).catch((data) => {\n\t    \t console.log(\"An error occured while bridal template loading\")\n\t    })\n    \tbridalscrollTop()\n    }).catch((data) => {\n    \t console.log(\"An error occured while Bridal form submission\")\n    })\n}\n\nfunction onBridalConfirmRedirect(e) {\n\te.preventDefault()\n\t dataLayer.push({ \n\t     'eventCategory': 'bridal_catalog',\n\t     'eventAction': 'click', \n\t     'eventLabel': 'fine_jewelry_cta', \n\t     'event': 'uaevent'\n\t  }); \n\tlet url = e.target.getAttribute('href')\n\twindow.open(url, '_self')\n}\n\nfunction bridalscrollTop() {\n  document.body.scrollTop = 0\n  document.documentElement.scrollTop = 0\n}\n\n\nexport default function (el) {\n  return new bridal(el)\n}"],"sourceRoot":""}