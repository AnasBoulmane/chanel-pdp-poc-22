(window.webpackJsonp=window.webpackJsonp||[]).push([[15],{1079:function(e,t,n){"use strict";n.r(t);n(7),n(149),n(15),n(37);var a=n(0),c=n(2),s=n(1),i=n(6),o=n(5),r=n(34),l=n(4),d=n.n(l),b=n(13),u=n(31),g=n(161),p=n(214),f=n(564),m=n.n(f);const h=Object(a.select)(".js-giftcard"),j=Object(a.select)(".js-giftcard-header"),v=Object(a.select)(".js-giftcard-phys-header"),w=Object(a.select)(".js-giftcard-elec-header"),L=Object(a.select)(".js-card-type-section",h),O=Object(a.select)(".js-step-container",h),y=Object(a.select)(".js-giftcard-amount-section",h),A=Object(a.select)(".js-message-section",h),C=Object(a.select)(".js-beneficiary-section",h),k=Object(a.selectAll)(".js-card-selector",h),E=Object(a.selectAll)(".js-card-title",h),x=Object(a.select)(".js-mobile-phys-desc",h),_=Object(a.select)(".js-mobile-elec-desc",h),N=Object(a.select)(".js-cards-button",h),T=Object(a.select)(".js-giftcard-form",h),M=Object(a.select)(".js-valid-message",h),S=Object(a.selectAll)(".js-mail-selection",h),I=Object(a.select)(".js-valid-email",h),D=Object(a.select)(".js-giftcard-email-form",h),P=Object(a.selectAll)(".js-card-amount",h),q=Object(a.select)(".js-custom-amount",h),H=Object(a.select)(".js-valid-amount",h),B=Object(a.selectAll)(".js-change-card",h),R=Object(a.select)(".currency-symbol"),F=Object(a.select)(".header .cart"),G=Object(a.select)(".js-giftcard-stepper",h),K=Object(a.select)(".js-textarea",h),J=Object(a.select)(".js-giftcard-lines",h),V=Object(a.select)(".js-giftcard-chars",h),U=Object(a.select)(".js-giftcard-message-counter",h),Y=Object(a.select)(".js-giftcad-message-label",h),z=Object(a.selectAll)("li",G),W=window.config.currentLanguage.split("_")[0];let Q=null,X=null,Z=!1,$=1,ee="";const te=window.config.giftcardMinAmount,ne=window.config.giftcardMaxAmount,ae=window.config.locales.errors.form.global.giftcard.maxAmount,ce=window.config.locales.errors.form.global.giftcard.minAmount,se=window.config.giftcardBalancePopin;let ie,oe,re,le,de=window.config.isStandardProductPresent,be=(window.config.isOABServiceProductPresent,z?z[2]:null),ue=Object(a.select)(".giftcard-visible-submit > div label"),ge=Object(a.select)(".giftcard-visible-submit .js-label-input"),pe=0;function fe(){(function(){function e(){xe(),k.forEach(e=>{n(e,e===this)})}function t(e){if(13===e.keyCode||32===e.keyCode){const e=new MouseEvent("click");this.dispatchEvent(e)}}function n(e,t){Ye(y),V.innerHTML=window.config.giftcardMessageMaxChars*window.config.giftcardMessageMaxLines,J.innerHTML=window.config.giftcardMessageMaxLines,Z=!1,e.classList.toggle("selected",t);const n=Object(a.select)("input[type=radio]",e);n.checked=t,t&&Q!==n.value&&(Q=n.value,T.reset(),K.value="",window.localStorage.setItem("giftcard-message",""),K.parentNode.classList.remove("has-content"),K.style.height="29px",D.reset(),S.forEach((e,t)=>{const n=Object(a.select)(".js-show-email",e),c=Object(a.select)("input",n);e.classList.toggle("is-selected",0===t),n.classList.toggle("is-hidden",0!==t),c.required=0===t,c.checked=0===t}),P.forEach(e=>{e.classList.toggle("is-primary",!1),e.classList.toggle("is-quaternary",!0),e.setAttribute("aria-pressed",!1),q.value=""}),Object(a.selectAll)(".has-content",O).forEach(e=>{e.classList.toggle("has-content",!1)}),1!=$&&Ge(),"physical"===n.value?(x&&x.classList.toggle("is-hidden",!1),v&&v.classList.toggle("is-hidden",!1),_&&_.classList.toggle("is-hidden",!0),w&&w.classList.toggle("is-hidden",!0),Y.setAttribute("data-test","lblAddACustomMessage_GiftCard"),_e(!0)):(_&&_.classList.toggle("is-hidden",!1),w&&w.classList.toggle("is-hidden",!1),x&&x.classList.toggle("is-hidden",!0),v&&v.classList.toggle("is-hidden",!0),Y.setAttribute("data-test","lblAddACustomMessage_TheE-GiftCard"),_e(!1)),We("physical"===n.value,"select"))}TweenLite.set(document.body,{delay:1,onComplete:()=>{K.value="",window.localStorage.setItem("giftcard-message",""),K.parentNode.classList.remove("has-content"),K.style.height="29px"}}),Object(c.Y)()||(E.forEach(e=>{e.setAttribute("aria-hidden","true")}),O.setAttribute("hidden","")),k.forEach((s,i)=>{0===i&&n(s,!0),s.addEventListener("click",e),s.addEventListener("keydown",t),Object(c.Y)()||Object(a.select)("h2",s).setAttribute("aria-hidden",!0)})})(),K.addEventListener("input",ze),window.addEventListener("unload",()=>{const e=Object(a.select)(".radio-big[value=physical]",Object(a.select)(".js-main-content"));e&&(e.checked=!0)},!1),d()(document.body,".js-balance-submit-cta","click",Ae),P.forEach(e=>{e.addEventListener("click",()=>{Z=!0,Te(e)})}),q.addEventListener("input",()=>{Z=!1,Te()}),M.addEventListener("click",Ie),N.addEventListener("click",Se),B.forEach(e=>{e.addEventListener("click",Ge)}),H.addEventListener("click",Ke),S.forEach(e=>{Object(a.select)("[type=radio]",e).addEventListener("change",Fe)}),I.addEventListener("click",Re),Object(a.selectAll)("button",G).forEach((e,t)=>{e.addEventListener("click",()=>{xe(),function(e){switch(e){case 1:e<$&&(j.classList.toggle("is-hidden-mobile",!0),L.classList.toggle("is-hidden-mobile",!0),O.classList.toggle("is-hidden-mobile",!1),N.setAttribute("hidden",""),A.setAttribute("hidden",""),C.setAttribute("hidden",""),y.classList.toggle("is-hidden",!1),y.removeAttribute("hidden"),Ne(1),Me(1));break;case 2:e<$&&Ke()}}(t+1)})});const e=Object(a.select)(".js-balance-information-phone");if(e)if(-1!==e.getAttribute("href").indexOf("tel:")){const t=e.cloneNode(!0);t.removeAttribute("hidden"),ee=t.outerHTML}else{const t=Object(a.select)("span",e);ee=t.innerText}const t=Object(a.select)(".js-open-balance-cta");t&&t.addEventListener("click",()=>{we()}),d()(document.body,".js-open-other-balance-cta","click",()=>{window.document.DLKit.push("on-giftcard-check-other-card-number",{eventCategory:"card balance",eventAction:"check another",eventLabel:"",event:"uaevent"}),i.a.hide(),s.C.subscribe(s.B,we)}),s.C.subscribe(s.i,Ce)}const me=()=>{let e=Object(a.select)(".calendar-container");le=Object(a.select)(".js-select-date-input"),re=m()(".giftcard-visible-submit",{dateFormat:"JP"===window.config.country?"Y/m/d":"d/m/Y",minDate:"today",clickOpens:!1,allowInput:!0,disableMobile:!0,appendTo:e,wrap:!0,locale:{firstDayOfWeek:1},disable:[function(e){return!0}],onOpen:()=>{e&&(e.removeAttribute("hidden"),le.removeAttribute("style"),le.focus(),Object(c.R)()&&"JP"!==config.country&&0==pe&&(le.setSelectionRange(2,2),pe++))},onClose:()=>{e&&(e.setAttribute("hidden",""),Object(c.R)()&&document.activeElement!=le&&(pe=0))},onReady:()=>{let e=Object(a.select)(".flatpickr-current-month > div input");e.maxLength=4,e.addEventListener("click",e=>{he()}),o.get(window.config.webservices.eGCGiftCardAvailableDates).then(e=>{!function(e){if(e.errors&&e.errors.error&&"apac"!==config.region)return void u.a.show({name:window.config.locales.notifier.request.label,message:window.config.locales.notifier.request.message,close:window.config.locales.notifier.request.close});e&&e.availableDates.length>0&&(re.set("minDate",new Date(e.availableDates[0])),re.set("enable",e.availableDates.map(e=>new Date(e))),re.set("onValueUpdate",(e,t,n)=>{n.isOpen&&(le.value=t)}));ge.classList.add("has-content"),le.value=function(e){const t=new Date(e),n="0".concat(t.getMonth()+1).slice(-2),a="0".concat(t.getDate()).slice(-2),c=t.getFullYear();"JP"===window.config.country?"".concat(c,"/").concat(n,"/").concat(a):"".concat(a,"/").concat(n,"/").concat(c);return"JP"===window.config.country?"".concat(c,"/").concat(n,"/").concat(a):"".concat(a,"/").concat(n,"/").concat(c)}(e.availableDates[0]),ve(le,ue),Be()}(e)})},onMonthChange:()=>{Be()}});const t=le.cloneNode(!0);le.parentNode.replaceChild(t,le),le=Object(a.select)(".js-select-date-input"),le.addEventListener("input",e=>{je(le,e)}),le.addEventListener("click",e=>{Object(c.R)()&&"JP"!==config.country&&0==(void 0).isAtDateLinePosition&&((void 0).inputField.setSelectionRange(2,2),pe++),le.removeAttribute("style")})},he=e=>{const t=e.value.replace(/[^0-9]/g,"");e.value=t},je=(e,t)=>{const n=e.selectionStart;let a=n;e.classList.toggle("is-filled",e.value.length>0);const c=/^[0-9/]/,s=e.value.split().map(t=>(c.test(e.value[n-1])?(ge.classList.add("has-content"),ve(e,ue)):(a=n-1,ve(e,ue)),t.replace(/[^0-9\/]/g,"")));e.value=s.join(""),e.focus(),-1===a&&a++,e.setSelectionRange(a,a)};function ve(e,t){(e.value.length>0?1:0)>0?t.classList.remove("no-pointer"):t.classList.add("no-pointer")}const we=()=>{let e;e="gb"==config.country.toLowerCase()?se.numbersHelpDescriptionUk:se.numbersHelpDescription;const t='<div class="popin-text text-center balance-popin-content" data-close-label="'.concat(se.closeBtn,'">\n                              <h1 class="js-balance-popin-title balance-popin-title text-center">').concat(se.title,'</h1>\n                              <p class="js-balance-popin-description balance-popin-description">').concat(se.description,'</p>\n                              <form novalidate method="post" class="js-verify-balance-form" id="verify-balance-form">\n                                <div class="balance-form">\n                                    <div class="field card-number-field">\n                                        <div class="label-input js-label-input is-ready">\n                                            <label class="label-input__label" for="balance-card-number">').concat(se.formCardNumberLabel,'</label>\n                                            <input class="label-input__input js-balance-card-number js-verify-balance-input" type="number" aria-required="true" id="balance-card-number" data-error-message="emptyCardNumber">\n                                        </div>\n                                    </div>\n                                    <div class="field pin-field">\n                                        <div class="label-input js-label-input is-ready">\n                                            <label class="label-input__label" for="balance-pin">').concat(se.formCardPinLabel,'</label>\n                                            <input class="label-input__input js-balance-pin js-verify-balance-input" type="number"  aria-required="true" id="balance-pin" data-error-message="emptyCardPin">\n                                        </div>\n                                    </div>\n                                    <div class="balance-number-container">\n                                        <button type="button" class="js-balance-numbers-help-cta balance-numbers-help-cta link is-underline"><span>').concat(se.formNumbersHelp,'</span></button>\n                                        <div class="js-balance-numbers-help-container balance-numbers-help-container is-hidden">\n                                            <button class="button is-icon js-balance-help-conainer-close balance-help-conainer-close" type="button">\n                                                <svg class="icon is-small is-next" focusable="false" viewBox="0 0 1 1" aria-hidden="true">\n                                                    <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="').concat(window.config.paths.icons,"icons.svg").concat(window.config.targetVersion,'#close"></use>\n                                                </svg>\n                                                <span class="is-sr-only">').concat(se.numbersHelpCloseCta,'</span>\n                                            </button>\n                                            <p class="balance-numbers-help-description">').concat(e,'</p>\n                                            <div class="js-balance-numbers-help-image-container balance-numbers-help-image-container"></div>\n                                        </div>\n                                    </div>\n                                    <div class="g_recaptcha" id="g_recaptcha"></div>\n                                    ').concat(Object(c.R)()?'<p class="balance-information">'.concat(se.formInformations.replace("{1}",ee),"</p>"):"",'\n                                    <div class="balance-submit-container">\n                                      <button type="button" class="button is-primary js-balance-submit-cta balance-submit-cta" aria-label=\'').concat(se.formSubmitCtaAriaLabel,"'>\n                                        <span>\n                                            <span>").concat(se.formSubmitCta,"</span>\n                                        </span>\n                                      </button>\n                                    </div>\n                                </div>\n                              </form>\n                              ").concat(Object(c.R)()?"":'<p class="balance-information">'.concat(se.formInformations.replace("{1}",ee),"</p>"),"\n                         </div>");i.a.open({html:t,modifiers:"balance-popin js-balance-popin",modal:!0,role:"dialog",label:se.title,forceInert:!0,manageFocus:!0,outerClose:!0}).then(e=>{ye(),oe=Object(a.select)(".js-popin-close",e.modal.el),Object(c.n)(oe,{notChangeTabIndex:!0});const t=Object(a.select)(".js-balance-numbers-help-cta",e.modal.el),n=Object(a.select)(".js-balance-numbers-help-container",e.modal.el),s=Object(a.select)(".js-balance-help-conainer-close",e.modal.el),o=Object(a.select)(".js-balance-numbers-help-image-container",e.modal.el),r=Object(a.select)(".js-balance-popin .popin__col"),l=Object(a.select)(".js-balance-popin-title");t&&t.addEventListener("click",()=>{o&&(o.innerHTML='<img src="'.concat(window.config.paths.icons,"/media/giftcard_back.png").concat(window.config.targetVersion,'" class="balance-numbers-help-image" alt=""/>')),n&&n.classList.toggle("is-hidden"),t.classList.toggle("is-hidden"),s&&Object(c.n)(s,{notChangeTabIndex:!0}),Object(c.R)()&&l.getBoundingClientRect().top<45&&(r.classList.add("balance-popin-ios"),oe.classList.add("balance-popin-close-ios")),Le()}),s&&s.addEventListener("click",()=>{r.classList.remove("balance-popin-ios"),oe.classList.remove("balance-popin-close-ios"),o&&(o.innerHTML=""),n&&n.classList.toggle("is-hidden"),t&&t.classList.toggle("is-hidden"),t&&Object(c.n)(t)}),e.modal.el.addEventListener("click",e=>{Object(a.closest)(e.target,".popin__row")||i.a.hide()})}),window.document.DLKit.push("on-giftcard-balance",{eventCategory:"card balance",eventAction:"open pop in",eventLabel:"",event:"uaevent"}),s.C.unsubscribe(s.B)},Le=()=>{window.document.DLKit.push("on-giftcard-find-number",{eventCategory:"card balance",eventAction:"find numbers",eventLabel:""})},Oe=()=>{TweenLite.set(document.body,{delay:.6,onComplete:()=>{const e=Object(a.select)(".js-balance-popin"),t=Object(a.select)("iframe[title='recaptcha challenge']");if(e&&t&&Object(c.R)()){const n=t.parentNode.parentNode;document.body.insertBefore(e,n)}}})},ye=()=>{const e=window.config.currentLanguage.substring(0,2),t=document.createElement("script");t.setAttribute("src",window.config.recaptchaCdn.replace("{0}",e)),t.setAttribute("async",!0),t.setAttribute("defer",!0);const n=Object(a.select)(".js-balance-popin");n&&document.body.insertBefore(t,n),window.onloadCallback=()=>{grecaptcha.render("g_recaptcha",{sitekey:window.config.gReCaptchaKey});const e=Object(a.select)("#g-recaptcha-response");e&&e.setAttribute("required","")},Oe()},Ae=e=>{e.preventDefault();const t=Object(a.select)(".js-verify-balance-form");t&&(Ye(t),Ue(t));const n=Object(a.select)(".js-balance-submit-cta");n&&(ke(n,!0),n.classList.add("is-disabled"));const s=Object(a.select)(".js-balance-pin"),i=Object(a.select)(".js-balance-card-number"),r=Object(a.getCollection)(".js-verify-balance-input").filter(e=>""===e.value);0===r.length&&0!==grecaptcha.getResponse().length?s&&i&&o.post(window.config.webservices.giftCardBalance,{data:{gcNumber:i.value,gcCVC:s.value}}).then(e=>{const t=()=>{const t=Object(a.select)(".balance-information");Object(a.getCollection)("p.js-balance-popin-description, .js-verify-balance-form").forEach(e=>{e.parentNode.removeChild(e)});const n=Object(a.select)(".js-balance-popin");n&&n.setAttribute("aria-label",se.balanceSecondPopinAriaLabel);const s=Object(a.select)(".js-balance-popin-title");let i;s&&(s.innerText=se.secondPopinTitle,s.classList.add("second-popin-title")),i="gb"==config.country.toLowerCase()?"".concat(window.config.gifcardCurrency).concat(e.amount):"nl"==config.country.toLowerCase()?"".concat(window.config.gifcardCurrency,"&nbsp;").concat(e.amount):"".concat(e.amount).concat(window.config.gifcardCurrency);const o=document.createElement("p");o.classList.add("amount-section"),o.innerHTML='<span class="balance-amount">'.concat(i,' </span><br><span class="balance-validity">').concat(se.balanceValidity," ").concat(e.expiryDate,"</span>"),s.parentNode.insertBefore(o,s.nextSibling);const r=document.createElement("button");r.setAttribute("class","link has-icon is-cta js-open-other-balance-cta open-other-balance-cta"),r.setAttribute("type","button"),r.innerHTML="<span><span>".concat(se.otherCardCta,"</span></span>"),Object(c.n)(oe,{notChangeTabIndex:!0}),Object(c.R)()?(s.parentNode.insertBefore(t,s.lastElementChild),s.parentNode.insertBefore(r,s.lastElementChild)):t.parentNode.insertBefore(r,t)};if(e.amount&&(()=>{if(Object(a.select)(".g_recaptcha")&&Object(a.select)(".g_recaptcha").hasChildNodes())return!0})()&&grecaptcha){if(0===grecaptcha.getResponse().length)return Ee(),void(n&&n.classList.remove("is-disabled"));t()}else null===e.error?t():(grecaptcha.reset(),Oe(),e.error&&"41"===e.error.errorCode?(De(s.parentNode,window.config.locales.errors.form.global.giftcard.wrongCardPin,"wrongCardPin"),s.setAttribute("aria-describedby","wrongCardPin"),s.setAttribute("aria-invalid","true"),Object(c.n)(s,{notChangeTabIndex:!0})):e.error&&"2"===e.error.errorCode?(De(i.parentNode,window.config.locales.errors.form.global.giftcard.wrongCardNumber,"wrongCardNumberError"),i.setAttribute("aria-describedby","wrongCardNumberError"),i.setAttribute("aria-invalid","true"),De(s.parentNode,window.config.locales.errors.form.global.giftcard.wrongCardPin,"wrongCardPin"),s.setAttribute("aria-describedby","wrongCardPin"),s.setAttribute("aria-invalid","true"),Object(c.n)(i,{notChangeTabIndex:!0})):u.a.show({name:window.config.locales.notifier.request.label,message:window.config.locales.notifier.request.message,close:window.config.locales.notifier.request.close}));Ee(),n&&n.classList.remove("is-disabled")}).catch(()=>{Ee(),n&&n.classList.remove("is-disabled"),u.a.show({name:window.config.locales.notifier.request.label,message:window.config.locales.notifier.request.message,close:window.config.locales.notifier.request.close})}):(r.forEach(e=>{De(e.parentNode,window.config.locales.errors.form.global.giftcard[e.getAttribute("data-error-message")],e.getAttribute("data-error-message"),n),e.setAttribute("aria-describedby",e.getAttribute("data-error-message")),e.setAttribute("aria-invalid","true")}),Object(c.n)(r[0],{notChangeTabIndex:!0}),Ee(),n&&n.classList.remove("is-disabled")),window.document.DLKit.push("on-giftcard-check-balance",{eventCategory:"card balance",eventAction:"check",eventLabel:"",event:"uaevent"})};function Ce(){1!==$||L.classList.contains("is-hidden-mobile")||(Object(c.Y)()?O.removeAttribute("hidden"):O.setAttribute("hidden",""))}const ke=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;ie=new b.a(e,{referenceEl:e,delay:n,button:t}),ie.init(),ie.create(a)},Ee=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;ie&&ie.destroy(e)},xe=()=>{[y,D,y,T].forEach(e=>{Ye(e)})};function _e(e){e?(G.classList.toggle("is-binary",!0),z[2].remove()):(G.classList.toggle("is-binary",!1),be&&G.appendChild(be))}function Ne(e){$=e,--e;Object(a.selectAll)("li",G).forEach((t,n)=>{const c=Object(a.select)(".step",t),s=Object(a.select)(".is-sr-only",t);n===e?(c.className="step active-step",s.innerHTML=window.config.locales.giftcard.activeStep,c.parentNode.disabled=!0):n===e-1?(c.className="step previous-active-step",s.innerHTML=window.config.locales.giftcard.previousStep,c.parentNode.disabled=!1):n>e?(c.className="step future-step",s.innerHTML=window.config.locales.giftcard.nextStep,c.parentNode.disabled=!0):(c.className="step",s.innerHTML=window.config.locales.giftcard.previousStep,c.parentNode.disabled=!1)})}function Te(e){X=null,P.forEach(t=>{t===e?(X=e,X.setAttribute("aria-pressed",!0),t.classList.toggle("is-primary",!0),t.classList.toggle("is-quaternary",!1),q.value="",q.closest(".label-input").classList.toggle("has-content",!1)):t!==q&&(t.classList.toggle("is-primary",!1),t.classList.toggle("is-quaternary",!0),t.setAttribute("aria-pressed",!1))}),Ye(y)}function Me(e){switch(e){case 1:case 2:case 3:document.title="".concat(window.config.locales.giftcard.title," ").concat(window.config.locales.giftcard.step," ").concat(e," ").concat(window.config.locales.giftcard.extra);break;default:document.title="".concat(window.config.locales.giftcard.title," ").concat(window.config.locales.giftcard.extra)}}function Se(){O.classList.toggle("is-hidden-mobile",!1),O.removeAttribute("hidden"),N.classList.toggle("is-hidden",!1),N.removeAttribute("hidden"),L.classList.toggle("is-hidden-mobile",!0),j.classList.toggle("is-hidden-mobile",!0),document.body.scrollTop=0;const e=Object(a.select)("h3",O);e.setAttribute("tabindex","-1"),e.focus(),Ne(1),Me(1)}function Ie(e){e.preventDefault(),Ye(T);const t=Object(a.getCollection)("input[data-required=true]",A).filter(e=>""===e.value);if(0===t.length)if("electronic"===Q){if(!0===T.checkValidity()){let e;window.sessionStorage.setItem("selectedSpanAriaLabel",""),A.classList.toggle("is-hidden",!0),A.setAttribute("hidden",""),j.classList.toggle("is-hidden-mobile",!0),O.classList.toggle("is-hidden-mobile",!1),L.classList.toggle("is-hidden-mobile",!0),C.classList.toggle("is-hidden",!1),C.removeAttribute("hidden"),y.classList.toggle("is-hidden",!0),y.setAttribute("hidden",""),e=Object(a.select)("h3",C),e.setAttribute("tabindex","-1"),We(!0,"add_custom_message","next_step"),Ne(3),e.focus();const t=Object(a.selectAll)("input[name=future-selection]");let c=Object(a.select)(".giftcard-visible-submit");t.forEach(e=>{e.addEventListener("change",He),"send-later"===e.id&&!0===e.checked?c.removeAttribute("hidden"):c.setAttribute("hidden","")}),"vi"===window.config.currentLanguage.split("_")[0]?n(513)("./".concat(config.currentLanguage.toLowerCase().split("_")[1],".js")).then(()=>{m.a.localize(m.a.l10ns[config.currentLanguage.toLowerCase().split("_")[1]]),me(),console.log("".concat(config.currentLanguage.split("_")[0]," calendar translations loaded"))}).catch(e=>{console.log(e)}):"en"!==window.config.currentLanguage.split("_")[0]?n(513)("./".concat(config.currentLanguage.split("_")[0],".js")).then(()=>{m.a.localize(m.a.l10ns[W]),me(),console.log("".concat(config.currentLanguage.split("_")[0]," calendar translations loaded"))}).catch(e=>{console.log(e)}):me();const s=Object(a.select)(".js-egiftcard-sender"),i=Object(a.select)(".js-egiftcard-receiver"),o=Object(a.select)("#giftcard-sender"),r=Object(a.select)("#giftcard-receiver"),l=Object(a.select)(".js-giftcard-form-message"),d=Object(a.select)(".js-textarea");s&&o&&(s.value=o.value),i&&r&&(i.value=r.value),l&&d&&(l.value=d.value)}}else!0===T.checkValidity()&&Pe(T,"giftCard");else{const e={giftCardSender:window.config.locales.errors.form.global.giftcard.emptySenderInput,giftCardReceiver:window.config.locales.errors.form.global.giftcard.emptyReceiverInput};t.forEach(t=>{De(t.parentNode,e[t.getAttribute("name")])}),Object(c.n)(t[0],{notChangeTabIndex:!0})}}const De=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;const c=document.createElement("p"),s=document.createTextNode(t);e.classList.add("has-error"),n&&a&&a.setAttribute("aria-describedby",n),c.classList.add("error"),c.setAttribute("id",n),c.dataset.errorMessage="true",c.appendChild(s);const i=e.parentNode;return i.appendChild(c),c},Pe=(e,t)=>{let n="giftCard"===t?giftCardProductData:eGiftCardProductData,s="eGiftCard"===t?Object(a.select)(".js-egiftcard-code"):Object(a.select)(".js-giftCard-code");const r=Object(a.select)(".js-giftcard-form-price",e);let l={eventLabel:n.product_name,eventAction:"regular quickbuy",eventCategory:"add to cart",event:"uaevent",ecommerce:{currencyCode:window.config.currentCurrency,add:{products:[{name:n.product_name,id:n.id,brand:n.brand,category:n.category,variant:n.variant,quantity:1,dimension18:n.collection,dimension19:n.sub_collection,dimension20:n.product_line,dimension21:n.outOfStockStatus,dimension22:n.fsh_modelcode,dimension23:n.fsh_articlecode,dimension25:n.product_axis,dimension26:n.fsh_sku_luxotica,dimension45:""}]}}};r&&(l.ecommerce.add.products[0].price=r.value),s&&(l.ecommerce.add.products[0].dimension8=s.value),window.document.DLKit.push("on-giftcard-add-to-bag",l,!1),"giftCard"===t?o.post(window.config.webservices.checkAddToBag).then(t=>{t.isWFJCnCPossible;let s=t.isWFJHDPossible,o=t.isNonWFJPossible,r=t.isOABServiceProductPresent;if(o&&!r)qe(e);else{let t=n.product_name,o=s?"wfj.fnb":"cnc.hd";function l(e){"Escape"!==e.key&&"Esc"!==e.key&&27!==e.keyCode||(window.removeEventListener("keydown",l),i.a.hide())}Object(p.a)(o).then(n=>{window.document.DLKit.push("on-tracking",{eventCategory:"click and collect",eventAction:"mixed_cart_display",eventLabel:t,event:"nievent"});const s=Object(a.select)(".js-popin-close",n.modal.el);s&&Object(c.n)(s,{notChangeTabIndex:!0}),s.addEventListener("click",()=>{window.document.DLKit.push("on-tracking",{eventCategory:"click and collect",eventAction:"mixed_cart_close",eventLabel:t,event:"uaevent"})}),n.modal.el.addEventListener("click",e=>{Object(a.closest)(e.target,".popin__row")||i.a.hide()}),window.addEventListener("keydown",l);const o=Object(a.select)(".js-mixed-cart-confirmation-cancel-cta");o&&o.addEventListener("click",()=>{window.document.DLKit.push("on-tracking",{eventCategory:"click and collect",eventAction:"mixed_cart_cancel",eventLabel:t,event:"uaevent"}),i.a.hide()});const r=Object(a.select)(".js-mixed-cart-confirmation-popin-cta");r&&r.addEventListener("click",()=>{window.document.DLKit.push("on-tracking",{eventCategory:"click and collect",eventAction:"mixed_cart_continue",eventLabel:t,event:"uaevent"}),qe(e),i.a.hide()})})}}):qe(e)};function qe(e){o.submit(e).then(()=>{r.a.open(window.config.popups["mini-cart"],e.querySelector('[type="submit"]'),()=>{const e=Object(a.select)(".js-cartItem-giftCard",r.a.currentModal.el);if(e){const t=Object(a.select)("a[href]",e);t&&(t.setAttribute("href",window.location.pathname),t.setAttribute("data-test","lnkGiftCard"));const n=Object(a.select)(".js-cart-price-item",e);n&&n.setAttribute("data-test","lblAmount")}}),F&&(F.classList.remove("has-product"),F.offsetHeight,F.classList.add("has-product"))}).catch(e=>{if(e.gcFormError){D&&Ye(D);const t=document.createElement("p");t.classList.add("error","giftcard-unit-error"),t.setAttribute("id","giftcard-unit-error");const n=Object(a.select)(".js-valid-message"),s=Object(a.select)(".js-valid-email");n&&n.setAttribute("aria-describedby","giftcard-unit-error"),s&&s.setAttribute("aria-describedby","giftcard-unit-error"),t.innerHTML=e.gcFormError,M.insertAdjacentHTML("afterend",t.outerHTML),I.parentNode.insertBefore(t,I.nextSibling),Object(c.n)(t)}else u.a.show({name:window.config.locales.notifier.request.label,message:window.config.locales.notifier.request.message,close:window.config.locales.notifier.request.close})})}function He(e){let t=Object(a.select)(".giftcard-visible-submit");t&&("send-now"==e.target.getAttribute("id")?t.setAttribute("hidden",""):t.removeAttribute("hidden"))}function Be(){let e=Object(a.select)("span.flatpickr-day.selected"),t=Object(a.select)("span.flatpickr-day:not(.disabled)");e&&window.sessionStorage.setItem("selectedSpanAriaLabel",e.ariaLabel),Object(a.selectAll)("span.flatpickr-day").forEach(t=>{t.ariaLabel===window.sessionStorage.getItem("selectedSpanAriaLabel")&&(t.classList.add("selected"),e=t)}),null==e&&""===window.sessionStorage.getItem("selectedSpanAriaLabel")&&null!==t&&(t.classList.add("selected"),window.sessionStorage.setItem("selectedSpanAriaLabel",t.ariaLabel))}function Re(e){e.preventDefault(),Ye(D);const t=Object(a.select)("#gc-myemail",D);t&&""===t.value?(De(t.parentNode,window.config.locales.errors.form.global.giftcard.emptyMailInput),Object(c.n)(t,{notChangeTabIndex:!0})):D.checkValidity()?o.post(window.config.webservices.checkForGiftCard,{data:{isEGiftCard:!0}}).then(e=>{if(!0===e.isStandardProductPresent||!0===e.isOABServiceProductPresent){const t=e.isOABServiceProductPresent?"oab-giftcard-content":"content";Object(g.a)(t).then(e=>{oe=Object(a.select)(".js-popin-close",e.modal.el),Object(c.n)(oe,{notChangeTabIndex:!0}),e.modal.el.addEventListener("click",e=>{Object(a.closest)(e.target,".popin__row")||i.a.hide()});const t=Object(a.select)(".js-confirmation-cancel-cta");t&&t.addEventListener("click",()=>{i.a.hide()});const n=Object(a.select)(".js-confirmation-popin-cta");n&&n.addEventListener("click",()=>{Pe(D,"eGiftCard"),de="false",i.a.hide()})})}else Pe(D,"eGiftCard")}):Object(c.n)(t,{notChangeTabIndex:!0})}function Fe(){S.forEach(e=>{const t=Object(a.select)(".js-show-email",e),n=Object(a.select)("input",t);e===this.parentNode?(e.classList.toggle("is-selected",!0),t.classList.toggle("is-hidden",!1),n.required=!0):(e.classList.toggle("is-selected",!1),t.classList.toggle("is-hidden",!0),n.required=!1,n.value="")}),Ye(D)}function Ge(){j.classList.toggle("is-hidden-mobile",!1),L.classList.toggle("is-hidden-mobile",!1),O.classList.toggle("is-hidden-mobile",!0),N.classList.toggle("is-hidden",!1),N.removeAttribute("hidden"),y.classList.toggle("is-hidden",!1),y.removeAttribute("hidden"),C.classList.toggle("is-hidden",!0),C.setAttribute("hidden",""),A.classList.toggle("is-hidden",!0),A.setAttribute("hidden",""),Ne(1),Me(1);const e=Object(a.select)(".radio-big:checked",Object(a.select)(".js-main-content"));e.scrollIntoView(),e.focus(),Ye(y),Ye(D)}function Ke(e){if(Ye(y),P.forEach(e=>{e.removeAttribute("aria-describedby")}),q.setAttribute("aria-describedby","currency-symbol"),e&&e.preventDefault(),K.value=window.localStorage.getItem("giftcard-message"),K.value.length>0&&K.parentNode.classList.add("has-content"),!0===Z||""!==q.value&&parseInt(q.value)>=te&&parseInt(q.value)<=ne){A.classList.toggle("is-hidden",!1),A.removeAttribute("hidden");Object(a.select)(".button__wrapper span",M).innerHTML="physical"===Q?window.config.locales.giftcard.addToBag:window.config.locales.giftcard.nextStep,y.setAttribute("hidden",""),y.classList.toggle("is-hidden",!0),C.setAttribute("hidden",""),C.classList.toggle("is-hidden",!0);const e=Object(a.select)(".js-card-amount[aria-pressed=true] .js-card-amount-number"),t=Object(a.select)(".js-giftcard-form-price",T);t&&(t.value=e?e.innerText.replace(/\s/g,""):q.value);const n=Object(a.select)(".js-giftcard-form-price",D);n&&(n.value=e?e.innerText.replace(/\s/g,""):q.value),Ne(2);const c=Object(a.select)("h3",A);if(c&&(c.setAttribute("tabindex","-1"),c.focus()),X){const e="".concat(X.children[0].textContent.trim(),"_").concat(R.textContent.toUpperCase());We("physical"===Q,e,"next_step")}else We("physical"===Q,"".concat(q.value,"_").concat(R.textContent.toUpperCase()),"next_step")}else if(!1===Z&&""===q.value){const e=De(q.parentNode,window.config.locales.errors.form.global.giftcard.base);P.forEach(t=>{Ve(e,t,"error-amount-value")}),Ve(e,q,"error-amount-value"),q.focus()}else!1===Z&&parseInt(q.value)<te?("gb"===window.config.country.toLocaleLowerCase()?Ve(Je(q.parentNode,"".concat(ce," ").concat(window.config.gifcardCurrency).concat(parseInt(te).toFixed(0))),q,"error-min-amount-value"):Ve(Je(q.parentNode,"".concat(ce," ").concat(parseInt(te).toFixed(0))),q,"error-min-amount-value"),q.focus()):!1===Z&&parseInt(q.value)>ne&&("gb"===window.config.country.toLocaleLowerCase()?Ve(Je(q.parentNode,"".concat(ae," ").concat(window.config.gifcardCurrency).concat(parseInt(ne).toFixed(0))),q,"error-max-amount-value"):Ve(Je(q.parentNode,"".concat(ae," ").concat(parseInt(ne).toFixed(0))),q,"error-max-amount-value"),q.focus())}function Je(e,t){const n=document.createElement("p"),a=document.createTextNode(t);n.classList.add("error","has-error"),n.dataset.errorMessage="true",n.appendChild(a),n.setAttribute("data-test","lblGlobalErrorMessageOrEnterAnAmount_TheGiftCard");return e.parentNode.appendChild(n),e.focus(),n}function Ve(e,t,n){e.id=n;const a=t.getAttribute("aria-describedby");a&&(n+=" ".concat(a)),t.setAttribute("aria-describedby",n)}const Ue=e=>{Object(a.getCollection)("input[type=number]",e).forEach(e=>{e.removeAttribute("aria-describedby"),e.removeAttribute("aria-invalid")})};function Ye(e){const t=e.querySelectorAll(".invalid-field"),n=e.querySelectorAll(".has-error"),a=e.querySelectorAll(".error");for(let e=0;e<t.length;++e)t[e].classList.remove("invalid-field"),t[e].removeAttribute("tabindex");for(let e=0;e<n.length;++e)n[e].classList.remove("has-error");for(let e=0;e<a.length;++e)a[e].parentNode.removeChild(a[e])}const ze=e=>{V&&(V.innerHTML=window.config.giftcardMessageMaxChars*window.config.giftcardMessageMaxLines-e.target.value.length),J&&(J.innerHTML=window.config.giftcardMessageMaxLines-K.value.split("\n").length),K.value.length-K.value.split("\n").length+1>=190?(U.setAttribute("aria-live","assertive"),U.setAttribute("aria-atomic","false")):(U.removeAttribute("aria-live"),U.removeAttribute("aria-atomic")),window.localStorage.setItem("giftcard-message",e.target.value),e.target.checkValidity()};function We(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";window.document.DLKit.push("on-giftcard-event",{eventCategory:e?"gift_card":"e_gift_card",eventAction:t,eventLabel:n,event:"uaevent"})}t.default=function(e){return new fe(e)}},513:function(e,t,n){var a={"./ar.js":[624,34],"./at.js":[625,35],"./be.js":[626,36],"./bg.js":[627,37],"./bn.js":[628,38],"./cat.js":[629,39],"./cs.js":[630,40],"./cy.js":[631,41],"./da.js":[632,42],"./de.js":[633,43],"./default.js":[634,44],"./eo.js":[635,45],"./es.js":[636,46],"./et.js":[637,47],"./fa.js":[638,48],"./fi.js":[639,49],"./fr.js":[640,50],"./gr.js":[641,51],"./he.js":[642,52],"./hi.js":[643,53],"./hr.js":[644,54],"./hu.js":[645,55],"./id.js":[646,56],"./index.js":[647,57],"./it.js":[648,58],"./ja.js":[649,59],"./km.js":[650,60],"./ko.js":[651,61],"./kz.js":[652,62],"./lt.js":[653,63],"./lv.js":[654,64],"./mk.js":[655,65],"./mn.js":[656,66],"./ms.js":[657,67],"./my.js":[658,68],"./nl.js":[659,69],"./no.js":[660,70],"./pa.js":[661,71],"./pl.js":[662,72],"./pt.js":[663,73],"./ro.js":[664,74],"./ru.js":[665,75],"./si.js":[666,76],"./sk.js":[667,77],"./sl.js":[668,78],"./sq.js":[669,79],"./sr.js":[670,80],"./sv.js":[671,81],"./th.js":[672,82],"./tr.js":[673,83],"./uk.js":[674,84],"./vn.js":[675,85],"./zh.js":[676,86]};function c(e){if(!n.o(a,e))return Promise.resolve().then((function(){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}));var t=a[e],c=t[0];return n.e(t[1]).then((function(){return n.t(c,7)}))}c.keys=function(){return Object.keys(a)},c.id=513,e.exports=c}}]);