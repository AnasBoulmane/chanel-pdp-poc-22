{"version":3,"sources":["webpack:///./node_modules/flatpickr/dist/l10n lazy ^\\.\\/.*\\.js$ namespace object","webpack:///./patterns/scripts/lib/helpers/fit-text.js","webpack:///./patterns/scripts/modules/toshi-module.js","webpack:///./patterns/scripts/pages/account/popinResetPassword.js","webpack:///./patterns/scripts/pages/account/preference-setting.js","webpack:///./patterns/scripts/pages/opc/address-validation.js","webpack:///./patterns/scripts/pages/opc/applePayOPCManager.js","webpack:///./patterns/scripts/pages/opc/change-country.js","webpack:///./patterns/scripts/pages/opc/delivery-method-calender.js","webpack:///./patterns/scripts/pages/opc/hilight-credit-card.js","webpack:///./patterns/scripts/pages/opc/index.js","webpack:///./patterns/scripts/pages/opc/list.js","webpack:///./patterns/scripts/pages/opc/promocode.js","webpack:///./patterns/scripts/pages/opc/threeDS2-popin.js","webpack:///./patterns/scripts/pages/opc/toggle-formaction.js"],"names":["addEvent","el","type","fn","addEventListener","attachEvent","extend","obj","ext","key","hasOwnProperty","window","fitText","kompressor","options","settings","fit","compressor","resizer","style","fontSize","Math","max","min","clientWidth","parseFloat","maxFontSize","minFontSize","length","i","initToshiDetails","toshiCartDataUrl","toshiLibraryUrl","config","webservices","getData","data","deliveryModeCode","getAttribute","xhr","then","showDetails","toshi","global","_babelPolyfill","apiToshi","document","createElement","id","src","onload","body","appendChild","modal","createBookingIntegration","api","url","toshiApiUrl","toshiApiKey","showErrorMessage","setInlineErrorMessage","hideErrorMessage","undefined","setFirstName","cartUserFirstName","setLastName","cartUserLastName","setEmail","cartUserEmail","setPhone","cartUserPhone","setAddress","cartUserAddress","setBrandCheckoutReference","checkoutReference","setProducts","cartEntries","mountModalSeparately","COOKIE_KEY","POPIN_SELECTOR","FORM_SELECTOR","resetPassword","isVisible","followRedirect","userData","handleFromLogin","removeCookie","showPopin","select","handleFromOPC","hiddenEmailEl","getElementById","value","sourceEl","formContainerEl","page","popin","open","label","locales","passwordForcedUpdate","html","fixRevealPassword","innerHTML","role","modifiers","opener","manageFocus","forceInert","closeButton","closeButtonDataTest","checkAPI","json","errorCode","inEmailEl","outEmailEl","handleSubmit","e","handleSuccess","hide","location","redirectURL","forceUpdate","Manager","publish","form","delegateTarget","selectors","invalid","preventDefault","encodePasswords","catch","err","console","error","decodePasswords","promptPasswordMode","readCookie","subscribe","CHECK_API","bind","nodeElement","copyEl","cloneNode","selectAll","forEach","setAttribute","dataset","togglePassword","preferenceSetting","heightOfNewsletterRule","handlePreferenceSetting","newsletterElm","newsletterRulesElm","isChecked","checked","country","pageName","hasAttribute","classList","remove","removeAttribute","add","clientHeight","height","TweenLite","fromTo","autoAlpha","eventCallback","getCollection","elm","gigyaEmailStatusElm","binded","addressIsValid","currentPopin","target","closest","validCallback","display","params","MODULE_SELECTOR","OPC_APPLE_PAY_INPUT_SELECTOR","APPLE_PAY_CTA_SELECTOR","ApplePayOPCManager","Base","constructor","renderExpressCheckoutCtas","event","shippingInfo","JSON","parse","cartdata","checkTermCondEl","termCondErrorMsgEl","labeltermCondition","pElem","errorMsg","createTextNode","opc","customError","termsAndCondition","removeChild","disablePaymentModes","applePayData","cancelCallback","enablePaymentModes","placeOrderCallback","formElm","action","applepay","placeOrder","submit","paymentAuthorizedFailureCallback","response","success","stockStatusFail","href","cart","cartUrl","posStockStatusFail","deliveryOptionAvailableFail","checkout","checkoutUrl","paymentError","startApplePaySession","bindEvents","onApplePayCheckoutButtonClicked","onPageLoad","OPC_STEP_PROCESS","onOPCStepProcess","applePayIsSupported","applePayEl","getApplePayData","billingForm","billingRadioButtonsElm","radioButtonsElm","radioElm","disabled","updateBillingStep","applePayBlockElm","placeOrderBlockElm","initApplePayOPCManager","context","OPCElm","DIALOG_CLOSE_BUTTON_SELECTOR","ChangeCountry","closeModal","focusElement","clickedElm","isWideScreen","links","tabIndexToZero","keyCode","onModalCancelButtonClicked","buttonClose","init","responseData","markets","sortedMarketKeys","Object","keys","sort","key1","key2","val1","toUpperCase","val2","buildTemplate","template","countryChange","closeChangeDeliveryCountry","deliveryCountry","currentlyOnlineBoutique","replace","current","name","changeLocationDescription","changeYourLocation","marketSelectTemplate","cartMessage","createSelectBox","populateMarkets","setNiceSelectTemplate","marketSelection","firstLoad","firstChild","option","innerText","defaultOption","append","marketKey","outerHTML","paths","icons","targetVersion","onOpenPopin","setDomElements","popinEl","buttonValidate","onChangeMarket","productMessage","onValidate","isFallback","selectedMarket","formUrl","outerClose","onEscapeKeyClicked","removeEventListener","initChangeCountry","changeCountry","flatpickrLocale","currentLanguage","split","log","COUNTRY_SELECTED","DATE_CONTAINER","INPUT_FIELD","SUBMIT_BTN","dateSelection","events","dateContainer","flatpickr","localize","l10ns","initializeCalendar","dateControl","startDate","endDate","calendarContainer","inputControl","defaultDate","disable","isMobileScreen","self","push","onInput","onKeydown","date","getDay","CalendarInstance","minDate","maxDate","clickOpens","appendTo","allowInput","wrap","disableMobile","onChange","selectedDates","dateStr","instance","cleanErrors","input","setHours","getTime","onOpen","removeElement","closeBtn","svg","stopPropagation","close","onClose","calendar","checkDateRange","createErrorMessage","dl","deliveryMethod","errors","emptyDate","Date","selectedDate","checkValidDate","unavailableDate","inputValue","map","v","parseInt","match","inValidDate","domElement","message","elem","parent","parentNode","errorMessage","notChangeTabIndex","caretAtTheEnd","element","hasErrorClasses","errorMessages","isOpen","dateInputSelector","isInputCharacter","inputType","startPos","selectionStart","cursorPosition","toggle","regex","values","test","join","setSelectionRange","hilightCreditCard","isValidCardSupport","creditCardInput","submitBtn","inputField","cardIconList","cardSupportErr","cardCVNTootip","amexTooltip","otherTooltip","creditCardInputFourDigit","dataRegex","regexList","filter","reg","cardTypeEl","card","fourDigitRegex","RegExp","highlightIcon","handleErr","undoHighlight","cardName","cardNameId","supportedCard","tooltipBtn","contains","roleMsg","paymentMethod","selected","some","icon","addErr","removeErr","paymentMethodes","notAccepted","handleSubmitOrder","focus","GIGYA_WRAPPER_ID","HIDDEN_CLASSNAME","DISABLED_FIELDS","DISABLED_FIELDS_GMO","GUEST_EMAIL","LOGIN_EMAIL","EMPLOYEE_SAVINGS","SHIPPING_ADDRESS_FORM_SELECTOR","DIALOG_WRONG_ADDRESS_ISCORRECT_BUTTON_SELECTOR","gigyaRegisterForm","ADDRESS_TOWN_MOBILE_SELECTOR","ADDRESS_MOBILE_SELECTOR","EXPERIAN_AUTOCOMPLETE_SELECTOR","PRECISELY_AUTOCOMPLETE_SELECTOR","toLowerCase","countryCodes","gb","ca","dataLayerProductData","deliveryCalendar","isMobile","isSendDataToLoggedInUser","paymentSubmitted","newForm","countryCode","OPC","module","default","steps","step1","querySelector","step2","step3","cart_data","cart_total","cart_wrapping","gift_message","payment_modes_opc","formErrorMapping","guestEmail","loginEmail","enableSubmitBtns","btn","toggleFormAction","popinResetPasswordHandler","popinResetPassword","popinMergeDecisionHandler","popinMergeDecision","currentTrackingStep","isCncDeliveryMode","isCncDeliveryModeSelected","animateStep","step","newStep","newHeight","done","revealNewStep","children","opacity","onComplete","set","clearProps","css","to","zipCodeVariation","updateInputs","bindSelectionItems","List","initGoogleMap","displayError","includes","dataLayer","addressValidation","submitStepForm","fields","formError","MobilePhoneValidation","resultCode","payload","billing","base","CHECK_RESPONSE","enableAllElements","Array","prototype","call","elements","focusInteractiveStep","container","stepForm","heading","POSElementHeading","focusFirstErrorElement","boutiqueName","handleBillingAddressForm","checkbox","show","formFieldset","formToggleDisplay","setUseDeliveryAddressEl","setBillToBusinessAddressEl","setAddressLine2","COUNTRY_SELECT","selectorCountry","dispatchCapAddress","CustomEvent","detail","isOpc","querySelectorAll","field","tagName","addValue","emptyAddressContainer","getOS","removeRequiredAttribute","phoneCCodeEle","countryCodeOpcEle","countryCodesOption","parentElement","code","index","att","createAttribute","setAttributeNode","selectedIndex","handleFinalStep","signature","pspProvider","hasSignature","cardno","expiryMonth","ExpiryYear","securitycode","holdername","tokennumber","apiKey","gmo","Multipayment","disableFieldsBeforeSend","ceil","tokens","callGmoWithLoop","iterator","tokensNumber","count","getToken","expire","tokenObject","token","substr","buttonClick","trim","fieldNameAttribute","enableValidations","cseEncryptedForm","adyen","createEncryptedForm","encryptedToken","encrypt","paymentUrl","cybersource","disabledFields","Boolean","expiryField","card_expiry_date","billingAddress","from","keepDisabled","handleGigyaLogin","args","loginData","loginFrom","origin","account","loginUrl","forcePassword","method","className","insertAdjacentHTML","handleStepResponse","stockSuccess","updateMobileBurgerMenu","disableSamplesBlock","trackPageview","pathname","parts","subTotal","noop","handleGigyaNotifyLogin","notifyLoginUrl","getUpdatedCartProductData","gtmData","currentStep","dynamicDlCheckoutYapi","pushUpdatedCartData","ecommerce","actionField","products","TRACKING_HIT","ecom","pageLoad","val","addToJson","isFormValid","checkValidity","gEmailElm","lEmailElm","cardNumberErr","selectedPosEle","selectedPosId","giftCardEl","giftCardNumberEl","giftCardCvnEl","selectedInput","billingCheckboxEU","updateGiftCardList","selectedRadio","selectedAddress","addressError","isLocalStorage","localStorage","setItem","toshiFlag","toshiDeliveryMode","handleSMSNotification","handleUnsubscribe","registrationForm","consentList","defaultMsg","deliveryContainer","deliveryCalendarDate","deliveryDateStatus","invalidFields","invalidItem","phoneNumber","isKR","mobileValidation","isValid","addcncDeliveryAnalytics","addDeliveryAnalytics","manageDataObj","countryCodeName","sendToDatalayer","processStep","stepNumber","currentLocale","promocode","Promocode","nextPage","appliedFocusOnActiveForm","pathPage","isGuestUser","getItem","funnel_type","category","cartValue","cartValueWithoutTax","checkoutStepName","sub_category_level1","cartValueWithTax","checkoutStepNumber","userEmail","email_sha256","sha256","paramsData","inputs","isoCode","namesToExclude","required","indexOf","selectedOptions","isNotMobile","countryIso","stepBack","button","formFocus","checkPrivacy","privacyErrorMsg","labelPrivacy","valueMissing","privacy","updateAnalyticsShippingOptions","updateSteps","hidden","phonePattern","dispatchPhoneNumber","dispatchEvent","editboutiqueLayerUpdate","manageStep1ScreenSwitch","selectPOSNow","preSelectedPOS","lat","long","initializeMap","updatePageTitle","loadMaponEditBoutique","shippingOptionHighlight","deliveryMethodCalendar","stepDivElm","firstElementChild","stepName","pageTitle","headingTextEle","headingText","pushCheckoutMonetateData","reviewCart","sendShippingDataToDatalayer","replaceSteps","httpForm","Promise","resolve","all","promises","activationPopup","gigya","accounts","hideScreenSet","screenSet","checkMergeCookie","WRAPPING_KEY","promptMergeDecision","promptMergeWrappingDecision","btnContinuetoShippingOptions","updateWrappingChoice","callSeeMoreOption","loadGmoDeviceFingerUrl","getCustomerTimeZone","showUnionPay","showWeChat","loadMapOnPageLoad","updateSamples","updateEmployeeSavings","updateOrderSummary","selectDeliveryMethod","resetPaymentModes","timeZoneElm","unionPayDiv","weChatDiv","aliPay","isWeChatBrowser","wechatCheckbox","alipayCheckbox","weChatForm","aliPayForm","wechatPayTerms","aliPayTerms","seeMoreBtns","toggleSeeMore","seeMoreBtn","seeMoreContent","nextElementSibling","conciergeDelivery","seeLessBtn","paymentUl","paymentLi","applePayDiv","isEmployeeSale","sampleList","wrapper","notification","samples","employee","wrapping","employeeSavingsSection","orderSummaryElm","cart_items","setFocus","hasFocus","inputEl","managePlaceholders","loginInput","passwordContainer","onfocusin","onblur","onchange","step1DivElm","gigyaWrapperElm","guestDivElm","gigyaLoginScreen","gigyaRegisterScreen","hideBlock","showBlock","forceSwitch","switchScreen","containerID","screen","toggleDisplay","stepDisplay","updateAnalyticsUserOpc","inert","REMOVE_ERROR","unset","updateDefaultCardCheckbox","updateDatalayerStep","divElm","subtotal","privateWait","setTimeout","stepsElms","activeStepElm","find","stepElm","titleElm","res","PAGELOAD_WISHLIST","signInElm","welcomeElm","session","welcomeLiString","signinWelcome","welcomeLiElm","svgElm","firstNameElm","menu","welcome","accountUrl","childNodes","menuNameList","samplesBlockElm","nbSamples","samplesBlock","PromocodeToggle","onUserConfirmedWrongAddress","isSafari","handlePopState","radioButton","shippingNodes","shippingNode","detailsSection","inputElement","setCustomValidity","deliverySlotDateInput","selectBox","shippingOptions","nameAndPrice","substring","DLKit","eventAction","eventLabel","selectOpt","PSOptionWrapper","shippingAddressSection","cartPriceEle","customerEle","customerAsideEle","stickyMap","inputs_length","cncOption","homeDeliveryOption","addhomeDeliveryCnCAnalytics","posDataLayerUpdate","top","offsetHeight","overflow","inputPOS","totalPOS","posMap","weekendDeliverySelect","handleChange","isChallengeShopper","initThreeDS2Popin","giftCardList","paymentCreditCard","nonSelectedPOSList","pymtError","pushDataEvent","selectPOSAddress","selectPOS","posValue","skipStoreMapTop","skipStoremapBottom","j","lng","posTitle","elementType","stylers","visibility","center","google","maps","LatLng","mapOptions","mapTypeId","MapTypeId","ROADMAP","disableDefaultUI","zoomControl","gestureHandling","mobileMapElement","posMapBlock","Map","isTabletScreen","mapType","StyledMapType","mapTypes","setMapTypeId","latlngbounds","LatLngBounds","latLng","Number","pt","marker_image","theme","pinIcon","MarkerImage","Size","marker","Marker","position","addListener","setCenter","setZoom","bounds","getCenter","fitBounds","posId","posElement","hideNewCardForm","paymentMethodBlock","paymentIdEdit","selectedCard","formAction","script","gmoDeviceFingerUrl","evt","selectPaymentFocusIn","activeElement","border","selectPaymentFocusOut","selectPaymentType","paymentTypeEl","giftcardEl","codPaymentEl","setTrustlyEl","setOptionalEl","updateCodPayment","giftMethodEl","op","codOperation","selectSavedCard","selectedCvvId","setDefaultEl","setSavePaymentMethodEl","cvvLabelElement","cvnInputField","eventCategory","updateAnalyticsEditAddress","updateAnalyticsAddAddress","updateAnalyticsContinueAsGuest","updateAnalyticsOpcEdit","title","posListArray","cnc","click_and_collect_number_of_store","eventActionMap","eventActionList","defaultPaymentMethod","paymentDetailsForm","creditCardOption","click","numberSubmitted","mobileNumber","inptPhone","phoneCountryCode","inpt","modifiedTime","updateSMSNumber","cancelUpdateSMSNumber","handleSubscribeAgain","signUpCta","pElement","selectPhoneInput","shippingRulesDataLayerUpdate","giftCardDataLayerUpdate","changePaymentType","paymentModeSelector","giftCardPaymentHeader","giftCardBtn","creditCardBtn","giftCardListDisplay","removeGiftCard","renderGiftCardSection","selectedCardDefault","evtParams","bubbles","cancelable","giftForm","addGiftCard","gift_card_number","gift_card_cvn","giftCardTitleEl","giftCardNo","giftCardCvn","defaultUrl","jsonData","successKey","dataErrorMessage","giftCardForm","addMoreGiftCard","giftCardPlaceOrder","removeAllGiftCards","removeLink","giftCardNoEl","showGiftCardForm","giftCardLabel","hideGiftCardForm","giftCardAddEl","showPaymentForm","giftCardlistDiv","giftCardMoreSection","giftCardMethod","selectCardType","handleDeliverySlotDateSelection","deliverySlotDateSelectBox","timeSlotSelectBox","selectedOption","timeSlots","timeSlot","text","editOrderSummary","paymentModeSelected","paymentInfoNodes","cardNumber","paymentInfoNode","updateRegisterUserDetails","perferencesDetail","updateAnalyticsPerferenceRegister","updateIncompleteAddress","sidepanelDiv","addressForm","orderRegisterUserDetails","updateAnalyticsOrderPerferenceRegister","toshiDeliveryMehod","deliverySlotSelected","dataTime","updateAnalyticErrorToshi","updateDataOnWeekendDeliverySelect","srcElement","containerDiv","price","dropdown","arr","onSaveAddressCheckbox","savecheckbox","invoiceDisplay","invoice","invoiceform","invoicePrivacy","invoiceAccount","invoiceList","invoiceRadio","profesional","invoiceTypeDisplay","personal","invoiceCompany","invoicePersonal","editExistingBoutique","productCode","sidePanel","popups","geoPointDetails","elmId","updateOnlineGiftCardBtn","navigator","onLine","confirmGiftCardBtn","copyQRCode","qrCode","clipboard","writeText","copyNotification","notifier","notifierNotify","notifierTitle","notifierDesc","handlePOSMap","LIST_ITEMS_SELECTOR","SIDEPANEL_ADD_ADDRESS_FORM_SELECTOR","DIALOG_WRONG_ADDRESS_CLOSE_BUTTON_SELECTOR","handleEditResponse","displayMoreItems","selectionList","lastItem","childElementCount","updatedItem","tempWrapper","item","replaceChild","on","requestAnimationFrame","itemInput","handleSidepanelEditForm","addSelector","checkboxCompanyName","inputCompanyName","submitFormData","updateAnalyticsEditAddressSideTray","phone","trimNumber","loadMoreItems","replacedApi","loader","Loader","enableSyncCol","referenceEl","create","more","loadmore","manageLoadMoreButton","destroy","next","offsetParent","onUserCloseWrongAddress","PROMOCODE_ID","PROMOCODE_FORM_ID","PROMOCODE_INTRO_ID","TOGGLE_SELECTOR","focusable","intro","dataLyerType","promoCodeDataLayerEntry","highlightShippingNodeWithPromo","formTypeRemove","formTypeAdd","setFocusAdd","setFocusRemove","pop","confirmation","request","noFocus","addNewEle","addNewValue","newPromoBtn","handlePromoAdd","voucherCode","submitted","ThreeDS2Popin","challengeTokenIdElem","challengeToken","legacy","checkGiftCard","isGiftCard","perform3DS2Operations","tokenID","initiate3DS2ChallengeShopper","threeDS2ChallengeShopperNode","localeValue","envValue","configuration","locale","environment","AdyenCheckout","challengeShopperComponent","challengeData","challengeResult","details","challengeResultField","threeDS2popinCol","onError","stringify","size","mount","threeDS2Auth","closethreeDS2Auth","threeDS2ResponseLegacy","threeDS2GiftCard","threeDS2Response","popin3DS2","authLabelTitle","threeDS2","Toggle","scope","handleFormAction","defaultAction","formaction"],"mappings":";;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;;AAEA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA,qC;;;;;;;;;;;ACxOA,C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","file":"chunks/checkout.js?v=3.23","sourcesContent":["var map = {\n\t\"./ar.js\": [\n\t\t\"./node_modules/flatpickr/dist/l10n/ar.js\",\n\t\t10\n\t],\n\t\"./at.js\": [\n\t\t\"./node_modules/flatpickr/dist/l10n/at.js\",\n\t\t11\n\t],\n\t\"./be.js\": [\n\t\t\"./node_modules/flatpickr/dist/l10n/be.js\",\n\t\t12\n\t],\n\t\"./bg.js\": [\n\t\t\"./node_modules/flatpickr/dist/l10n/bg.js\",\n\t\t13\n\t],\n\t\"./bn.js\": [\n\t\t\"./node_modules/flatpickr/dist/l10n/bn.js\",\n\t\t14\n\t],\n\t\"./cat.js\": [\n\t\t\"./node_modules/flatpickr/dist/l10n/cat.js\",\n\t\t15\n\t],\n\t\"./cs.js\": [\n\t\t\"./node_modules/flatpickr/dist/l10n/cs.js\",\n\t\t16\n\t],\n\t\"./cy.js\": [\n\t\t\"./node_modules/flatpickr/dist/l10n/cy.js\",\n\t\t17\n\t],\n\t\"./da.js\": [\n\t\t\"./node_modules/flatpickr/dist/l10n/da.js\",\n\t\t18\n\t],\n\t\"./de.js\": [\n\t\t\"./node_modules/flatpickr/dist/l10n/de.js\",\n\t\t19\n\t],\n\t\"./default.js\": [\n\t\t\"./node_modules/flatpickr/dist/l10n/default.js\",\n\t\t20\n\t],\n\t\"./eo.js\": [\n\t\t\"./node_modules/flatpickr/dist/l10n/eo.js\",\n\t\t21\n\t],\n\t\"./es.js\": [\n\t\t\"./node_modules/flatpickr/dist/l10n/es.js\",\n\t\t22\n\t],\n\t\"./et.js\": [\n\t\t\"./node_modules/flatpickr/dist/l10n/et.js\",\n\t\t23\n\t],\n\t\"./fa.js\": [\n\t\t\"./node_modules/flatpickr/dist/l10n/fa.js\",\n\t\t24\n\t],\n\t\"./fi.js\": [\n\t\t\"./node_modules/flatpickr/dist/l10n/fi.js\",\n\t\t25\n\t],\n\t\"./fr.js\": [\n\t\t\"./node_modules/flatpickr/dist/l10n/fr.js\",\n\t\t26\n\t],\n\t\"./gr.js\": [\n\t\t\"./node_modules/flatpickr/dist/l10n/gr.js\",\n\t\t27\n\t],\n\t\"./he.js\": [\n\t\t\"./node_modules/flatpickr/dist/l10n/he.js\",\n\t\t28\n\t],\n\t\"./hi.js\": [\n\t\t\"./node_modules/flatpickr/dist/l10n/hi.js\",\n\t\t29\n\t],\n\t\"./hr.js\": [\n\t\t\"./node_modules/flatpickr/dist/l10n/hr.js\",\n\t\t30\n\t],\n\t\"./hu.js\": [\n\t\t\"./node_modules/flatpickr/dist/l10n/hu.js\",\n\t\t31\n\t],\n\t\"./id.js\": [\n\t\t\"./node_modules/flatpickr/dist/l10n/id.js\",\n\t\t32\n\t],\n\t\"./index.js\": [\n\t\t\"./node_modules/flatpickr/dist/l10n/index.js\",\n\t\t33\n\t],\n\t\"./it.js\": [\n\t\t\"./node_modules/flatpickr/dist/l10n/it.js\",\n\t\t34\n\t],\n\t\"./ja.js\": [\n\t\t\"./node_modules/flatpickr/dist/l10n/ja.js\",\n\t\t35\n\t],\n\t\"./km.js\": [\n\t\t\"./node_modules/flatpickr/dist/l10n/km.js\",\n\t\t36\n\t],\n\t\"./ko.js\": [\n\t\t\"./node_modules/flatpickr/dist/l10n/ko.js\",\n\t\t37\n\t],\n\t\"./kz.js\": [\n\t\t\"./node_modules/flatpickr/dist/l10n/kz.js\",\n\t\t38\n\t],\n\t\"./lt.js\": [\n\t\t\"./node_modules/flatpickr/dist/l10n/lt.js\",\n\t\t39\n\t],\n\t\"./lv.js\": [\n\t\t\"./node_modules/flatpickr/dist/l10n/lv.js\",\n\t\t40\n\t],\n\t\"./mk.js\": [\n\t\t\"./node_modules/flatpickr/dist/l10n/mk.js\",\n\t\t41\n\t],\n\t\"./mn.js\": [\n\t\t\"./node_modules/flatpickr/dist/l10n/mn.js\",\n\t\t42\n\t],\n\t\"./ms.js\": [\n\t\t\"./node_modules/flatpickr/dist/l10n/ms.js\",\n\t\t43\n\t],\n\t\"./my.js\": [\n\t\t\"./node_modules/flatpickr/dist/l10n/my.js\",\n\t\t44\n\t],\n\t\"./nl.js\": [\n\t\t\"./node_modules/flatpickr/dist/l10n/nl.js\",\n\t\t45\n\t],\n\t\"./no.js\": [\n\t\t\"./node_modules/flatpickr/dist/l10n/no.js\",\n\t\t46\n\t],\n\t\"./pa.js\": [\n\t\t\"./node_modules/flatpickr/dist/l10n/pa.js\",\n\t\t47\n\t],\n\t\"./pl.js\": [\n\t\t\"./node_modules/flatpickr/dist/l10n/pl.js\",\n\t\t48\n\t],\n\t\"./pt.js\": [\n\t\t\"./node_modules/flatpickr/dist/l10n/pt.js\",\n\t\t49\n\t],\n\t\"./ro.js\": [\n\t\t\"./node_modules/flatpickr/dist/l10n/ro.js\",\n\t\t50\n\t],\n\t\"./ru.js\": [\n\t\t\"./node_modules/flatpickr/dist/l10n/ru.js\",\n\t\t51\n\t],\n\t\"./si.js\": [\n\t\t\"./node_modules/flatpickr/dist/l10n/si.js\",\n\t\t52\n\t],\n\t\"./sk.js\": [\n\t\t\"./node_modules/flatpickr/dist/l10n/sk.js\",\n\t\t53\n\t],\n\t\"./sl.js\": [\n\t\t\"./node_modules/flatpickr/dist/l10n/sl.js\",\n\t\t54\n\t],\n\t\"./sq.js\": [\n\t\t\"./node_modules/flatpickr/dist/l10n/sq.js\",\n\t\t55\n\t],\n\t\"./sr.js\": [\n\t\t\"./node_modules/flatpickr/dist/l10n/sr.js\",\n\t\t56\n\t],\n\t\"./sv.js\": [\n\t\t\"./node_modules/flatpickr/dist/l10n/sv.js\",\n\t\t57\n\t],\n\t\"./th.js\": [\n\t\t\"./node_modules/flatpickr/dist/l10n/th.js\",\n\t\t58\n\t],\n\t\"./tr.js\": [\n\t\t\"./node_modules/flatpickr/dist/l10n/tr.js\",\n\t\t59\n\t],\n\t\"./uk.js\": [\n\t\t\"./node_modules/flatpickr/dist/l10n/uk.js\",\n\t\t60\n\t],\n\t\"./vn.js\": [\n\t\t\"./node_modules/flatpickr/dist/l10n/vn.js\",\n\t\t61\n\t],\n\t\"./zh.js\": [\n\t\t\"./node_modules/flatpickr/dist/l10n/zh.js\",\n\t\t62\n\t]\n};\nfunction webpackAsyncContext(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\treturn Promise.resolve().then(function() {\n\t\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\t\te.code = 'MODULE_NOT_FOUND';\n\t\t\tthrow e;\n\t\t});\n\t}\n\n\tvar ids = map[req], id = ids[0];\n\treturn __webpack_require__.e(ids[1]).then(function() {\n\t\treturn __webpack_require__.t(id, 7);\n\t});\n}\nwebpackAsyncContext.keys = function webpackAsyncContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackAsyncContext.id = \"./node_modules/flatpickr/dist/l10n lazy recursive ^\\\\.\\\\/.*\\\\.js$\";\nmodule.exports = webpackAsyncContext;","(() => {\n  const addEvent = (el, type, fn) => {\n    if (el.addEventListener)\n      el.addEventListener(type, fn, false)\n        else\n            el.attachEvent('on'+type, fn)\n  }\n  const extend = (obj, ext) => {\n    for(let key in ext)\n      if(ext.hasOwnProperty(key))\n        obj[key] = ext[key]\n    return obj\n  }\n  window.fitText = (el, kompressor, options) => {\n    const settings = extend({\n      'minFontSize' : -1/0,\n      'maxFontSize' : 1/0\n    }, options)\n    const fit = (el) => {\n      const compressor = kompressor || 1\n      const resizer = function () {\n        el.style.fontSize = Math.max(Math.min(el.clientWidth / (compressor*10), parseFloat(settings.maxFontSize)), parseFloat(settings.minFontSize)) + 'px'\n      }\n      resizer()\n      addEvent(window, 'resize', resizer)\n      addEvent(window, 'orientationchange', resizer)\n    }\n    if (el.length)\n      for(let i=0; i < el.length; i++)\n        fit(el[i])\n    else\n      fit(el)\n    return el\n  }\n})()","import Loader from 'ui/widgets/loader'\nimport * as xhr from 'modules/fetch'\n\nfunction initToshiDetails(el) {\n\n  const {toshiCartDataUrl, toshiLibraryUrl} = window.config.webservices\n\n  /**\n  * Triggered once form is created to get data to populate the form\n  */\n  function getData() {\n    let data = {\n      data : {\n          deliveryModeCode: el.getAttribute(\"data-method-toshi\")\n        }\n    }\n\n    xhr.post(toshiCartDataUrl, data).then(data => {\n      showDetails(el, data.toshi)\n    })\n  }\n\n  if (!window.toshi) {\n    global._babelPolyfill = false\n    const apiToshi = document.createElement('script')\n    apiToshi.type = 'text/javascript'\n    apiToshi.id = 'apiToshi'\n    apiToshi.src = toshiLibraryUrl\n    apiToshi.onload = () => {\n        getData()\n    }\n    document.body.appendChild(apiToshi)\n  }\n  else {\n    // already loaded just fill user data and mount modal\n    getData()\n  }\n\n  function showDetails(el, data) {\n    \n    if(window.toshi) {\n      const modal = window.toshi.createBookingIntegration({\n          api: {\n              url: data.toshiApiUrl,\n              key: data.toshiApiKey\n          }\n      });\n      \n      // This is fired by the ecommerce integration when the customer attempts to\n      // proceed without selecting a timeslot.\n      window.showErrorMessage = () => {\n        modal.setInlineErrorMessage(\n          \"Please add your details before proceeding!\"\n        );\n      };\n      window.hideErrorMessage = () => {\n        modal.setInlineErrorMessage(undefined)\n      };\n      \n      modal.setFirstName(data.cartUserFirstName)\n      modal.setLastName(data.cartUserLastName)\n      modal.setEmail(data.cartUserEmail)\n      modal.setPhone(data.cartUserPhone)\n      modal.setAddress(data.cartUserAddress)\n\n      modal.setBrandCheckoutReference(data.checkoutReference)\n\n      modal.setProducts(data.cartEntries)\n\n      modal.mountModalSeparately(el, document.body)   \n    }\n  }\n}\n\nexport default initToshiDetails","import bind from 'delegate'\nimport * as xhr from 'modules/fetch'\nimport popin from 'modules/popin'\nimport { select, selectAll, getCollection } from 'lib/selectors'\nimport { read as readCookie, remove as removeCookie } from 'modules/cookie'\nimport config from 'lib/config'\nimport { Manager, CHECK_API } from 'lib/events'\nimport { encodePasswords, decodePasswords } from 'lib/helpers'\n\n// This cookie can be created manually in your browser\n// to display the popin after a page refresh\n// ie. forceResetPassword=true\nconst COOKIE_KEY = 'forceResetPassword'\nconst POPIN_SELECTOR = '#js-modal-prompt-password-update'\nconst FORM_SELECTOR = '#js-modal-prompt-password-update-form'\n\nexport default function resetPassword() {\n  let isVisible = false\n  let followRedirect = true\n  let userData\n\n  // Redirect is not followed from opc\n  function handleFromLogin() {\n    removeCookie(COOKIE_KEY)\n    showPopin(select(POPIN_SELECTOR), 'login')\n  }\n\n  function handleFromOPC(data) {\n    // Let Gigya handle the login\n    followRedirect = false\n    // Save userData from later use\n    userData = data\n    // Set reset password hidden email to sign in value if necessary\n    const hiddenEmailEl = document.getElementById('emailID')\n    if (hiddenEmailEl.value.length === 0) {\n      const sourceEl = document.getElementById('login-email')\n      if (sourceEl) {\n        hiddenEmailEl.value = sourceEl.value\n      }\n    }\n    showPopin(select(POPIN_SELECTOR), 'checkout')\n  }\n\n  function showPopin(formContainerEl, page) {\n    isVisible = true\n\n    popin.open({\n      label: config.locales.modal.passwordForcedUpdate.label,\n      html: fixRevealPassword(formContainerEl).innerHTML,\n      role: 'dialog',\n      modifiers: 'is-big is-my-account',\n      opener: null,\n      manageFocus: false,\n      forceInert: true,\n      modal: true,\n      closeButton: 'is-popin-close',\n      closeButtonDataTest: 'btnClosePasswordUpdateRequired',\n      page\n    })\n  }\n\n  function checkAPI(json) {\n    // 403100 Gigya status: Pending password change\n    // The password is flagged and has to be updated\n    if (json.errorCode === 403100) {\n      // Set hidden field to previously entered email value\n      const inEmailEl = document.getElementById('login-email')\n      const outEmailEl = document.getElementById('emailID')\n      outEmailEl.value = inEmailEl.value\n      isVisible = false\n      if (!isVisible) {\n        handleFromLogin()\n      }\n    }\n  }\n\n  function handleSubmit(e) {\n    function handleSuccess(data) {\n      popin.hide()\n      isVisible = false\n      // From login: redirect to the given URL\n      if (followRedirect) {\n        window.location = data.redirectURL\n      }\n      // From OPC: validate login and move to next step\n      else if (userData) {\n        delete userData.forceUpdate\n        Manager.publish('gigyaLogin', userData)\n      }\n    }\n\n    const form = e.delegateTarget\n    const selectors = ['input#password-currentPassword-popin', 'input#password-newPassword-popin']\n    if (form.invalid.length) {\n      return\n    }\n\n    e.preventDefault()\n\n    // Encodes password (current and new) before sent\n    encodePasswords(selectors, form)\n\n    xhr.submit(form)\n      .then(handleSuccess)\n      .catch(err => {\n        console.error(err)\n      })\n\n    // Restore passwords once they are sent\n    decodePasswords(selectors, form)\n\n  }\n\n\n  const promptPasswordMode = readCookie(COOKIE_KEY)\n\n  Manager.subscribe(CHECK_API, checkAPI)\n  bind(document.body, FORM_SELECTOR, 'submit', handleSubmit)\n  if (promptPasswordMode) {\n    handleFromLogin()\n  }\n\n  return { handleFromOPC }\n}\n\n// Helpers that updates the ids so the JS bindings remains active after cloning\n// ie. use of the show password relies on ids, duplicate ids messes it up\nfunction fixRevealPassword(nodeElement) {\n  const copyEl = nodeElement.cloneNode(true)\n  selectAll('input[type=password]', copyEl).forEach(el => el.setAttribute('id', `${el.id}-popin`))\n  selectAll('[data-toggle-password]', copyEl).forEach(el => el.setAttribute('data-toggle-password', `${el.dataset.togglePassword}-popin`))\n  selectAll('label[for]', copyEl).forEach(el => el.setAttribute('for', `${el.getAttribute('for')}-popin`))\n  return copyEl\n}\n","import {select, selectAll, getCollection} from 'lib/selectors'\nimport config from 'lib/config'\nimport bind from 'delegate'\n\n/**\n * Triggered once user change newsletter checkbox value\n * @param evt {object}: click event\n */\nexport default function preferenceSetting(el) {\n  \n  let heightOfNewsletterRule = 0 \n  \n  function handlePreferenceSetting(e) {\n    const newsletterElm = e.delegateTarget\n\n    if (newsletterElm) {\n      const newsletterRulesElm = select('div#newsletter-rules')\n      const isChecked = newsletterElm.checked\n      \n      if(newsletterRulesElm) {\n        if (config.country === 'GB' && config.pageName === 'checkout') {\n          if (isChecked) {\n            if (newsletterRulesElm.hasAttribute('hidden')) {\n              newsletterRulesElm.classList.remove('is-hidden')\n              newsletterRulesElm.removeAttribute('hidden')\n            }\n            newsletterRulesElm.classList.add('has-margin-bottom-sm')\n          } else {\n            newsletterRulesElm.setAttribute('hidden', '')\n            newsletterRulesElm.classList.remove('has-margin-bottom-sm')\n            newsletterRulesElm.classList.add('is-hidden')\n          }\n          \n        } else {\n        // Add/Remove class to avoid margin mistake\n          newsletterRulesElm.classList.remove('is-hidden')\n          newsletterRulesElm.removeAttribute('hidden')\n        } \n\n        // Used only for first times to get height\n        if (!heightOfNewsletterRule) {\n          newsletterRulesElm.classList.remove('is-hidden')\n          heightOfNewsletterRule = newsletterRulesElm.clientHeight\n          newsletterRulesElm.style.height = 0\n        }\n\n        // Start animation for both check and unchecked\n        TweenLite.fromTo(newsletterRulesElm, (isChecked ? 1 : .4),\n          { autoAlpha: isChecked ? 0 : .5, height: isChecked ? 0 : heightOfNewsletterRule },\n          { autoAlpha: isChecked ? 1 : .0, height: isChecked ? heightOfNewsletterRule : 0 }\n        ).eventCallback('onComplete',() => {\n          if (isChecked) {\n            newsletterRulesElm.removeAttribute('hidden')\n          } else {\n            newsletterRulesElm.setAttribute('hidden', '')\n          }\n        })\n      }\n\n      // Stuff for the Newsletter interest\n      getCollection('.gigya-status', el).forEach((elm) => {\n        elm.value = isChecked ? 'INTERESTED' : 'UNSET'\n      })\n\n      const gigyaEmailStatusElm = selectAll('.gigya-status-value', el)\n      gigyaEmailStatusElm.forEach(el => {\n        el.value = isChecked ? 'OPTIN' : 'UNSET'\n      })\n        \n    }\n  }\n  \n  bind(el, 'input#newsletter-subscribe', 'change', handlePreferenceSetting)\n  \n}\n","import bind from 'delegate'\nimport popin from 'modules/popin'\n\nlet binded = false\n\nfunction addressIsValid(e) {\n  const currentPopin = e.target.closest('.popin-wrapper')\n\n  if (!currentPopin) {\n    return\n  }\n\n  const validCallback = currentPopin.data('validCallback')\n\n  if (!validCallback) {\n    return\n  }\n\n  validCallback()\n}\n\nfunction display(params) {\n  // register an event handler  if not already registered\n  if (!binded) {\n    bind(document.body, '.popin [data-is-valid=\"true\"]', 'click', addressIsValid)\n    binded = true\n  }\n\n  // display the popin\n  popin.open(params)\n    .then(data => {\n      const modal = data.modal\n      modal.el.data('validCallback', params.validCallback)\n      modal.el.setAttribute('role', 'dialog')\n      modal.el.removeAttribute('aria-describedby')\n    })\n}\n\nexport default { display }\n","/* eslint-disable no-new */\nimport Base from 'modules/base'\nimport bind from 'delegate'\nimport {select, selectAll} from 'lib/selectors'\nimport {applePayIsSupported} from 'lib/helpers'\nimport {Manager, OPC_STEP_PROCESS} from 'lib/events'\nimport {getApplePayData, startApplePaySession} from \"../../lib/applepay/applepay-common\";\n\n// Selectors\nconst MODULE_SELECTOR = '[data-page-type=checkout]'\nconst OPC_APPLE_PAY_INPUT_SELECTOR = '.js-applepay-enable'\nconst APPLE_PAY_CTA_SELECTOR = '.js-apple-pay-checkout-btn'\n\nclass ApplePayOPCManager extends Base {\n\n  constructor(el) {\n    super(el)\n    this.el = el\n    this.params = {\n      applePayData: null\n    }\n    this.bindEvents()\n  }\n\n  bindEvents() {\n    bind(this.el, `${APPLE_PAY_CTA_SELECTOR}`, 'click', this.onApplePayCheckoutButtonClicked)\n    window.addEventListener('load', this.onPageLoad)\n    Manager.subscribe(OPC_STEP_PROCESS, this.onOPCStepProcess)\n  }\n\n  /**\n   * This enable ApplePay radio button if ApplePay is supported\n   */\n  renderExpressCheckoutCtas() {\n    if (applePayIsSupported()) {\n      const applePayEl = select(`${OPC_APPLE_PAY_INPUT_SELECTOR}`, this.el)\n      if (applePayEl) {\n        getApplePayData('checkout').then((data) => {\n          this.params.applePayData = data\n          applePayEl.removeAttribute('hidden')\n        })\n      }\n    }\n  }\n\n\n  disablePaymentModes() {\n    const billingForm = select('form[id=\"sopPaymentDetailsForm\"]', this.el)\n    const billingRadioButtonsElm = select('.js-billing-radio-buttons', billingForm)\n    const radioButtonsElm = selectAll('li input', billingRadioButtonsElm)\n\n    radioButtonsElm.forEach(radioElm => {\n      if (!radioElm.checked) {\n        radioElm.disabled = true\n      }\n    })\n  }\n\n  enablePaymentModes() {\n    const billingForm = select('form[id=\"sopPaymentDetailsForm\"]', this.el)\n    const billingRadioButtonsElm = select('.js-billing-radio-buttons', billingForm)\n    const radioButtonsElm = selectAll('li input', billingRadioButtonsElm)\n\n    radioButtonsElm.forEach(radioElm => {\n      radioElm.disabled = false\n    })\n  }\n\n  updateBillingStep() {\n    const billingForm = select('form[id=\"sopPaymentDetailsForm\"]', this.el)\n    const applePayBlockElm = select('div[id=\"applePay-method\"]', billingForm)\n    const placeOrderBlockElm = select('[id=\"apple-pay-payment\"]', billingForm)\n\n    // Hide ApplePayBlock, display order block and disable the unchecked input\n    applePayBlockElm.classList.add('is-hidden')\n    placeOrderBlockElm.classList.remove('is-hidden')\n    this.disablePaymentModes()\n    // Set order button action for apple pay\n    billingForm.action = window.config.webservices.applepay.placeOrder\n  }\n\n  onPageLoad = () => {\n    this.renderExpressCheckoutCtas()\n  }\n\n  /**\n   * Triggered once Each OPC step is activated\n   */\n  onOPCStepProcess = () => {\n    this.renderExpressCheckoutCtas()\n  }\n\n  onApplePayCheckoutButtonClicked = (event) => {\n    const shippingInfo = JSON.parse(event.delegateTarget.dataset.cartdata)\n\n    const checkTermCondEl = select('#setTermCondition_applePay')\n    const termCondErrorMsgEl = select('#error-setTermCondition_applePay')\n    const labeltermCondition = select('label[for=\"setTermCondition_applePay\"]')\n\n    if (checkTermCondEl && !checkTermCondEl.checked) {\n      if (!termCondErrorMsgEl && labeltermCondition) {\n        const pElem = document.createElement('p')\n        const errorMsg = document.createTextNode(window.config.locales.opc.customError.termsAndCondition)\n        pElem.classList.add('error')\n        pElem.setAttribute('id', 'error-setTermCondition_applePay')\n        pElem.appendChild(errorMsg)\n        labeltermCondition.appendChild(pElem)\n      }\n      return\n    } else {\n      if (termCondErrorMsgEl && labeltermCondition) {\n        labeltermCondition.removeChild(termCondErrorMsgEl)\n      }\n    }\n\n    this.disablePaymentModes()\n\n    if (this.params.applePayData) {\n      shippingInfo.cancelCallback = () => {\n        this.enablePaymentModes()\n      }\n      shippingInfo.placeOrderCallback = () => {\n        let formElm = select('form#sopPaymentDetailsForm')\n        if (formElm) {\n          formElm.action = window.config.webservices.applepay.placeOrder\n          formElm.submit()\n        }\n      }\n      shippingInfo.paymentAuthorizedFailureCallback = (response) => {\n        this.enablePaymentModes()\n        if (response && response.success == false) {\n          if (response.stockStatusFail) {\n            window.location.href = window.config.webservices.cart.cartUrl\n          } else if (response.posStockStatusFail || response.deliveryOptionAvailableFail) {\n            window.location.href = window.config.webservices.checkout.checkoutUrl\n          } else {\n            window.location.href = window.config.webservices.checkout.paymentError\n          }\n        }\n      }\n\n      startApplePaySession(shippingInfo, this.params.applePayData)\n\n    }\n  }\n\n}\n\nfunction initApplePayOPCManager(context = document) {\n  const OPCElm = select(MODULE_SELECTOR, context)\n  if (OPCElm) {\n    new ApplePayOPCManager(OPCElm, 'checkout')\n  }\n}\n\nexport default initApplePayOPCManager\n","import {select, selectAll} from 'lib/selectors'\nimport {focusElement, isWideScreen, tabIndexToZero} from 'lib/helpers'\nimport popin from 'modules/popin'\nimport config from 'lib/config'\nimport * as xhr from 'modules/fetch'\n\n// Selectors\nconst DIALOG_CLOSE_BUTTON_SELECTOR = 'div.yes-no-modal button.popin__close.js-popin-close'\n\n\n\nclass ChangeCountry {\n  constructor(el) {\n    this.el = el\n    this.buttonClose = null\n    this.params = {\n    }\n\n  }\n\n  async init() {\n    let responseData = await xhr.get(config.markets.checkoutUrl)\n\n    if (responseData && responseData.markets) {\n      const markets = responseData.markets\n      responseData.sortedMarketKeys = Object.keys(markets).sort((key1, key2) => {\n        let val1 = markets[key1].label.toUpperCase()\n        let val2 = markets[key2].label.toUpperCase()\n\n        if (val1 == val2) {\n          return 0\n        } else if (val1 > val2) {\n          return 1\n        } else {\n          return -1\n        }\n      })\n    }\n\n    this.data = responseData\n    this.buildTemplate()\n  }\n\n  // templates\n  buildTemplate() {\n    this.template =\n      `<div class=\"popin-text text-center\" data-close-label=\"${window.config.locales.opc.countryChange.closeChangeDeliveryCountry}\" data-test=\"secChangeDeliveryCountryPopin\">\n        <div class=\"modal-body\">\n          <form id=\"changeDeliveryCountryForm\" novalidate=\"true\" method=\"\" action=\"\">\n            <p id=\"title-change-delivery-country\" class=\"heading is-5\" role=\"heading\" aria-level=\"1\">\n              ${window.config.locales.opc.countryChange.deliveryCountry}\n            </p>\n            <p class=\"sub-heading\">${window.config.locales.opc.countryChange.currentlyOnlineBoutique.replace('{0}', '<strong>' + this.data.current.name + '</strong>')} </p>\n            <p>${window.config.locales.opc.countryChange.changeLocationDescription}</p>\n            <div class=\"field\" data-id=\"\">  \n              <div class=\"js-label-input has-select is-ready\">\n              <label class='heading is-7 text-center title-language' for=\"market-selection\" data-test=\"lblChangeYourLocation\">${window.config.locales.opc.countryChange.changeYourLocation}</label>\n              `+ this.marketSelectTemplate() + `\n              </div>\n            </div>\n            <p class=\"product-message\">${window.config.locales.opc.countryChange.cartMessage}</p>\n            <div class=\"button__wrapper\">\n                  <button type=\"submit\" class=\"button is-primary validate\" data-test=\"btnLanguageSubmit\">\n                    <span class=\"button__wrapper\">\n                      <span class=\"label\">${window.config.locales.opc.countryChange.submit}</span>\n                    </span>\n                  </button>\n            </div>\n          </form>\n        </div>\n      </div>`\n  }\n\n  createSelectBox() {\n    const el = document.createElement('select')\n    el.classList.add('selectbox__input')\n    el.classList.add('is-simple')\n    el.classList.add('select-country-focus')\n    el.setAttribute('data-test', 'drdwnChangeCountry')\n    el.setAttribute('required', 'true')\n    return el\n  }\n\n  marketSelectTemplate() {\n    const el = this.createSelectBox()\n    el.id = \"market-selection\"\n    this.populateMarkets(el, true)\n    const html = this.setNiceSelectTemplate(el)\n    return html\n  }\n\n  populateMarkets(marketSelection, firstLoad = false) {\n    // remove initial content\n    while (marketSelection.firstChild) {\n      marketSelection.removeChild(marketSelection.firstChild)\n    }\n\n    let markets = this.data.markets\n\n    //Default select country option\n    var option = document.createElement('option')\n    option.innerText = `${window.config.locales.opc.countryChange.defaultOption}`\n    option.value = \"\"\n    option.setAttribute('selected', 'selected')\n    marketSelection.append(option)\n    if(this.data.sortedMarketKeys) {\n      this.data.sortedMarketKeys.forEach((marketKey) => {\n        var option = document.createElement('option')\n        option.innerText = markets[marketKey].label\n        option.value = marketKey\n        marketSelection.append(option)\n      })\n    }\n  }\n  setNiceSelectTemplate(el) {\n    const html = `<span class=\"selectbox is-simple is-ready has-content i18n is-using-keyboard\">\n                  `+ el.outerHTML + `\n                  <span class=\"selectbox__wrapper\" aria-hidden=\"true\">\n                    <span></span>\n                  </span>\n                  <svg data-test=\"\" class=\"icon is-small  is-dropdown\" focusable=\"false\" viewBox=\"0 0 1 1\" aria-hidden=\"true\">\n                    <use xlink:href=\"${config.paths.icons}icons.svg${config.targetVersion}#dropdown\"></use>\n                  </svg>\n                </span>`\n    return html\n  }\n  onOpenPopin() {\n    this.setDomElements()\n  }\n\n  setDomElements() {\n    this.popinEl = select('.changeCountry')\n    this.buttonClose = select('.js-popin-close', this.popinEl)\n    this.marketSelection = select('#market-selection', this.popinEl)\n    this.buttonValidate = select('button.validate', this.popinEl)\n    this.form = select('form', this.popinEl)\n    this.marketSelection.addEventListener('change', this.onChangeMarket.bind(this))\n    this.productMessage = select('.product-message', this.popinEl)\n    this.productMessage.setAttribute('hidden','')\n    this.buttonValidate.addEventListener('click', this.onValidate.bind(this))\n  }\n\n  onValidate(event) {\n    if (this.data.markets[this.marketSelection.value].isFallback) {\n      event.preventDefault();\n      window.location.href = this.data.markets[this.marketSelection.value].url\n    }\n  }\n\n  onChangeMarket(e) {\n    let selectedMarket = e.target.value\n    selectedMarket && this.data.markets[selectedMarket].isFallback ? this.productMessage.removeAttribute('hidden') : this.productMessage.setAttribute('hidden', '')\n    if(selectedMarket && this.data.markets[selectedMarket].url){\n      this.formUrl = this.data.markets[selectedMarket].url\n      this.form.setAttribute(\"method\", \"POST\")\n      this.form.setAttribute(\"action\", this.formUrl)\n    }   \n  }\n\n  /**\n   * display a yes(remove) or no(cancel) dialog\n   * @param data {Object}: contains additional params\n   */\n  open() {\n    popin.open({\n      html: this.template,\n      role: 'dialog',\n      modifiers: 'is-relative changeCountry',\n      opener: null,\n      manageFocus: true,\n      forceInert: true,\n      modal: true,\n      action: 'removeCancelModal',\n      outerClose: false\n    }).then(() => {\n      this.onOpenPopin()\n    })\n    // To catch the esc key\n    window.addEventListener('keydown', this.onEscapeKeyClicked)\n  }\n\n  /**\n   * Close the active modal\n   */\n  closeModal() {\n    window.removeEventListener('keydown', this.onEscapeKeyClicked)\n    popin.hide()\n  }\n\n  /**\n   * Triggered once user clicked on the modal cancel button\n   * @param params {MouseEvent}: contains MouseEvent parameters\n   */\n  onModalCancelButtonClicked = (e) => {\n    this.closeModal()\n    focusElement(this.params.clickedElm)\n    if (!isWideScreen()) {\n      const links = selectAll('.collapse-panel__header .js-collapse-button')\n      if (links) {\n        tabIndexToZero(links)\n      }\n    }\n  }\n\n\n  /**\n   * Triggered once user clicked on keyboard inputs\n   * @param e {MouseEvent}: MouseEvent parameters \n   */\n  onEscapeKeyClicked = (e) => {\n    if ((e.key === 'Escape' || e.key === 'Esc' || e.keyCode === 27)) {\n      this.onModalCancelButtonClicked(e)\n    }\n  }\n\n}\n\n\nconst initChangeCountry = () => {\n  const changeCountry = new ChangeCountry()\n  changeCountry.init().then(() => {\n    changeCountry.open()\n  })\n}\n\nexport default initChangeCountry","import { getCollection, select, closest } from \"lib/selectors\"\nimport { isMobileScreen, removeElement, focusElement} from 'lib/helpers'\nimport bind from 'delegate'\nimport config from \"lib/config\"\nimport flatpickr from \"flatpickr\"\n\n(async () => {\n  try {\n    const { flatpickrLocale } = await import(`flatpickr/dist/l10n/${config.currentLanguage.split('_')[0]}.js`)\n    console.log(`${config.currentLanguage.split('_')[0]} calendar translations loaded`)\n  }\n  catch(err) {\n    console.log('file does not exist')\n  }\n})();\n\nconst COUNTRY_SELECTED = config.currentLanguage.split('_')[0]\nconst DATE_CONTAINER = '.js-date-container'\nconst INPUT_FIELD = '.js-select-date-input'\nconst SUBMIT_BTN = '.js-date-select-submit'\n\nclass dateSelection {\n  constructor() {\n\tthis.el = document.body\t\t\n\tthis.events = []\n\tthis.dateContainer = select(DATE_CONTAINER, this.el)\n\tif (this.dateContainer) {\n\t\tthis.dateContainer.innerHTML = ''\n    }\n\tflatpickr.localize(flatpickr.l10ns[COUNTRY_SELECTED])\n\tthis.bindEvents()\n  }\n  initializeCalendar(dateControl) {\n    let startDate, endDate, calendarContainer, inputControl, defaultDate, disable\n    if (isMobileScreen()) {\n    \tcalendarContainer = select(\".js-calendar-overlay-mobile\", document.body)\n    } else {\n    \tcalendarContainer = select(\".js-calendar-container\", dateControl)\n    }\n  \n    inputControl = select(\".js-select-date-input\", dateControl)\n    defaultDate = inputControl.getAttribute(\"data-defaultDate\")\n    startDate = inputControl.getAttribute(\"data-startDate\")\n    endDate = inputControl.getAttribute(\"data-endDate\")\n    self = this\n    this.events.push(bind(this.el, INPUT_FIELD, 'input', (event) => this.onInput(inputControl, event)))\n    this.events.push(bind(this.el, INPUT_FIELD, 'keydown', (event) => this.onKeydown(event)))\n    if (COUNTRY_SELECTED == 'ko') {\n      disable= [\n        function(date) {\n            return (date.getDay() === 0);\n        }\n      ]\n    }\n    this.CalendarInstance = flatpickr(dateControl, {\n      minDate: startDate,\n      maxDate: endDate,\n      defaultDate: defaultDate,\n      clickOpens: false,\n      appendTo: calendarContainer,\n      allowInput:true,\n      wrap: true,\n      disableMobile: \"true\",\n      ...(disable != null && disable != undefined) && {disable: disable},\n      onChange: function (selectedDates, dateStr, instance) {\n    \tself.cleanErrors(instance.input)\n\t\tlet date = selectedDates[0];\n\t\tdate.setHours(12);\n\t\tselect(\".delivery_slot_date\", dateControl).value = date.getTime();\n\t\tif (isMobileScreen()) {\n\t\t\tcalendarContainer.setAttribute(\"hidden\",\"\")\n\t\t}\n\t\tdocument.body.classList.remove(\"has-modal\")\n      },\n      onOpen: function (selectedDates, dateStr, instance) {\n\t\t  if (isMobileScreen()){\n\t\t\t  calendarContainer.removeAttribute(\"hidden\")\n\t\t\t  removeElement(\".flatpickr-close-btn\",instance.calendarContainer)\n\t    \t  let closeBtn = document.createElement(\"span\")\n\t    \t  closeBtn.innerHTML = `<svg class=\"icon is-medium is-close \" viewBox=\"0 0 1 1\" aria-hidden=\"true\">\n\t              <use xmlns:xlink=\"http://www.w3.org/1999/xlink\" xlink:href=\"${config.paths.icons}icons.svg${config.targetVersion}#close\"></use>\n\t              </svg>`\n\t    \t\t  \n\t    \t  closeBtn.classList.add(\"flatpickr-close-btn\")\n\t    \t  let svg = select(\"svg\", closeBtn)\n\t    \t  svg.addEventListener('click', function(e){\n\t    \t\t  e.preventDefault()\n\t    \t\t  e.stopPropagation()\n\t    \t\t  instance.close()\n\t    \t  })\n\t    \t  instance.calendarContainer.appendChild(closeBtn)\n\t    \t  instance.calendarContainer.setAttribute(\"role\",\"dialog\")\n\t    \t  instance.calendarContainer.setAttribute(\"aria-label\",\"Calendar\")\n\t    \t  document.body.classList.add(\"has-modal\")\n\t\t  }\n      },\n      onClose: function () {\n    \t  if (isMobileScreen()){\n    \t\t  calendarContainer.setAttribute(\"hidden\",\"\")\n    \t\t  document.body.classList.remove(\"has-modal\")\n    \t  }\n      }\n    });\n  } \n  bindEvents() {\n    let self = this;\n    this.dateControl = getCollection(\".delivery-method-calendar\")\n    this.dateControl.forEach(function (calendar, i) {\n    \tself.initializeCalendar(calendar)\n    });\n  }\n  \n  checkDateRange(inputControl) {\n\tif(inputControl.value == \"\") {\n\t\tthis.createErrorMessage(inputControl,window.config.dl.opc.deliveryMethod.errors.emptyDate)\n\t\treturn false\n\t}\n\tlet startDate = new Date(inputControl.getAttribute('data-startDate'))\n\tlet endDate = new Date(inputControl.getAttribute('data-endDate'))\n\tlet selectedDate = new Date(inputControl.value)\n\tstartDate.setHours(12)\n\tendDate.setHours(12)\n\tselectedDate.setHours(12)\n\t\n\tif(this.checkValidDate(inputControl)){\n\t\tif(selectedDate.getTime() >= startDate.getTime() && selectedDate.getTime() <= endDate.getTime()){\n\t\t\tthis.cleanErrors(inputControl)\n\t\t\treturn selectedDate.getTime()\n\t\t} else{\n\t\t\tthis.createErrorMessage(inputControl,window.config.dl.opc.deliveryMethod.errors.unavailableDate)\n\t\t\treturn false\n\t\t}\n\t}else{\n\t\treturn false\n\t}\n  }\n  \n  checkValidDate(dateControl) {\n    const inputValue = dateControl.value.split('-').map((v) => parseInt(v.replace(/\\D/g, '')))\n    if (dateControl.value.match(/^\\d{4}\\-\\d{1,2}\\-\\d{1,2}$/)) {\n      this.cleanErrors(dateControl)\n      return true\n    } else {\n      this.createErrorMessage(dateControl, window.config.dl.opc.deliveryMethod.errors.inValidDate)\n      return false\n    }\n  }\n  \n  createErrorMessage(domElement, message) {\n    this.cleanErrors(domElement)\n    const elem = document.createElement('p')\n    const errorMsg = document.createTextNode(message)\n    const parent = domElement.parentNode\n    parent.classList.add('has-errors')\n    elem.classList.add('error')\n    elem.setAttribute('id', 'error-date')\n    elem.dataset.errorMessage = 'true'\n    elem.appendChild(errorMsg)\n    elem.setAttribute('data-test', 'data-test=\"lblDateErrormsg\"')\n    parent.parentNode.appendChild(elem)\n    domElement.setAttribute('aria-describedby', 'error-date')\n    focusElement(domElement, { notChangeTabIndex: true, caretAtTheEnd: false })\n    domElement.removeAttribute('tabindex')\n    return elem\n  }\n  \n  cleanErrors(element) {\n\telement = element.parentNode.parentNode\n    const hasErrorClasses = getCollection('.has-errors', element)\n    const errorMessages = getCollection('.error', element)\n    for (let i = 0; i < hasErrorClasses.length; i++) {\n      hasErrorClasses[i].classList.remove('has-errors')\n    }\n    for (let i = 0; i < errorMessages.length; i++) {\n      errorMessages[i].parentNode.removeChild(errorMessages[i])\n    }\n    element.removeAttribute('aria-describedby')\n  }\n\n  onKeydown(event) {\n    if (this.CalendarInstance.isOpen && (event.keyCode == 37 || event.keyCode == 38 || event.keyCode == 39 || event.keyCode == 40 || event.keyCode == 13)) {\n      event.stopPropagation()\n    }\n  }\n  onInput(dateInputSelector, event) {\n\tconst isInputCharacter = event.inputType === 'deleteContentForward' || event.inputType === 'deleteContentBackward'\n    if (!isInputCharacter && (dateInputSelector.value.match(/^\\d{4}$/) || dateInputSelector.value.match(/^\\d{4}\\-\\d{2}$/))) {\n      dateInputSelector.value += '-'\n    }\n    const startPos = dateInputSelector.selectionStart\n    let cursorPosition = startPos\n    dateInputSelector.classList.toggle('is-filled', dateInputSelector.value.length > 0)\n    const regex = /^[0-9-]/\n    const values = dateInputSelector.value.split().map((v) => {\n      if (!regex.test(dateInputSelector.value[startPos - 1])) {\n        cursorPosition = startPos - 1\n      }\n      return v.replace(/[^0-9\\-]/g, '')\n    })\n    dateInputSelector.value = values.join('')\n    if (cursorPosition === -1) cursorPosition++\n    dateInputSelector.setSelectionRange(cursorPosition, cursorPosition)\n  }\n}\n\nexport default dateSelection\n","import config from 'lib/config'\nimport { select, selectAll, getCollection } from 'lib/selectors'\n\nfunction hilightCreditCard(e) {\n  let isValidCardSupport\n  const creditCardInput = e.delegateTarget\n  const form = creditCardInput.closest('form')\n  const submitBtn = select('button[type=\"submit\"]', form)\n  const inputField = creditCardInput.closest('.field')\n  const cardIconList = select('.js-bank-icons')\n  const role = select('[aria-live=\"assertive\"]', form)\n  const cardSupportErr = select('.js-cardNumber-error')\n  const cardCVNTootip = select('#tooltip-card_cvn')\n  const amexTooltip = select('.amex-tooltip')\n  const otherTooltip = select('.other-tooltip')\n  \n  \n  let creditCardInputFourDigit\n\n  if (creditCardInput) {\n    creditCardInputFourDigit = creditCardInput.value.split('', 4).join('')\n  }\n\n  if (creditCardInputFourDigit.length === 4) {\n    const dataRegex = selectAll('.js-bank-icons [data-regex]')\n    const regexList = dataRegex.filter(reg => reg.dataset.regex.length > 0)\n\n    const cardTypeEl = select('#selectCreditCardType')\n    if (cardTypeEl) {\n      cardTypeEl.removeAttribute('data-cardIcon-value')\n    }\n    getCollection('.supported-card').forEach(card => {\n      card.classList.remove('supported-card')\n    })\n    regexList.forEach(regex => {\n      const fourDigitRegex = regex.dataset.regex.replace(RegExp(/{[0-9]}|{[0-9][0-9]}{1,}/g), '{0,}')\n\n      if (RegExp(fourDigitRegex).test(creditCardInputFourDigit)) {\n        highlightIcon(regex.id)\n      }\n    })\n    handleErr()\n  } else {\n    undoHighlight()\n  }\n\n  function highlightIcon(regex) {\n    let cardName\n    let cardNameId\n    const supportedCard = select(`li#${regex} .bank-icon`)\n    const cardTypeEl = select('#selectCreditCardType')\n\n    if (select(`li#${regex}`)) {\n      cardName = select(`li#${regex}`).dataset.cardName\n      cardNameId = select(`li#${regex}`).getAttribute('id')\n    }\n    if (cardIconList && supportedCard) {\n      if (cardCVNTootip) {\n    \tconst tooltipBtn = select('button', cardCVNTootip) \n    \tif (tooltipBtn) {\n          if (supportedCard.classList.contains('is-American')) {\n    \t    tooltipBtn.setAttribute('data-tooltip', amexTooltip.innerHTML)          \n    \t  }\n          else {\n            tooltipBtn.setAttribute('data-tooltip', otherTooltip.innerHTML)\n          }\n        }\n      }\n      cardIconList.classList.add('bank-icons--active')\n      supportedCard.classList.add('supported-card')\n      if (cardTypeEl && cardNameId)\n        if (cardTypeEl.getAttribute('data-cardIcon-value')) {\n          cardTypeEl.setAttribute('data-cardIcon-value', cardTypeEl.getAttribute('data-cardIcon-value') + \"|\" + cardNameId)\n        } else {\n          cardTypeEl.setAttribute('data-cardIcon-value', cardNameId)\n        }\n    }\n    if (role && cardName && !role.innerText) {\n      const roleMsg = document.createTextNode(`${config.dl.opc.paymentMethod.selected} ${cardName}`)\n      role.appendChild(roleMsg)\n    }\n  }\n\n  function undoHighlight() {\n    if (cardIconList) {\n      cardIconList.classList.remove('bank-icons--active')\n    }\n    selectAll('.supported-card').forEach(card => {\n      card.classList.remove('supported-card')\n    })\n    if (role) {\n      role.innerText = ''\n    }\n  }\n\n  function handleErr() {\n    isValidCardSupport = selectAll('.js-bank-icons .bank-icon').some(icon => icon.classList.contains('supported-card'))\n    // eslint-disable-next-line\n    !isValidCardSupport ? addErr() : removeErr()\n  }\n\n  function addErr() {\n    if (cardSupportErr) {\n      cardSupportErr.innerText = config.locales.errors.form.global.paymentMethodes.notAccepted\n      cardSupportErr.removeAttribute('role')\n    }\n    if (inputField) {\n      inputField.classList.add('has-error')\n    }\n    if (submitBtn) {\n      submitBtn.setAttribute('aria-disabled', true)\n      submitBtn.addEventListener('click', handleSubmitOrder)\n    }\n  }\n\n  function removeErr() {\n    if (cardSupportErr) {\n      cardSupportErr.innerText = ''\n      cardSupportErr.setAttribute('role', 'presentation')\n    }\n    if (inputField) {\n      inputField.classList.remove('has-error')\n    }\n    if (creditCardInput && cardSupportErr) {\n      creditCardInput.setAttribute('aria-describedby', cardSupportErr.id)\n    }\n    if (submitBtn) {\n      submitBtn.setAttribute('aria-disabled', false)\n      submitBtn.removeEventListener('click', handleSubmitOrder)\n    }\n  }\n}\n\nfunction handleSubmitOrder(e) {\n  e.preventDefault()\n  const creditCardInput = select('[name=\"card_number\"]')\n\n  if (creditCardInput) {\n    creditCardInput.focus()\n  }\n}\n\nexport default hilightCreditCard\n","import { cloneDeep } from \"lodash\";\nimport * as xhr from \"modules/fetch\";\nimport pageTitle from \"modules/pageTitle\";\nimport popin from \"modules/popin\";\nimport { CHECK_RESPONSE, Manager, OPC_STEP_PROCESS, PAGELOAD_WISHLIST, REMOVE_ERROR, TRACKING_HIT } from \"lib/events\";\nimport bind from \"delegate\";\nimport config from \"lib/config\";\nimport inert from \"lib/inert\";\nimport List from \"./list\";\nimport { Promocode, PromocodeToggle } from \"./promocode\";\nimport addressValidation from \"./address-validation\";\nimport ChangeCountry from \"./change-country\";\nimport hilightCreditCard from \"./hilight-credit-card\";\nimport toggleFormAction from \"./toggle-formaction\";\nimport popinResetPassword from \"../account/popinResetPassword\";\nimport popinMergeDecision from \"../account/popinMergeDecision\";\nimport preferenceSetting from \"../account/preference-setting\";\nimport { getCollection, select, selectAll } from \"lib/selectors\";\nimport deliveryMethodCalendar from \"./delivery-method-calender\";\nimport \"lib/helpers/fit-text\";\nimport { addToJson, applePayIsSupported, focusElement, handlePopState, isLocalStorage, isMobileScreen, isWideScreen, isSafari, initGoogleMap, trimNumber, getOS, isTabletScreen, isWeChatBrowser } from \"lib/helpers\";\nimport initApplePayOPCManager from \"./applePayOPCManager\";\nimport zipCodeVariation from \"../account/zip-code-variation\";\nimport { sha256 } from \"js-sha256\";\nimport * as MobilePhoneValidation from \"../../config/mobile-phone-validation\";\nimport initToshiDetails from \"../../modules/toshi-module\";\nimport initThreeDS2Popin from \"./threeDS2-popin\";\nimport { read as readCookie } from \"modules/cookie\";\nimport { pushCheckoutMonetateData } from \"../../ui/monetate\";\nimport sidePanel from 'modules/sidepanel';\nimport notifier from 'modules/notifier';\n/* eslint-disable consistent-return */\n\nconst GIGYA_WRAPPER_ID = \"gigya-wrapper\";\nconst HIDDEN_CLASSNAME = \"is-hidden\";\nconst DISABLED_FIELDS = [\"card_cvn\", \"card_number\"];\nconst DISABLED_FIELDS_GMO = [\"card_cvn\", \"tokennumber\", \"card_number\"];\nconst GUEST_EMAIL = \"guest-email\";\nconst LOGIN_EMAIL = \"login-email\";\nconst EMPLOYEE_SAVINGS = \".js-employee-savings\";\nconst SHIPPING_ADDRESS_FORM_SELECTOR = \"form[id=addressForm]\";\nconst DIALOG_WRONG_ADDRESS_ISCORRECT_BUTTON_SELECTOR = \"button.is-tertiary.js-popin-close\";\nconst gigyaRegisterForm = select(\"#gigya-register-form\");\nconst ADDRESS_TOWN_MOBILE_SELECTOR = \".js-address-line1\";\nconst ADDRESS_MOBILE_SELECTOR = \".js-autocomplete-mobile\";\nconst EXPERIAN_AUTOCOMPLETE_SELECTOR = \".experian-autocomplete\";\nconst PRECISELY_AUTOCOMPLETE_SELECTOR = \".precisely-autocomplete\";\nconst COUNTRY_SELECTED = config.country.toLowerCase()\nconst countryCodes = {gb:\"+44 (GB)\", ca:\"+1 (CA)\"} \nlet dataLayerProductData;\nlet deliveryCalendar =\"\";\nlet isMobile = isMobileScreen();\nlet isSendDataToLoggedInUser = false;\nlet paymentSubmitted = false;\nlet newForm = null\n\nconst countryCode = countryCodes[COUNTRY_SELECTED]\n\nfunction OPC(el) {\n  if (config.country.toUpperCase() === 'CN') {\n    import('../account/cn-address').then((module) => {\n      module.default.init()\n    })\n    import(/* webpackChunkName: \"chinaPaymentFlow\" */'./china-payment').then((module) => {\n      module.default.init()\n    })\n  }\n  const steps = {\n    step1: {\n      el: el.querySelector(\".step1\"),\n    },\n    step2: {\n      el: el.querySelector(\".step2\"),\n    },\n    step3: {\n      el: el.querySelector(\".step3\"),\n    },\n    cart_data: {\n      el: el.querySelector(\".cart-product-list\"),\n    },\n    cart_total: {\n      el: el.querySelector(\".cart-prices\"),\n    },\n    cart_wrapping: {\n      el: el.querySelector(\".cart-wrapping\"),\n    },\n    gift_message: {\n      el: el.querySelector(\".cart-gift-message\"),\n    },\n    payment_modes_opc: {\n      el: el.querySelector(\".payment-modes-opc\"),\n    },\n  };\n\n  const formErrorMapping = {\n    'gigya-register-form':'REGISTER',\n    'gigya-login-form' : 'LOGIN',\n    'chanelGuestForm':'Guest LOGIN',\n    'addressForm' : 'SHIPPING',\n    'applyVoucherForm' : 'SHIPPING',\n    'selectDeliveryMethodForm':'Delivery methods (SHIPPING)',\n    'sopPaymentDetailsForm':'BILLING'\n  }\n\n  let guestEmail = \"\";\n  let loginEmail = \"\";\n\n  function enableSubmitBtns() {\n    selectAll(\".js-disabled-btn\").forEach((btn) => {\n      btn.removeAttribute(\"disabled\");\n      btn.classList.remove(\"disabled-btn\");\n    });\n  }\n\n  toggleFormAction(el);\n\n  /* let expiringCheckoutTimestamp = readCookie('expiringCheckoutTimestamp')\n  const checkoutStockReserveTimerEl = el.querySelector('.js-timer')\n  if (checkoutStockReserveTimerEl) {\n    const checkoutStockReserveTimer = checkoutStockReserveTimerEl.getAttribute('data-timer')\n    if (!expiringCheckoutTimestamp || readCookie('lastVisitedPage') !== window.location.href) {\n      expiringCheckoutTimestamp = Date.now() + parseInt(checkoutStockReserveTimer, 10)\n      document.cookie = `expiringCheckoutTimestamp=${expiringCheckoutTimestamp}`\n      document.cookie = `lastVisitedPage=${window.location.href}`\n    }\n  } */\n\n  // startTimer()\n  const popinResetPasswordHandler = popinResetPassword();\n  const popinMergeDecisionHandler = popinMergeDecision();\n\n  /* function startTimer() {\n    if (!checkoutStockReserveTimerEl) {\n      return\n    }\n    setTimeout(() => {\n      displayTimeoutAlert()\n    }, expiringCheckoutTimestamp - Date.now())\n  }\n  function displayTimeoutAlert() {\n    removeCookie('expiringCheckoutTimestamp')\n    stockReleaseRequest()\n  }\n  function stockReleaseRequest() {\n    xhr.get(config.webservices.checkout.stockRelease)\n      .then(data => displayError(data))\n      .catch(data => {\n        if (data.statusCode === 422) {\n          displayError(data)\n        } else {\n          console.error(data)\n        }\n      })\n  }\n  function stockReleaseBeforeUnload() {\n    stockReleaseRequest()\n  } */\n  let currentTrackingStep;\n\n  var isCncDeliveryMode = typeof isCncDeliveryModeSelected === 'undefined' ? false : isCncDeliveryModeSelected;\n\n  function animateStep({ step, newStep, newHeight, done }) {\n    const revealNewStep = () => {\n      step.el.innerHTML = newStep.innerHTML;\n      Manager.publish(\"bindDom\", step.el);\n\n      if (!step.el.children[1]) {\n        return;\n      }\n      TweenLite.fromTo(\n        step.el.children[1],\n        0.2,\n        {\n          opacity: 0,\n        },\n        {\n          opacity: 1,\n          onComplete: () => {\n            TweenLite.set(step.el.children[1], { clearProps: \"all\" });\n          },\n        }\n      );\n    };\n\n    TweenLite.fromTo(\n      step.el,\n      0.5,\n      {\n        css: {\n          height: step.height,\n        },\n      },\n      {\n        css: {\n          height: newHeight,\n        },\n        onComplete: () => {\n          TweenLite.set(step.el, { clearProps: \"all\" });\n          step.el.removeAttribute(\"style\");\n          done();\n        },\n      }\n    );\n\n    if (step.el.children[1]) {\n      TweenLite.to(step.el.children[1], 0.2, {\n        css: {\n          opacity: 0,\n        },\n        onComplete: revealNewStep,\n      });\n    } else {\n      revealNewStep();\n    }\n    zipCodeVariation();\n    updateInputs();\n  }\n\n  function bindSelectionItems() {\n    List(el);\n    window.addEventListener(\"DOMContentLoaded\", initGoogleMap())\n  }\n\n\n  function displayError(data, form) {\n    if (form) {\n      if (Object.keys(formErrorMapping).includes(form.id)) {\n        dataLayer.push({\n          'eventCategory': formErrorMapping[form.id],\n          'eventAction': 'error',\n          'eventLabel': 'responseError_' + form.id,\n          'event': 'nievent'\n        })\n      }\n    }\n\n    if (data.modal && form) {\n      addressValidation.display({\n        html: data.modal,\n        modifiers: 'adress-validation',\n        outerClose: false,\n        form,\n        opener: form.querySelector('[type=\"submit\"]'),\n        validCallback: () => {\n          submitStepForm(form);\n        },\n      });\n    } else if (data.modal && !form) {\n      popin\n        .open({\n          label: data.label,\n          html: data.modal,\n          role: \"dialog\",\n          opener: null,\n          manageFocus: false,\n          forceInert: true,\n          outerClose: false,\n          modal: true,\n        })\n        .then((modal) => {\n          const message = modal.el.querySelector(\"p\");\n          if (message) {\n            focusElement(message);\n          }\n        });\n    } else if (!data.fields && !data.formError) {\n      const input = select(\"[data-phone-pattern]\");\n      if (!isCncDeliveryMode && input.value == \"\") {\n          MobilePhoneValidation.sampleErrorMsg(input);\n      } else if (data.resultCode !== \"000\") {\n        const payload = {\n          data: { formError: window.config.locales.errors.form.global.billing.base },\n          form: form,\n        };\n        Manager.publish(CHECK_RESPONSE, payload);\n      } else {\n        console.error(\"Something went wrong with the request\", data);\n      }\n    } else if (data.fields) {\n      const payload = {\n        data: data,\n        form: form,\n      };\n      Manager.publish(CHECK_RESPONSE, payload);\n    }\n\n    return data;\n  }\n\n  function enableAllElements(form) {\n    Array.prototype.forEach.call(form.elements, (element) => {\n      element.removeAttribute(\"disabled\");\n    });\n  }\n\n  if (gigyaRegisterForm) {\n    preferenceSetting(el);\n  }\n\n  function focusInteractiveStep(container) {\n    if (!container) {\n      const stepForm = el.querySelector(\"form\");\n      let step;\n\n      if (stepForm) {\n        step = stepForm.closest(\"[class^=step]\");\n        step ? (container = step.querySelector(`.js-step-display:not(.${HIDDEN_CLASSNAME})`)) : (container = null);\n\n        if (!container) {\n          container = step;\n        }\n      }\n    }\n\n    if (container) {\n      const heading = container.querySelector(\".heading\");\n      const POSElementHeading = container.querySelector(\".POSElementHeading\");\n      const focusFirstErrorElement = select('input[aria-describedby=\"addressError\"]');\n      const boutiqueName = container.querySelector(\".selectedBoutiqueName\");\n\n      if (heading) {\n        focusElement(heading);\n        if (POSElementHeading) {\n          focusElement(POSElementHeading);\n        }\n        if (focusFirstErrorElement) {\n          focusElement(focusFirstErrorElement);\n        }\n        if (boutiqueName) {\n          focusElement(boutiqueName);\n        }\n        return heading;\n      }\n    }\n\n    return null;\n  }\n\n  function handleBillingAddressForm(e) {\n    const checkbox = e.delegateTarget;\n    const show = !checkbox.checked;\n    const formFieldset = document.getElementById(checkbox.dataset.formToggleDisplay);\n\n    if (!formFieldset) {\n      return;\n    }\n    checkbox.setAttribute(\"checked\", !show);\n    const setUseDeliveryAddressEl = select(\"#useDeliveryAddress\");\n    if (setUseDeliveryAddressEl) {\n      setUseDeliveryAddressEl.removeAttribute(\"required\");\n      setUseDeliveryAddressEl.setAttribute(\"aria-required\", false);\n    }\n    const setBillToBusinessAddressEl = select(\"#billToBusinessAddress\");\n    if (setBillToBusinessAddressEl) {\n      setBillToBusinessAddressEl.removeAttribute(\"required\");\n      setBillToBusinessAddressEl.setAttribute(\"aria-required\", false);\n    }\n    const setAddressLine2 = select('input[name=\"billTo_street2\"]');\n    if (setAddressLine2) {\n      setAddressLine2.removeAttribute(\"required\");\n      setAddressLine2.setAttribute(\"aria-required\", false);\n    }\n\n    enableSubmitBtns();\n    // we add custom event triggering the country change and emptying the address fields\n    const COUNTRY_SELECT = '.is-myaccount-select > select[name=\"countryIso\"]';\n    const selectorCountry = select(COUNTRY_SELECT, document.body);\n    const dispatchCapAddress = new window.CustomEvent(\"change\", {\n      detail: { isOpc: true },\n    });\n\n    Array.prototype.forEach.call(formFieldset.querySelectorAll(\"input, select, textarea\"), (field) => {\n      let type = field.tagName === \"SELECT\" ? \"select\" : \"input\";\n      let name = field.name;\n      if (field.tagName === \"INPUT\") {\n        type = field.type;\n      }\n\n      // store and remove the current value of the fields so the user can add its own\n      if (show) {\n        if ((config.country.toLowerCase() === \"gb\" || config.country.toLowerCase() === \"ru\") && (field.id === \"address.line1-mobile\")) {\n          let addValue = select(`${ADDRESS_MOBILE_SELECTOR} button${ADDRESS_TOWN_MOBILE_SELECTOR} span.js-button-value`);\n          let emptyAddressContainer = select(`${EXPERIAN_AUTOCOMPLETE_SELECTOR, PRECISELY_AUTOCOMPLETE_SELECTOR}`);\n          if (addValue) {\n            addValue.innerHTML = \"\";\n          }\n          field.setAttribute(\"aria-required\", \"true\");\n          field.setAttribute(\"ariaRequired\", \"true\");\n          if (emptyAddressContainer) {\n            if (emptyAddressContainer.classList.contains(\"has-content\") && field.value === \"\") {\n              emptyAddressContainer.classList.remove(\"has-content\");\n            }\n          }\n          if (getOS() == \"iOS\") {\n            const checkbox = select('input[id=\"useDeliveryAddressEU\"]');\n            checkbox ? focusElement(checkbox, { notChangeTabIndex: true }) : \"\";\n          }\n        }\n\n        if ((type === \"checkbox\" || type === \"radio\") && name !== \"addressId\") {\n          field.data(\"checked\", field.checked);\n          field.checked = false;\n        } else {\n          if (field.id !== \"address.line2\") {\n            field.setAttribute(\"required\", true);\n            field.setAttribute(\"aria-required\", true);\n          }\n          if(config.country.toLowerCase() === \"ru\") {\n              if(field.id === \"address.complemenatry\") {\n                field.removeAttribute('required');\n                field.removeAttribute('aria-required');\n              }\n              if(field.id === \"address.postcode\") {\n                field.removeAttribute('required');\n\t\t            field.removeAttribute('aria-required');\n\t\t           }\n          }\n          if (\n            field.id !== \"bill_to_address_country\" &&\n            field.id !== \"address.countryIso\" &&\n            field.id !== \"add-address-countryCode-screens\" &&\n            field.id !== \"phoneCountryCodeHidden\" &&\n            name !== \"addressId\" &&\n            field.id !== \"countryIso\"\n          ) {\n            field.value = field.data(\"value\", field.value) || \"\";\n          }\n          if(config.country.toLowerCase() === \"ca\" && field.id === \"address.phone\") {\n            removeRequiredAttribute(field)\n          }\n        }\n      } else if ((type === \"checkbox\" || type === \"radio\") && name !== \"addressId\") {\n        field.checked = field.data(\"checked\") || false;\n        field.data(\"checked\", \"\");\n        type === \"radio\" ? (field.checked = false) : null;\n      } else {\n        field.removeAttribute(\"required\");\n        field.setAttribute(\"aria-required\", false);\n        if (\n          field.id !== \"bill_to_address_country\" &&\n          field.id !== \"address.countryIso\" &&\n          field.id !== \"add-address-countryCode-screens\" &&\n          field.id !== \"phoneCountryCodeHidden\" &&\n          name !== \"addressId\" &&\n          field.id !== \"countryIso\"\n        ) {\n          field.value = field.data(\"value\", field.value) || \"\";\n        }\n      }\n\n      //Setting default country code for GB\n      if ((config.country.toLowerCase() === \"gb\" || config.country.toLowerCase() === \"ca\") && field.id === \"pos_countryCode\") {\n        let phoneCCodeEle = select(\"span\", select(\".selectbox__wrapper.phone_selectbox\"));\n        let countryCodeOpcEle = select(\"#pos_countryCode\");\n        let countryCodesOption = getCollection(\"#pos_countryCode option\");\n        if (phoneCCodeEle) {\n          phoneCCodeEle.innerHTML = countryCode;\n          countryCodeOpcEle.parentElement.classList.add(\"has-content\");\n          countryCodeOpcEle.parentElement.parentElement.classList.add(\"has-content\");\n          phoneCCodeEle.classList.add(\"is-focusable\");\n          countryCodeOpcEle.classList.add(\"has-content\");\n        }\n        countryCodesOption.forEach((code, index) => {\n          var att = document.createAttribute(\"selected\");\n          att.value = \"selected\";\n          if (code.innerHTML == countryCode) {\n            code.setAttributeNode(att);\n            countryCodeOpcEle.selectedIndex = index;\n          } else {\n            code.removeAttribute(\"selected\");\n          }\n        });\n      }\n    });\n  }\n\n  function removeRequiredAttribute(field){\n    field.removeAttribute('required')\n    field.removeAttribute('aria-required')\n  }\n\n  function handleFinalStep(form) {\n    const signature = form.elements.signature;\n    const pspProvider = form.elements.pspProvider;\n    const hasSignature = signature && !signature.disabled;\n    if (pspProvider && pspProvider.value === \"GMO\" && hasSignature) {\n      const cardno = document.getElementById(\"cardNumber\").value;\n      let expiryMonth = document.getElementById(\"expiration-month\").value;\n      const ExpiryYear = document.getElementById(\"expiration-year\").value;\n      if (expiryMonth.length === 1) {\n        expiryMonth = `0${expiryMonth}`;\n      }\n      const securitycode = document.getElementById(\"card_cvn\").value;\n      const holdername = document.getElementById(\"card_nameOnCard\").value;\n      const tokennumber = document.getElementById(\"tokennumber\").value;\n      const apiKey = config.webservices.gmo.apiKey;\n      window.Multipayment.init(apiKey);\n\n      const disableFieldsBeforeSend = () => {\n        DISABLED_FIELDS_GMO.forEach((name) => {\n          const field = form.elements[name];\n          if (field) {\n            field.removeAttribute(\"name\");\n          }\n        });\n      };\n      let max = Math.ceil(tokennumber / 10);\n      let tokens = [];\n      let i = 1;\n      let callGmoWithLoop = (iterator) => {\n        let tokensNumber = 10;\n        const count = i * 10;\n        if (count > tokennumber) {\n          tokensNumber = tokennumber % 10;\n        }\n        window.Multipayment.getToken({ cardno, expire: `${ExpiryYear}${expiryMonth}`, securitycode, holdername, tokennumber: tokensNumber }, (response) => {\n          if (response.resultCode !== \"000\") {\n            displayError(response, form);\n          } else {\n            tokens.push(response.tokenObject.token);\n            if (i == iterator) {\n              document.getElementById(\"gmoTokens\").value = tokens.join();\n              document.getElementById(\"maskedCardNo\").value = cardno.substr(cardno.length - 4);\n\n              disableFieldsBeforeSend();\n              form.submit();\n              // disabled submit button after order placed\n              buttonClick(form);\n            } else {\n              i++;\n              callGmoWithLoop(iterator);\n            }\n          }\n        });\n      };\n\n      callGmoWithLoop(max);\n    } else {\n      if (paymentSubmitted) {\n        return;\n      }\n      paymentSubmitted = true;\n      if (pspProvider !== undefined && (pspProvider.value === \"Adyen\" || hasSignature)) {\n        // Prevent sending All elements when PayPal selected\n        // enable hidden billing address if the address is set to use the same address\n        enableAllElements(form);\n\n        if (signature.value) {\n          return;\n        }\n\n        selectAll(\".label-input__input\", form).forEach((inputField) => {\n          inputField.value = inputField.value.trim();\n        });\n        //      For ADYEN\n        if (document.getElementById(\"pspProvider\").value === \"Adyen\") {\n          var options = {};\n          options.fieldNameAttribute = \"data-encrypted-name\";\n          options.enableValidations = false;\n          var cseEncryptedForm = window.adyen.createEncryptedForm(form, options);\n          var encryptedToken = cseEncryptedForm.encrypt();\n          if (encryptedToken !== null) {\n            document.getElementById(\"encryptedCardToken\").value = encryptedToken;\n          }\n        }\n        //      For CyberSource\n        else if (document.getElementById(\"pspProvider\").value === \"CyberSource\") {\n          const paymentUrl = form.action;\n          form.action = config.webservices.cybersource;\n\n          const disabledFields = DISABLED_FIELDS.map((name) => {\n            const field = form.elements[name];\n            if (!field) {\n              return;\n            }\n            field.data(\"name\", field.name);\n            field.removeAttribute(\"name\");\n            return field;\n          }).filter(Boolean);\n\n          xhr\n            .submit(form, { type: \"text\" })\n            .then((data) => {\n              disabledFields.forEach((input) => {\n                input.setAttribute(\"name\", input.data(\"name\"));\n              });\n\n              form.setAttribute(\"action\", paymentUrl);\n              signature.setAttribute(\"value\", data);\n\n              let expiryMonth = document.getElementById(\"expiration-month\").value;\n              const ExpiryYear = document.getElementById(\"expiration-year\").value;\n              if (expiryMonth.length === 1) {\n                expiryMonth = `0${expiryMonth}`;\n              }\n\n              const expiryField = form.elements.card_expiry_date;\n              if (expiryField) {\n                expiryField.value = `${expiryMonth}-${ExpiryYear}`;\n              }\n\n              // remove disabled attribute on billing address\n              const billingAddress = document.getElementById(\"billing-address\");\n              if (form.contains(billingAddress)) {\n                Array.from(billingAddress.querySelectorAll(\"[disabled]\")).forEach((input) => {\n                  if (input.dataset.keepDisabled) {\n                    return;\n                  }\n                  input.removeAttribute(\"disabled\");\n                });\n              }\n              form.submit();\n            })\n            .catch((data) => displayError(data, form));\n          return;\n        }\n      }\n\n      form.submit();\n      // disabled submit button after order placed\n      buttonClick(form);\n    }\n  }\n\n  function handleGigyaLogin(args) {\n    if (args.context !== 'checkout') return\n\n    let data = args.loginData;\n    \n    // tell the server where we're calling from\n    data.loginFrom = \"checkout\";\n    const url = `${window.location.origin}${config.webservices.account.loginUrl}?forcePassword=${data.forcePassword}`;\n    /**\n     * If password must be updated a forcePassword=true has been sent to Gigya\n     *    => that mean user has been flaged to update their credentials\n     *    => the user has been logout and redirected to checkout to update password\n     * else\n     *    => user follow the standard OPC steps (login, shipping, billing, confirmation)\n     */\n    if (data.forcePassword) {\n      const form = document.createElement(\"form\");\n      form.action = `${url}`;\n      form.method = \"POST\";\n      form.className = \"is-hidden\";\n      Object.keys(data).forEach((key) => {\n        form.insertAdjacentHTML(\"beforeend\", `<input type=\"hidden\" name=\"${key}\" value=\"${data[key]}\"/>`);\n      });\n      document.body.appendChild(form);\n      form.submit();\n    } else {\n      xhr\n        .post(url, { data })\n        .then(handleStepResponse)\n        .then((data) => {\n        \tif (data && data.stockSuccess === false) {\n\t          window.location.replace(window.config.webservices.cart.cartUrl);\n\t          return;\n\t        }\n        })\n        .then(updateMobileBurgerMenu)\n        .then(disableSamplesBlock)\n        .then((response) => {\n          trackPageview(response, `${window.location.pathname}/shipping`);\n          select(\".is-total .js-cart-price-subtotal\", el).innerText = response.parts.subTotal;\n          return response;\n        })\n        .catch(config.noop);\n    }\n  }\n\n  function handleGigyaNotifyLogin(data) {\n    data.loginFrom = \"checkout\"\n\n    const url = `${window.location.origin}${config.webservices.account.notifyLoginUrl}`\n    xhr\n      .post(url, { data })\n      .then(handleStepResponse)\n      .then(updateMobileBurgerMenu)\n      .then(disableSamplesBlock)\n      .then((response) => {\n        trackPageview(response, `${window.location.pathname}/shipping`);\n        select(\".is-total .js-cart-price-subtotal\", el).innerText = response.parts.subTotal;\n        return response;\n      })\n      .catch(config.noop);\n  }\n\n  async function getUpdatedCartProductData(gtmData, currentStep) {\n    dataLayerProductData = await xhr.get(window.config.webservices.dynamicDlCheckoutYapi).then(pushUpdatedCartData);\n     if(!(isSendDataToLoggedInUser && currentStep == 1)) {\n      gtmData.ecommerce.checkout = {\n        actionField: { step: currentStep },\n        products: dataLayerProductData.ecommerce.products,\n      };\n      Manager.publish(TRACKING_HIT, gtmData);\n    }\n  }\n\n  function pushUpdatedCartData(data) {\n    const gtmData = cloneDeep(data);\n    let ecom = {};\n    Object.keys(gtmData.pageLoad).forEach(function (val) {\n      addToJson(val, gtmData.pageLoad[val], ecom);\n    });\n\n    return cloneDeep(ecom);\n  }\n\n  function handleSubmit(e) {\n    const form = e.delegateTarget;\n    newForm = form\n    let isFormValid = form.checkValidity()\n    if(!isFormValid) {\n      if(Object.keys(formErrorMapping).includes(form.id)) {\n        dataLayer.push({\n          'eventCategory': formErrorMapping[form.id],\n          'eventAction': 'error',\n          'eventLabel': 'invalidInputs_'+ form.id,\n          'event': 'nievent'\n        })\n      }\n    }\n    if(form.id === 'billingAddressForm') {\n      dataLayer.push({\n        'eventCategory': 'checkout',\n        'eventAction': 'click',\n        'eventLabel': 'proceed to payment',\n        'event': 'uaevent'\n      })\n    }\n    const gEmailElm = select(`#${GUEST_EMAIL}`);\n    const lEmailElm = select(`#${LOGIN_EMAIL}`);\n    const cardNumberErr = select(\".js-cardNumber-error\");\n    const selectedPosEle = select('input[name=\"posName\"]') ? select('input[name=\"posName\"]') : select('input[name=\"posNameCheckout\"]');\n    const selectedPosId = select('input[name=\"posName\"]:checked') ? select('input[name=\"posName\"]:checked') : select('input[name=\"posNameCheckout\"]:checked');\n    const giftCardEl = select(\"#payment-giftcard:checked\");\n    const giftCardNumberEl = select(\"#giftCardNumber\");\n    const giftCardCvnEl = select(\"#giftCardCvn\");\n    const selectedInput = select('input[name=\"addressId\"]:checked');\n    const billingCheckboxEU = select('input[id=\"useDeliveryAddressEU\"]:checked');\n    if ((window.config.country == \"GB\" || window.config.country == \"CA\")  && form.elements[\"data.userPhones[0].number\"]) {\n      if (form.elements[\"data.userPhones[0].number\"].value != null && form.elements[\"data.userPhones[0].number\"].value != '') {\n        form.elements[\"data.userPhones[0].number\"].value = form.elements[\"data.userPhones[0].number\"].value.trim();\n      }\n    }\n\n    if (giftCardEl && giftCardNumberEl && giftCardCvnEl) {\n      updateGiftCardList(e);\n      return;\n    }\n\n    if (!billingCheckboxEU) {\n      const selectedRadio = select('input[name=\"addressId\"]:checked');\n       if (selectedRadio) {\n        const selectedAddress = selectedInput.closest(\"div\");\n        const addressError = select('p[id=\"addressError\"]', selectedAddress);\n        if (addressError) {\n          e.preventDefault();\n          return;\n        }\n      }\n    }\n\n    if (isLocalStorage() === true) {\n      // Guest case\n      if (gEmailElm && !gEmailElm.disabled) {\n        guestEmail = gEmailElm.value;\n        window.localStorage.setItem(\"lastUsedEmail\", gEmailElm.value);\n        if (guestEmail) {\n          window.localStorage.setItem(\"isGuestUser\", true);\n        }\n      }\n\n      // Login case\n      if (lEmailElm && !lEmailElm.disabled) {\n        loginEmail = lEmailElm.value;\n        window.localStorage.setItem(\"loginEmail\", lEmailElm.value);\n        if (loginEmail) {\n          window.localStorage.setItem(\"isGuestUser\", false);\n        }\n      }\n    }\n    // if no pos is selected and user clicks enter\n    if (selectedPosEle && !selectedPosId && form.id === \"posForm\") {\n      e.preventDefault();\n      return;\n    }\n\n    if (form.id === \"selectDeliveryMethodForm\") {\n      let toshiFlag = toshiDeliveryMode(form);\n      if (toshiFlag) {\n        e.preventDefault();\n        return;\n      }\n    }\n\n    if (form.id === \"otpValidate\") {\n      return\n    }\n    if (form.id === \"registerPhone\") {\n      return\n    }\n    if (form.id === \"cnPlaceOrderForm\") {\n      return\n    }\n    if (form.id === \"notificationSubscriptionForm\") {\n      e.preventDefault();\n      handleSMSNotification(form);\n      return;\n    }\n    if (form.id === \"notificationUnSubscriptionForm\") {\n      e.preventDefault();\n      handleUnsubscribe(form);\n      return;\n    }\n    if (form.id === \"\")\n      if (cardNumberErr && cardNumberErr.innerText) {\n        cardNumberErr.removeAttribute(\"role\");\n      }\n\tif (form.id === \"gigya-register-form\") {\n      const registrationForm = select('form.gigya-register-form')\n      const consentList = select('ul.consent-checkbox', registrationForm)\n      const defaultMsg = selectAll('p[class=\"error\"]', consentList)\n      if (defaultMsg) {\n        defaultMsg.forEach((element) => {\n      \t element.remove()\n        })\n      }\n    }\n    let deliveryContainer = select('.highlightShippingNode',form)\n\tlet deliveryCalendarDate = select(\".delivery-method-calendar\",deliveryContainer)\n\tif(deliveryCalendarDate){\n\t\tlet dateControl = select('.js-select-date-input',deliveryCalendarDate)\n\t\tlet deliveryDateStatus = deliveryCalendar.checkDateRange(dateControl)\n\t\tif(deliveryDateStatus){\n\t\t\tselect(\".delivery_slot_date\",form).value = deliveryDateStatus\n\t\t}else{\n\t\t\te.preventDefault()\n\t\t\treturn false\n\t\t}\n\t}\n    // dont post in ajax if the form has errors\n    // or if the form needs to be posted without ajax\n\n    if (form.hasAttribute(\"data-http-form\") || form.classList.contains(\"gigya-form\")) {\n      isSendDataToLoggedInUser = true\n      return\n    }\n\n    const invalidFields = form.invalid.filter((invalidItem) => !invalidItem.el.hasAttribute(\"disabled\"))\n    if (invalidFields.length) {\n      return\n    }\n\n\n    e.preventDefault();\n\n    // on step 3\n    if (steps.step3.el.contains(form) && !form.classList.contains(\"address-form\")) {\n      handleFinalStep(form);\n      return;\n    }\n    const phoneNumber = select(\"[data-phone-pattern]\");\n    const checkbox = select('input[id=\"useDeliveryAddressEU\"]');\n    const isKR = config.country === \"KR\" ? true : false\n    if (!isKR && ((checkbox && !checkbox.checked) || !checkbox) && !selectedPosId && phoneNumber && !phoneNumber.dataset.mobileValidation && !phoneNumber.disabled && (phoneNumber.value!='')) {\n      MobilePhoneValidation.getUserNumber().then((isValid) => {\n        if (typeof isCncDeliveryMode !== 'undefined' && isCncDeliveryMode) {\n          addcncDeliveryAnalytics();\n        } else {\n          addDeliveryAnalytics();\n        }\n        submitStepForm(form);\n      });\n    } else {\n      if (typeof isCncDeliveryMode !== 'undefined' && isCncDeliveryMode) {\n        addcncDeliveryAnalytics();\n      } else {\n        addDeliveryAnalytics();\n      }\n      submitStepForm(form);\n    }\n  }\n\n  function submitStepForm(form) {\n    if (form.id === \"billingAddressForm\" || form.id === \"addressForm\") {\n      manageDataObj(form);\n    } else {\n      if (form.id === \"posForm\") {\n        countryCodeName();\n      }\n      xhr\n        .submit(form)\n        .then((data) => {\n          if (form.id === \"chanelGuestForm\") {\n            sendToDatalayer(data, form.action);\n          }\n          if (data.stockSuccess === false) {\n            window.location.replace(window.config.webservices.cart.cartUrl);\n            return;\n          }\n          processStep(data, form);\n        })\n        .catch((data) => {\n          //blocking guest cpf to go inside the function\n          if (form.id === \"chanelGuestForm\" && (data.fields[0] && data.fields[0].name !== 'guestCpf')){\n            sendToDatalayer(data, form.action);\n          }\n          displayError(data, form);\n        });\n    }\n  }\n\n  function processStep(responseData, form) {\n    return handleStepResponse(responseData)\n      .then((data) => {\n        Manager.publish(OPC_STEP_PROCESS, { step: data.stepNumber });\n\n        if (data.stepNumber === 3 && (form.id === 'selectDeliveryMethodForm' || form.id === 'posForm') && window.config.currentLocale !== '/us/') {\n          dataLayer.push({\n            'eventCategory': 'checkout',\n            'eventAction': 'display',\n            'eventLabel': 'proceed to payment',\n            'event': 'nievent'\n          })\n        }\n        return data;\n      })\n      .then((data) => {\n        if (data.parts.promocode) {\n          Promocode(data);\n          enableSubmitBtns();\n        }\n        return data;\n      })\n      .then((data) => {\n        trackPageview(data, form.action);\n        return data;\n      });\n  }\n\n  function trackPageview(data, nextPage) {\n    // dont send the page view when the step number is the same\n    if (data.success && data.dl.stepNumber === currentTrackingStep) {\n      return;\n    }\n\n    currentTrackingStep = data.dl.stepNumber;\n    sendToDatalayer(data, nextPage);\n    appliedFocusOnActiveForm();\n  }\n\n  /**\n   * call this to send a right data according step\n   * @param data\n   * @param nextPage\n   */\n  function sendToDatalayer(data, nextPage) {\n    const gtmData = cloneDeep(window.dataLayer[0]);\n    const pathPage = nextPage.split(\"/\");\n\n    if (isLocalStorage() === true) {\n      const isGuestUser = window.localStorage.getItem(\"isGuestUser\");\n      if (isGuestUser === \"true\") {\n        gtmData.funnel_type = \"guest\";\n      } else {\n        gtmData.funnel_type = \"customer login\";\n      }\n    }\n\n    gtmData.category = \"funnel\";\n    currentTrackingStep = data.dl.stepNumber;\n    switch (currentTrackingStep) {\n      case 0:\n        gtmData.cartValue = data.cartValueWithoutTax;\n        gtmData.checkoutStepName = \"Signing\";\n        gtmData.page = `${window.location.pathname}/login`;\n        gtmData.sub_category_level1 = \"Signing\";\n        break;\n      case 1:\n        gtmData.cartValue = data.cartValueWithoutTax;\n        gtmData.checkoutStepName = \"shipping\";\n        gtmData.page = `${window.location.pathname}/shipping`;\n        gtmData.sub_category_level1 = \"shipping\";\n        break;\n      case 2:\n        gtmData.checkoutStepName = \"billing\";\n        gtmData.cartValue = data.cartValueWithTax;\n        gtmData.page = `${window.location.pathname}/billing`;\n        gtmData.sub_category_level1 = \"billing\";\n        break;\n      default:\n        gtmData.checkoutStepName = \"billing\";\n        gtmData.cartValue = data.cartValueWithoutTax;\n        gtmData.page = pathPage.length ? `/${pathPage[pathPage.length - 1]}/${pathPage[pathPage.length - 2]}` : gtmData.page;\n        gtmData.sub_category_level1 = \"billing\";\n        break;\n    }\n    gtmData.event = \"virtualPageview\";\n    gtmData.checkoutStepNumber = currentTrackingStep;\n    gtmData.ecommerce.checkout = {\n      actionField: { step: currentTrackingStep },\n      products: gtmData.ecommerce.products,\n    };\n    delete gtmData.ecommerce.products;\n    if (isLocalStorage() === true) {\n      if (window.localStorage.getItem(\"loginEmail\")) {\n        if (config.country.toLowerCase() != \"us\") {\n          gtmData.userEmail = \"\";\n        } else {\n          gtmData.userEmail = window.localStorage.getItem(\"loginEmail\");\n        }\n        gtmData.email_sha256 = sha256(window.localStorage.getItem(\"loginEmail\"));\n      }\n      if (window.localStorage.getItem(\"lastUsedEmail\")) {\n        if (config.country.toLowerCase() != \"us\") {\n          gtmData.userEmail = \"\";\n        } else {\n          gtmData.userEmail = window.localStorage.getItem(\"lastUsedEmail\");\n        }\n        gtmData.email_sha256 = sha256(window.localStorage.getItem(\"lastUsedEmail\"));\n      }\n    }\n\n    getUpdatedCartProductData(gtmData, currentTrackingStep);\n  }\n  /**\n   * Return new object from Form data\n   */\n  function manageDataObj(form) {\n    const paramsData = {};\n    const inputs = getCollection(\"input, select\", form);\n    let isoCode;\n\n    // We add an exceptions for some fields that are required but don't have the required attribute\n    // as it would broke the accessibility to have required hidden fields\n    const namesToExclude = [\n      \"phoneCountryCode\",\n      \"addressId\",\n      \"countryIso\",\n      \"useDeliveryAddressEU\",\n      \"_useDeliveryAddressEU\",\n      \"qualityCode\",\n      \"skipValidation\",\n      \"_shippingToBusinessAddress\",\n      \"billingAddress\",\n      \"shippingAddress\",\n      \"line2\",\n      \"district\",\n      \"provincia\",\n      \"shippingToBusinessAddress\",\n      \"defaultAddress\",\n      \"municipality\",\n      \"village\",\n      \"addAddressToGigya\",\n      \"building\"\n    ];\n\n    if((config.country.toLowerCase() === \"ru\") || (config.country.toLowerCase() === \"cn\")){\n      namesToExclude.push(\"postcode\")\n    }\n\n    if(config.country.toLowerCase() === \"ca\") {\n      namesToExclude.push(\"phone\")\n    }\n\n    Array.from(inputs)\n      .filter((input) => input.required || namesToExclude.indexOf(input.name) !== -1)\n      .forEach((input) => {\n        // Then fill paramsData with inputs values that passed the filter\n        if (input.type === \"radio\" || input.type === \"checkbox\") {\n          if (input.name === \"addAddressToGigya\") {\n            input.value !== \"\" ? (paramsData[input.name] = input.value) : null;\n          } else {\n            input.checked === true ? (paramsData[input.name] = input.value) : null;\n          }\n        } else if (input.name === \"countryIso\") {\n          isoCode = input.value === \"LT\" ? input.value : null;\n          paramsData[input.name] = input.value;\n        } else if((config.country.toLowerCase() === \"cn\") && ((input.name === \"provincia\") || (input.name === \"district\") || (input.name === \"townCity\"))) {\n          paramsData[input.name] = input.selectedOptions[0].innerText;\n        } else if (input.name === \"postcode\") {\n          let isNotMobile = !isMobileScreen();\n          paramsData.countryIso === \"LT\" ? (input.value = input.value.replace(/[^0-9]/g, \"\")) : null;\n          paramsData[input.name] = isoCode ? `${isoCode}-${input.value}` : input.value;\n        } else {\n          input.value !== \"\" ? (paramsData[input.name] = input.value) : null;\n        }\n      });\n    xhr\n      .submit(form, { data: paramsData })\n      .then((data) => {\n        if (data.stockSuccess === false) {\n          window.location.replace(window.config.webservices.cart.cartUrl);\n          return;\n        }\n        processStep(data, form);\n      })\n      .catch((data) => {\n        displayError(data, form);\n      });\n  }\n\n\n  /**\n   * Create a get call to a different checkout step\n   * @param {object} e - user event\n   * @param {HTMLElement} button - the button that triggered the step back\n   */\n  function stepBack(e) {\n    const button = e.delegateTarget;\n    const step = button.dataset.step;\n    const formFocus = button.hasAttribute(\"data-step-focus\");\n    const checkPrivacy = select('input[name=\"termsSelection\"]');\n    const privacyErrorMsg = select(\".privacy-error-msg\");\n    const labelPrivacy = select('label[for=\"guest.termsSelection\"]');\n\n    if (checkPrivacy && !checkPrivacy.checked) {\n      if (!privacyErrorMsg && labelPrivacy) {\n        const pElem = document.createElement(\"p\");\n        const errorMsg = document.createTextNode(config.locales.errors.form.fields.valueMissing.privacy);\n\n        pElem.classList.add(\"error\", \"privacy-error-msg\");\n        pElem.appendChild(errorMsg);\n        labelPrivacy.appendChild(pElem);\n      }\n\n      return;\n    }\n\n    if (step.indexOf(\"editStep2Addresses\") !== -1) {\n      updateAnalyticsShippingOptions();\n    }\n    xhr\n      .get(step)\n      .then(updateSteps)\n      .then((data) => {\n        if (step.indexOf(\"editBillingAddressStep\") !== -1) {\n          const checkbox = select('input[id=\"useDeliveryAddressEU\"]', document.body);\n          if (checkbox) {\n            const formFieldset = document.getElementById(checkbox.dataset.formToggleDisplay);\n            const inputs = Array.from(formFieldset.querySelectorAll(\"input, select, textarea\"));\n            // set timeout to get the populated fields from back end\n            TweenLite.to(inputs, 0.1, {\n              onComplete: () => {\n                inputs\n                  .filter((input) => !input.hidden)\n                  .forEach((field) => {\n                    if (field.id !== \"address.line2\" && field.type !== \"checkbox\") {\n                      field.setAttribute(\"required\", true);\n                      field.setAttribute(\"aria-required\", true);\n                    }\n                    if(config.country.toLowerCase() === \"ru\") {\n                        if(field.id === \"address.complemenatry\") {\n                          field.removeAttribute('required');\n                          field.removeAttribute('aria-required');\n                        }\n                        if(field.id === \"address.postcode\") {\n\t\t                        field.removeAttribute('required');\n\t\t                        field.removeAttribute('aria-required');\n\t\t                     }\n                    }\n                     if(config.country.toLowerCase() === \"ru\" && field.id === \"address.complemenatry\"){\n                        field.removeAttribute('required');\n                        field.removeAttribute('aria-required');\n                      }\n                    if (field.dataset.phonePattern) {\n                      // adding custom event to trigger the update of the phone country code in order to get the right pattern\n                      const dispatchPhoneNumber = new window.CustomEvent(\"input\", {\n                        detail: { isOpc: true },\n                      });\n                      field.dispatchEvent(dispatchPhoneNumber);\n                    }\n                  });\n              },\n            });\n          }\n        }\n        editboutiqueLayerUpdate();\n        Manager.publish(OPC_STEP_PROCESS, { step: data.dl });\n        if (step.indexOf(\"guest\") !== -1) {\n          sendToDatalayer(data.data, step);\n        }\n        return data;\n      })\n      .then(() => manageStep1ScreenSwitch(\"checkout-guest-sign-in\"))\n      .then(() => {\n        enableSubmitBtns();\n        const form = el.querySelector(\"form input:not([disabled]):not([type=hidden]), form button:not([disabled]), form select:not([disabled]), form textarea:not([disabled])\");\n\n        var selectedPosId = select('input[name=\"posName\"]:checked');\n        if (selectedPosId) {\n          selectPOSNow(selectedPosId.getAttribute(\"id\"));\n        }\n\n        var preSelectedPOS = select('input[name=\"posGeoLocation\"]');\n        if (preSelectedPOS) {\n          const lat = preSelectedPOS.getAttribute(\"data-lat\");\n          const long = preSelectedPOS.getAttribute(\"data-lng\");\n          const id = preSelectedPOS.getAttribute(\"id\");\n          initializeMap(lat, long, id);\n        }\n\n        if (formFocus && form) {\n          zipCodeVariation();\n          updateInputs();\n          form.focus();\n          return;\n        }\n\n        updatePageTitle(focusInteractiveStep());\n        loadMaponEditBoutique();\n        return;\n      })\n      .then(() => {\n        if (select(\"#selectDeliveryMethodForm\")) {\n          shippingOptionHighlight();\n        }\n        deliveryCalendar = new deliveryMethodCalendar();\n      })\n      .catch((data) => displayError(data));\n  }\n\n  function updatePageTitle(heading) {\n    const stepDivElm = select(\"[data-opc-step]\");\n\n    if (!heading || !heading.firstElementChild) {\n      if (stepDivElm) {\n        const stepName = stepDivElm.getAttribute(\"data-opc-step-title\");\n        if (stepName) {\n          pageTitle(stepName);\n        }\n      } else {\n        return;\n      }\n    } else {\n      const headingTextEle = select(\"span\", heading);\n      if (headingTextEle) {\n        const headingText = headingTextEle.innerText;\n        pageTitle(headingText);\n      }\n    }\n  }\n\n  function updateSteps(data) {\n    //Monetate\n    try {\n      if (data && data.dl && data.dl.stepName) {\n        pushCheckoutMonetateData(data.dl.stepName.toLowerCase());\n      }\n      if (newForm && select( `button[id=continueToShippingOptions]`,newForm.parentNode)) {\n        pushCheckoutMonetateData('delivery')\n        newForm = null\n      }\n      if (newForm && select( `button.js-add-edit-address-save`,newForm.parentNode)){\n        pushCheckoutMonetateData('payment')\n        newForm = null\n      }\n    } catch (error) {\n      console.error(error);\n    }\n\n    if (data && data.dl && data.dl.stepName && data.dl.stepName === 'SHIPPING'\n            && data.reviewCart && data.reviewCart === true) {\n      window.location.replace(window.config.webservices.cart.cartUrl);\n      return;\n    }\n\n    sendShippingDataToDatalayer();\n    if (data.parts) {\n      const replaceSteps = Object.keys(data.parts).map((step) => {\n        const currentStep = steps[step];\n        if (!currentStep || !currentStep.el) {\n          return;\n        }\n        const newStep = document.createElement(\"div\");\n\n        if (!currentStep.height) {\n          currentStep.height = currentStep.el.clientHeight;\n        }\n\n        newStep.innerHTML = data.parts[step];\n        // look for a potential form to be posted with http\n        const httpForm = newStep.querySelector('form[data-http-form=\"immediate\"]');\n\n        // append the new step to get its height\n        currentStep.el.appendChild(newStep);\n\n        // if the newStep has a form to post using http not ajax\n        // submit it while its in the dom\n        if (httpForm) {\n          httpForm.submit();\n          return Promise.resolve();\n        }\n\n        const newHeight = newStep.clientHeight;\n\n        currentStep.el.removeChild(newStep);\n\n        // replace without transition if the step has the same height\n        if (currentStep.height === newHeight) {\n          currentStep.el.innerHTML = newStep.innerHTML;\n\n          return Promise.resolve();\n        }\n\n        return new Promise((done) => {\n          animateStep({\n            step: currentStep,\n            newStep,\n            newHeight,\n            done,\n          });\n\n          currentStep.height = newHeight;\n\n          if (currentStep.el.classList.contains(\"step3\")) {\n            const label = select(\".billing-radio-buttons .creditCard label\");\n            label && window.fitText(label);\n          }\n        });\n      });\n\n      return Promise.all(replaceSteps).then((values) => {\n        return { data, promises: values };\n      });\n    }\n  }\n\n  function handleStepResponse(data) {\n    enableSubmitBtns();\n    const activationPopup = select('[id=\"account-deactivated-screen\"]')\n    if (activationPopup) {\n      if (document.body.classList.contains('has-modal')) {\n  \t    document.body.classList.remove('has-modal')\n  \t  }\n      window.gigya.accounts.hideScreenSet({\n          screenSet: 'account-deactivated'\n      })\n    }\n    popinMergeDecisionHandler.checkMergeCookie();\n    const COOKIE_KEY = \"cartMergeDecision\";\n    const WRAPPING_KEY = 'cartWrappingMergeDecision';\n    const promptMergeDecision = readCookie(COOKIE_KEY);\n    const promptMergeWrappingDecision = readCookie(WRAPPING_KEY);\n    data.parts.cart_wrapping = select(\"[class='cart-wrapping']\", el).innerHTML;\n    return updateSteps(data).then(() => {\n      if (promptMergeDecision == \"false\" || promptMergeWrappingDecision == 'false') {\n        const btnContinuetoShippingOptions = select(\"#continueToShippingOptions\");\n        updateWrappingChoice(promptMergeWrappingDecision);\n        if (btnContinuetoShippingOptions && document.body.classList.hasAttribute(\"has-modal\")) {\n          btnContinuetoShippingOptions.setAttribute(\"tabindex\", \"-1\");\n        }\n      }\n      const heading = focusInteractiveStep();\n\n      if (heading) {\n        const currentStep = heading.closest(\"[class^=step]\");\n        data.stepNumber = Array.prototype.indexOf.call(currentStep.parentElement.children, currentStep) + 1;\n      }\n      if(data.stepNumber === 3) {\n        if (window.config.country === \"KR\") {\n          callSeeMoreOption()\n        }\n        if (window.config.country === \"JP\") {\n          loadGmoDeviceFingerUrl()\n        }\n        if (window.config.country === \"RU\") {\n          getCustomerTimeZone()\n        }\n        if (window.config.country === \"CN\") {\n          showUnionPay()\n          showWeChat()\n        }\n      }\n\n      if (data.stepNumber === 2 || data.stepNumber === 3) {\n        if (select('input[name=\"posGeoLocation\"]') || selectAll('.POSElement').length === 1) {\n          loadMapOnPageLoad()\n        }\n      }\n\n      updateSamples(data);\n      updateEmployeeSavings(data);\n      updatePageTitle(heading);\n      updateOrderSummary(data);\n      enableSubmitBtns();\n      selectDeliveryMethod();\n      resetPaymentModes();\n\n      return data;\n    });\n  }\n\n  function getCustomerTimeZone() {\n\tconst timeZoneElm = select('.js-time-zone')\n\ttimeZoneElm.value = new Date()\n  }\n\n  function showUnionPay() {\n    let unionPayDiv = select('.js-union-pay')\n\tif (isWideScreen() && unionPayDiv) {\n\t  unionPayDiv.removeAttribute('hidden')\n\t}\n  }\n\n  function showWeChat(){\n    const weChatDiv = select('.js-wechat-pay')\n    const aliPay = select('.js-alipay-pay')\n    if(!isWideScreen()){\n\t\tif (weChatDiv && isWeChatBrowser()) {\n\t\t\tconst wechatCheckbox = select('#payment-wechatPay')\n\t\t\tconst alipayCheckbox = select('#payment-aliPay')\n\t\t\tconst weChatForm = select('#wechatPay-method')\n\t\t\tconst aliPayForm = select('#aliPay-method')\n\t\t\tconst wechatPayTerms = select('#setTermCondition_wechatPay')\n\t\t\tconst aliPayTerms = select('#setTermCondition_aliPay')\n\t\t\tweChatDiv.removeAttribute('hidden')\n\t\t\tweChatDiv.classList.add('selected')\n\t\t\twechatCheckbox.setAttribute(\"checked\", \"checked\")\n\t\t\tweChatForm.classList.remove('is-hidden')\n\t\t\tweChatForm.removeAttribute('aria-hidden')\n\t\t\twechatPayTerms.setAttribute('required', true)\n\t\t\taliPayTerms.removeAttribute('required')\n\t\t\taliPay.classList.remove('selected')\n\t\t\talipayCheckbox.removeAttribute(\"checked\")\n\t\t\taliPayForm.classList.add('is-hidden')\n\t\t\taliPayForm.setAttribute('aria-hidden', true)\n\t\t} else {\n\t\t\taliPay.removeAttribute('hidden')\n\t\t}\n    } else {\n      weChatDiv.removeAttribute('hidden')\n      aliPay.removeAttribute('hidden')\n    }\n  }\n\n  function callSeeMoreOption() {\n\t  const seeMoreBtns = selectAll('.js-see-more-terms-kr')\n\t  seeMoreBtns.forEach((element) => {\n\t    element.addEventListener('click', toggleSeeMore)\n\t  })\n\t}\n\n\tfunction toggleSeeMore(e) {\n\t  const seeMoreBtn = e.target\n\t  const seeMoreContent = seeMoreBtn.closest('div').nextElementSibling\n\t  if (seeMoreContent.style.display === \"none\" || seeMoreContent.style.display === \"\") {\n\t    seeMoreContent.style.display = \"block\";\n\t    e.target.innerText = config.conciergeDelivery.seeLessBtn\n\t    seeMoreContent.setAttribute('tabindex', 0)\n\t   } else {\n\t    seeMoreContent.style.display = \"none\";\n\t    e.target.innerText = config.conciergeDelivery.seeMoreBtn\n\t  }\n\t}\n\n\n  function resetPaymentModes() {\n    if (!applePayIsSupported()) {\n      const paymentUl = select(\".js-billing-radio-buttons\");\n      const paymentLi = select(\".js-applepay-enable\");\n      const applePayDiv = select(\"#applepay-method\");\n      if (paymentUl) {\n        if (paymentLi) {\n          paymentUl.removeChild(paymentLi);\n        }\n        if (applePayDiv) {\n          applePayDiv.remove();\n        }\n      }\n    }\n  }\n\n  function updateSamples(data) {\n    if (data.isEmployeeSale) {\n      const sampleList = select(\".js-samples-list\");\n      if (sampleList) {\n        const wrapper = sampleList.parentNode;\n        sampleList.remove();\n        wrapper.innerHTML = `<p class='error'>${config.dl.opc.notification.samples.employee}</p>`;\n      }\n    }\n  }\n\n   function updateWrappingChoice(promptMergeWrappingDecision){\n    if (promptMergeWrappingDecision == 'false'){\n      const wrapping = select(\"[class='cart-wrapping']\", el);\n      wrapping.innerHTML = \"\";\n      data.parts.cart_wrapping = wrapping.innerHTML;\n    }\n\n   }\n\n  function updateEmployeeSavings(data) {\n    if (data.isEmployeeSale) {\n      const employeeSavingsSection = select(EMPLOYEE_SAVINGS);\n\n      if (employeeSavingsSection) {\n        employeeSavingsSection.removeAttribute(\"hidden\");\n      }\n    }\n  }\n\n  /**\n   * Update order summary items\n   * @param data {object}: request response data\n   */\n  function updateOrderSummary(data) {\n    const parts = data.parts;\n    if (parts && \"cart_items\" in parts) {\n      const orderSummaryElm = select(\"[class=cart-product-list]\", el);\n      orderSummaryElm.innerHTML = parts.cart_items;\n    }\n  }\n\n  function setFocus(container, hasFocus, inputEl) {\n    if (hasFocus) {\n      if (!container.classList.contains(\"has-focus\")) {\n        container.classList.add(\"has-focus\");\n      }\n    } else if (container.classList.contains(\"has-focus\") && inputEl.value === \"\") {\n      container.classList.remove(\"has-focus\");\n    }\n  }\n\n  function managePlaceholders(elem) {\n    const loginInput = elem || false;\n    const passwordContainer = elem ? elem.parentElement : false;\n\n    if (!loginInput || !passwordContainer) {\n      return;\n    }\n\n    loginInput.onfocusin = function () {\n      setFocus(passwordContainer, true);\n    };\n    loginInput.onblur = function () {\n      setFocus(passwordContainer, false, loginInput);\n    };\n    loginInput.onchange = function () {\n      const focus = loginInput.val() !== \"\" ? setFocus(passwordContainer, true) : setFocus(passwordContainer, false, loginInput);\n    };\n\n    const focus = loginInput.value !== \"\" ? setFocus(passwordContainer, true) : setFocus(passwordContainer, false, loginInput);\n  }\n\n  function manageStep1ScreenSwitch(id) {\n    const step1DivElm = select(\".step1\", document.body);\n    const gigyaWrapperElm = select(`#${GIGYA_WRAPPER_ID}`, step1DivElm);\n    const guestDivElm = select(\"#checkout-guest-sign-in\", step1DivElm);\n    const gigyaLoginScreen = select(\"#gigya-login-screen\", document.body);\n    const gigyaRegisterScreen = select(\"#gigya-register-screen\", document.body);\n\n    // According on id, if Guest we show Guest section and hide gigya wrapper section else reverse\n    if (id === \"checkout-guest-sign-in\") {\n      hideBlock(gigyaWrapperElm);\n      showBlock(guestDivElm);\n      updatePageTitle(focusInteractiveStep(guestDivElm));\n    } else {\n      // If gestDivElm is not hidden then we need to manually switch Gigya\n      const forceSwitch = !guestDivElm.hasAttribute(\"aria-hidden\");\n      hideBlock(guestDivElm);\n      showBlock(gigyaWrapperElm);\n\n      if (id === \"checkout-sign-in\") {\n        updatePageTitle(focusInteractiveStep(gigyaLoginScreen));\n      }\n\n      if (id === \"checkout-register\") {\n        updatePageTitle(focusInteractiveStep(gigyaRegisterScreen));\n      }\n\n      // We want to force the switch only when coming from guest page, eitherway we get an error as the switch is done twice\n      if (forceSwitch) {\n        window.gigya.accounts.switchScreen({\n          screenSet: \"chanel-one\",\n          containerID: GIGYA_WRAPPER_ID,\n          screen: id === \"checkout-sign-in\" ? \"gigya-login-screen\" : \"gigya-register-screen\",\n        });\n      }\n    }\n    return;\n  }\n\n  function toggleDisplay(e) {\n    enableSubmitBtns();\n    const button = e.delegateTarget;\n    const id = button.dataset.stepDisplay;\n    const lEmailElm = select(`#${LOGIN_EMAIL}`, document.body);\n\n    // hide or show [guest, sign-in, register] blocks\n    manageStep1ScreenSwitch(id);\n    updateAnalyticsUserOpc(id);\n\n    if (lEmailElm && isLocalStorage() === true) {\n      lEmailElm.value = window.localStorage.getItem(\"lastUsedEmail\");\n    }\n\n    managePlaceholders(lEmailElm);\n  }\n\n  function hideBlock(context) {\n    if (context) {\n      context.classList.add(HIDDEN_CLASSNAME);\n      context.setAttribute(\"aria-hidden\", \"true\");\n\n      inert.set(context);\n      const fields = Array.from(context.querySelectorAll(\"input, textarea, select\"));\n      fields.forEach((field) => {\n        field.setAttribute(\"disabled\", true);\n      });\n\n      Manager.publish(REMOVE_ERROR, context);\n    }\n  }\n\n  function showBlock(context) {\n    if (context) {\n      context.classList.remove(HIDDEN_CLASSNAME);\n      context.removeAttribute(\"aria-hidden\");\n\n      const fields = Array.from(context.querySelectorAll(\"[disabled]\"));\n      fields.forEach((field) => {\n        if (!field.closest('[aria-hidden=\"true\"]')) {\n          field.removeAttribute(\"disabled\");\n        }\n      });\n      inert.unset(context);\n    }\n  }\n\n  function updateDefaultCardCheckbox(e) {\n    const checkbox = document.getElementById(\"setDefaultPaymentMethod\");\n\n    if (e.delegateTarget.checked) {\n      checkbox.removeAttribute(\"disabled\");\n      return;\n    }\n\n    checkbox.checked = false;\n    checkbox.setAttribute(\"disabled\", true);\n  }\n\n  /**\n   * this function are used only where user are logged\n   * to send missing info to datalayer\n   */\n  function updateDatalayerStep() {\n    const divElm = select(\"[data-opc-step]\");\n    const subtotal = select(\"[data-subtotal]\");\n    let cartValueWithoutTax;\n    if (subtotal && subtotal.dataset && subtotal.dataset.subtotal) {\n      cartValueWithoutTax = subtotal.dataset.subtotal;\n    }\n    const privateWait = function (data, nextPage) {\n      window.addEventListener(\"load\", () => {\n        window.setTimeout(() => {\n          trackPageview(data, nextPage);\n        }, 50);\n      });\n    };\n\n    if (divElm) {\n      const stepName = divElm.getAttribute(\"data-opc-step\");\n      const data = {\n        dl: {\n          stepName,\n          stepNumber: 0,\n        },\n        cartValueWithoutTax,\n      };\n      switch (stepName) {\n        case \"SHIPPING\":\n          data.dl.stepNumber = 1;\n          privateWait(data, `${window.location.pathname}/shipping`);\n          break;\n        case \"BILLING\":\n          data.dl.stepNumber = 2;\n          privateWait(data, `${window.location.pathname}/billing`);\n          break;\n        default:\n          break;\n      }\n    }\n  }\n\n  function appliedFocusOnActiveForm() {\n    const stepsElms = selectAll(\"[class^=step]\");\n    const activeStepElm = (stepsElms || []).find((stepElm) => select(\"form\", stepElm));\n    if (activeStepElm) {\n      zipCodeVariation();\n      updateInputs();\n      const titleElm = select(\"h2.heading\", activeStepElm);\n      if (titleElm) {\n        focusElement(titleElm);\n      }\n    }\n  }\n\n  /**\n   * Private fn: This method are used to update the mobiles burger menu\n   * It should be used for this purposes only\n   * @param res {JSON}: contains xhr.request response\n   * @return {*} initial request response\n   */\n  function updateMobileBurgerMenu(res) {\n    Manager.subscribe(PAGELOAD_WISHLIST, (response) => {\n      const signInElm = selectAll(\".signIn-register\");\n      const welcomeElm = select(\"[data-signin-welcome]\");\n\n      if (signInElm && welcomeElm && response.session.name) {\n        // Get HTML li element (to display welcome user.firstName)\n        const welcomeLiString = welcomeElm.dataset.signinWelcome;\n\n        // Create a tmp div and extract the HTML li element\n        const welcomeLiElm = document.createElement(\"li\");\n        welcomeLiElm.innerHTML = welcomeLiString;\n\n        // Get the SVG element\n        const svgElm = select(\"svg\", welcomeLiElm);\n\n        // update the firstName element according received values from xhr.request\n        const firstNameElm = select(\"#signIn-welcome-firstName\", welcomeLiElm);\n        firstNameElm.innerHTML = `${window.config.locales.menu.welcome} ${response.session.name}`;\n        firstNameElm.setAttribute(\"href\", response.session.accountUrl);\n        firstNameElm.appendChild(svgElm);\n\n        // set current li.signIn-register by the li.signIn-Welcome elm\n        if (signInElm) {\n          signInElm.forEach((elm) => {\n            elm.innerHTML = welcomeLiElm.childNodes[0].innerHTML;\n            if (elm.id !== \"signIn-register\") {\n              const menuNameList = elm.id.split(\"-\");\n              const firstNameElm = select(\"#signIn-welcome-firstName\", elm);\n              firstNameElm.id = `signIn-welcome-firstName-${menuNameList[menuNameList.length - 1]}`;\n              firstNameElm.removeAttribute(\"class\");\n            }\n          });\n        }\n      }\n      return response;\n    })\n    return res;\n  }\n\n  /**\n   * Check if user is an employee sales\n   * true => hide sample block\n   * false => do nothing\n   * @param data {object}: Gigya provided data\n   * @returns {*}: Gigya provided data\n   */\n  function disableSamplesBlock(data) {\n    const samplesBlockElm = select(\"[data-samples-block]\");\n    const nbSamples = samplesBlockElm ? parseInt(samplesBlockElm.dataset.samplesBlock, 10) : null;\n    if (samplesBlockElm && data.isEmployeeSale && !nbSamples) {\n      samplesBlockElm.hidden = data.isEmployeeSale;\n    }\n    return data;\n  }\n\n  bindSelectionItems();\n  PromocodeToggle();\n  updateDatalayerStep();\n\n  // update a11y document title on page loaded\n  updatePageTitle();\n  function buttonClick(form) {\n    Array.prototype.forEach.call(form.elements, (element) => {\n      if (element.type === \"submit\") {\n        element.setAttribute(\"disabled\", true);\n      }\n    });\n  }\n\n  function onUserConfirmedWrongAddress(e) {\n    const formElm = select(SHIPPING_ADDRESS_FORM_SELECTOR, el);\n    if (formElm) {\n      if (formElm[\"skipValidation\"]) {\n        formElm[\"skipValidation\"].value = \"true\";\n      }\n    }\n  }\n\n  // listen for login from gigya\n  Manager.subscribe(\"gigyaLogin\", handleGigyaLogin);\n  Manager.subscribe(\"gigyaNotifyLogin\", handleGigyaNotifyLogin);\n  window.addEventListener(\"load\", enableSubmitBtns);\n  if (!isSafari()) {\n    window.addEventListener(\"popstate\", handlePopState);\n  }\n  // window.addEventListener('load', renderExpressCheckoutCtas)\n\n  if (applePayIsSupported()) {\n    initApplePayOPCManager();\n  }\n  function shippingOptionHighlight(e) {\n    if (e && e.delegateTarget) {\n      let radioButton = select(\"input[name=delivery_method]\", e.delegateTarget);\n      if (radioButton) {\n        radioButton.checked = true;\n      }\n    }\n    let shippingNodes = getCollection(\".shippingItem\");\n    shippingNodes.forEach((shippingNode) => {\n      if (shippingNode.children[0].checked !== true) {\n        shippingNode.classList.remove(\"highlightShippingNode\");\n        getCollection(\".shippingmethod__details\", shippingNode).forEach((detailsSection) => {\n          detailsSection.classList.add(\"is-hidden\");\n          const inputElement = select(\".toshi-method > input\");\n          if (inputElement) {\n            inputElement.setCustomValidity(\"\");\n            inputElement.checkValidity();\n            shippingNode.classList.remove(\"toshi-method\");\n          }\n          const deliverySlotDateInput = select(\".delivery_slot_date\", detailsSection);\n\n          if (deliverySlotDateInput) {\n            deliverySlotDateInput.removeAttribute(\"name\");\n          }\n          getCollection(\"select\", detailsSection).forEach((selectBox) => {\n            selectBox.removeAttribute(\"name\");\n          });\n        });\n      } else {\n        if (!shippingNode.classList.contains(\"highlightShippingNode\")) {\n          shippingNode.classList.add(\"highlightShippingNode\");\n          getCollection(\".shippingmethod__details\", shippingNode).forEach((detailsSection) => {\n            detailsSection.classList.remove(\"is-hidden\");\n            if (detailsSection.hasAttribute(\"data-method-toshi\")) {\n              shippingNode.classList.add(\"toshi-method\");\n              initToshiDetails(detailsSection);\n            }\n            const deliverySlotDateInput = select(\".delivery_slot_date\", detailsSection);\n            if (deliverySlotDateInput) {\n              deliverySlotDateInput.setAttribute(\"name\", \"delivery_slot_date\");\n            }\n            getCollection(\"select\", detailsSection).forEach((selectBox) => {\n              selectBox.setAttribute(\"name\", selectBox.dataset[\"name\"]);\n            });\n          });\n        }\n      }\n    });\n  }\n  function sendShippingDataToDatalayer() {\n    let shippingOptions = selectAll(\"input[data-shippingmethod-analytics]\");\n    if (shippingOptions) {\n      let name = \"\";\n      shippingOptions.forEach((shippingNode) => {\n        if (shippingNode.dataset[\"shippingmethodAnalytics\"]) {\n          name += `${shippingNode.dataset[\"shippingmethodAnalytics\"]}|`;\n        }\n      });\n      let nameAndPrice = name.substring(0, name.length - 1);\n      if (nameAndPrice) {\n        document.DLKit.push(\"when-shipping-methods-display\", {\n          eventAction: \"display\",\n          eventLabel: nameAndPrice,\n        });\n      }\n    }\n  }\n  function selectDeliveryMethod(e) {\n    deliveryCalendar = new deliveryMethodCalendar();\n    var selectOpt;\n    if (!(e && e.delegateTarget)) {\n      selectOpt = select('input[name=\"deliveryOptions\"]:checked');\n    } else {\n      selectOpt = select('input[type=\"radio\"]', e.delegateTarget);\n    }\n    const PSOptionWrapper = select(\".POSOptionWrapper\");\n    const shippingAddressSection = select(\".shippingAddressSection\");\n    const cartPriceEle = select(\".cart-product-list\");\n    const customerEle = select(\".customer\");\n    const customerAsideEle = select(\".customer__aside\");\n    const stickyMap = select(\".POSMap\");\n\n    if (selectOpt) {\n      selectOpt.checked = true;\n      var inputs = selectAll('input[name=\"deliveryOptions\"]')\n      if (inputs) {\n        var inputs_length = inputs.length;\n        const cncOption = select('input[id=\"clickAndCollect\"]')\n        const homeDeliveryOption = select('input[id=\"homeDelivery\"]')\n        if (cncOption && homeDeliveryOption && inputs_length > 1) {\n          addhomeDeliveryCnCAnalytics()\n        }\n        var i = 0;\n        for (; i < inputs_length; i++) {\n          if (inputs[i].checked === true) {\n            inputs[i].closest(\"div\").classList.add(\"selectedOpt\");\n            inputs[i].closest(\"div\").classList.remove(\"unSelectedOpt\");\n            if (inputs[i].id === \"clickAndCollect\") {\n              isCncDeliveryMode = true;\n              posDataLayerUpdate(\"CnC\", inputs[i].id);\n              if (selectAll('input[name=\"posName\"]').length > 5 && !isMobileScreen()) {\n                if (customerAsideEle) {\n                  customerAsideEle.classList.add(\"customerAsideSticky\");\n                  customerAsideEle.style.top = \"-\" + (cartPriceEle.offsetHeight + 80);\n                }\n                if (customerEle) {\n                  customerEle.style.overflow = \"initial\";\n                }\n                if (stickyMap) {\n                  stickyMap.classList.add(\"POSMapSticky\");\n                }\n              }\n              var selectedPosId = select('input[name=\"posName\"]:checked');\n              var lat;\n              var long;\n              var id;\n              if (selectedPosId) {\n                lat = selectedPosId.getAttribute(\"data-lat\");\n                long = selectedPosId.getAttribute(\"data-lng\");\n                id = selectedPosId.getAttribute(\"id\");\n                initializeMap(lat, long, id);\n              }\n              if (PSOptionWrapper) {\n                PSOptionWrapper.closest(\"fieldset\").removeAttribute(\"hidden\");\n                shippingAddressSection.setAttribute(\"hidden\", \"\");\n                var inputPOS = selectAll('input[name=\"posName\"]');\n                if (inputPOS) {\n                  var totalPOS = inputPOS.length;\n                  if (totalPOS === 1) {\n                    inputPOS[0].checked = true;\n                    select(\".moreDetailsPOS\", inputPOS[0].closest(\"li\")).removeAttribute(\"hidden\");\n                    select(\".leadTimeExpended\", inputPOS[0].closest(\"li\")).removeAttribute(\"hidden\");\n                    select(\".leadTimeCollapsed\", inputPOS[0].closest(\"li\")).setAttribute(\"hidden\", \"\");\n                  }\n                }\n              }\n            } else {\n              isCncDeliveryMode = false;\n              if (stickyMap) {\n                stickyMap.classList.remove(\"POSMapSticky\");\n              }\n              if (customerAsideEle) {\n                customerAsideEle.removeAttribute(\"style\");\n                customerAsideEle.classList.remove(\"customerAsideSticky\");\n              }\n              if (customerEle) {\n                customerEle.removeAttribute(\"style\");\n              }\n            }\n            focusElement(inputs[i], { notChangeTabIndex: true });\n          } else {\n            inputs[i].closest(\"div:not(.notAvailableOpt)\").classList.add(\"unSelectedOpt\");\n            inputs[i].closest(\"div\").classList.remove(\"selectedOpt\");\n            if (PSOptionWrapper) {\n              PSOptionWrapper.closest(\"fieldset\").setAttribute(\"hidden\", \"\");\n            }\n            shippingAddressSection.removeAttribute(\"hidden\");\n          }\n        }\n      }\n    } else {\n      if (config.country.toLowerCase() == \"us\" && !isWideScreen()) {\n        let posMap = select(\".POSMap\");\n        if (posMap) {\n          posMap.setAttribute(\"hidden\", \"\");\n        }\n      }\n    }\n    shippingOptionHighlight();\n    sendShippingDataToDatalayer();\n    const weekendDeliverySelect = select('select', document.getElementById(\"weekendDeliveryOptions\"))\n    if (weekendDeliverySelect) {\n      handleChange(weekendDeliverySelect);\n    }\n  }\n  window.onload = function () {\n    const isChallengeShopper = select(\"#challengeShopperId\");\n    if (isChallengeShopper) {\n      initThreeDS2Popin();\n    }\n    selectDeliveryMethod();\n    const giftCardList = select(\".giftCard__List\");\n    if (giftCardList) {\n      const paymentCreditCard = select(\"#payment-creditcard\");\n      paymentCreditCard.removeAttribute(\"disabled\");\n    }\n    const nonSelectedPOSList = selectAll('.POSElement');\n    if (nonSelectedPOSList.length === 1) {\n      loadMapOnPageLoad();\n    }\n    const preSelectedPOS = select('input[name=\"posGeoLocation\"]')\n    if (preSelectedPOS) loadMapOnPageLoad();\n    const pymtError = select(\".pending-payment-error\")\n    if (pymtError) {\n      pushDataEvent()\n      pymtError.focus();\n     }\n  };\n\n  function pushDataEvent () {\n    dataLayer.push({\n        'eventCategory': 'payment in progress',\n        'eventAction': 'display',\n        'eventLabel': '',\n        'event':  'uaevent'\n     });\n  }\n\n  function selectPOSAddress(e) {\n    var selectPOS = e.delegateTarget;\n    if (!selectPOS) {\n      selectPOS = e;\n    }\n    const lat = selectPOS.getAttribute(\"data-lat\");\n    const long = selectPOS.getAttribute(\"data-lng\");\n    const id = selectPOS.getAttribute(\"id\");\n    const posValue = selectPOS.getAttribute(\"value\");\n    const skipStoreMapTop = select(\"#skip_storemap_top\")\n    const skipStoremapBottom = select(\"#skip_storemap_bottom\")\n    if (skipStoreMapTop) {\n      skipStoreMapTop.removeAttribute(\"aria-hidden\")\n      skipStoreMapTop.removeAttribute(\"tabindex\")\n      skipStoreMapTop.parentElement.removeAttribute(\"aria-hidden\")\n    }\n    if (skipStoremapBottom) {\n      skipStoremapBottom.removeAttribute(\"aria-hidden\")\n      skipStoremapBottom.removeAttribute(\"tabindex\")\n      skipStoremapBottom.parentElement.removeAttribute(\"aria-hidden\")\n    }\n    posDataLayerUpdate(\"posMap\", posValue);\n    initializeMap(lat, long, id);\n\n    if (selectPOS) {\n      selectPOS.checked = true;\n      var inputs = selectAll('input[name=\"posName\"]');\n      if (inputs) {\n        var inputs_length = inputs.length;\n        var j = 0;\n        for (; j < inputs_length; j++) {\n          if (inputs[j].checked === true) {\n            select(\".moreDetailsPOS\", inputs[j].closest(\"li\")).removeAttribute(\"hidden\");\n            select(\".leadTimeExpended\", inputs[j].closest(\"li\")).removeAttribute(\"hidden\");\n            select(\".leadTimeCollapsed\", inputs[j].closest(\"li\")).setAttribute(\"hidden\", \"\");\n            focusElement(inputs[j], { notChangeTabIndex: true });\n          } else {\n            select(\".moreDetailsPOS\", inputs[j].closest(\"li\")).setAttribute(\"hidden\", \"\");\n            select(\".leadTimeCollapsed\", inputs[j].closest(\"li\")).removeAttribute(\"hidden\");\n            select(\".leadTimeExpended\", inputs[j].closest(\"li\")).setAttribute(\"hidden\", \"\");\n          }\n        }\n      }\n    }\n  }\n\n  function initializeMap(lat, lng, posTitle) {\n    var map;\n    var style = [\n      {\n        elementType: \"labels.icon\",\n        stylers: [\n          {\n            visibility: \"off\",\n          },\n        ],\n      },\n    ];\n    var center = new google.maps.LatLng(lat, lng);\n    var mapOptions = {\n      center: center,\n      mapTypeId: google.maps.MapTypeId.ROADMAP,\n      disableDefaultUI: true,\n      zoomControl: true,\n      gestureHandling: \"greedy\",\n    };\n    var mobileMapElement = select(\"#googleMapMobile-\" + posTitle);\n    let posMapBlock = select(\".POSMap\");\n    if (isMobile) {\n      if (posMapBlock) posMapBlock.setAttribute(\"hidden\", \"\")\n      if (mobileMapElement) {\n        mobileMapElement.closest(\".POSMapMobile\").removeAttribute(\"hidden\");\n        map = new google.maps.Map(mobileMapElement, mapOptions);\n      }\n    }\n    else if (isTabletScreen()) {\n      if (posMapBlock) posMapBlock.setAttribute(\"hidden\", \"\")\n      if (mobileMapElement) {\n        mobileMapElement.closest(\".POSMapMobile\").removeAttribute(\"hidden\");\n        map = new google.maps.Map(mobileMapElement, mapOptions);\n      }\n    }\n    else if (isWideScreen()) {\n      if (mobileMapElement) {\n        mobileMapElement.closest(\".POSMapMobile\").setAttribute(\"hidden\", \"\");\n      }\n      if (posMapBlock) posMapBlock.removeAttribute(\"hidden\")\n      map = new google.maps.Map(document.getElementById(\"googleMap\"), mapOptions);\n    }\n    var mapType = new google.maps.StyledMapType(style, { name: \"Grayscale\" });\n    map.mapTypes.set(\"grey\", mapType);\n    map.setMapTypeId(\"grey\");\n    var latlngbounds = new google.maps.LatLngBounds();\n    var latLng = { lat: Number(lat), lng: Number(lng) };\n    var pt = new google.maps.LatLng(lat, lng);\n    var marker_image = `${config.theme}/assets/media/pin-black.png`;\n    var pinIcon = new google.maps.MarkerImage(marker_image, null, null, null, new google.maps.Size(22, 22));\n    var marker = new google.maps.Marker({\n      position: latLng,\n      map: map,\n      icon: pinIcon,\n    });\n    latlngbounds.extend(marker.position);\n    marker.addListener(\"click\", function () {\n      selectPOSNow(posTitle);\n    });\n    if (posTitle) {\n      map.setCenter(pt);\n      map.setZoom(17);\n    } else {\n      if (!isMobileScreen()) {\n        var bounds = new google.maps.LatLngBounds();\n        map.setCenter(latlngbounds.getCenter());\n        map.fitBounds(latlngbounds);\n      }\n    }\n  }\n\n  function selectPOSNow(posId) {\n    if (posId) {\n      var posElement = select(`#${posId}`);\n      if (posElement) {\n        posElement.checked = true;\n        selectPOSAddress(posElement);\n      }\n    }\n  }\n  /**\n   * hide the new card form if user clicks\n   * edit card link of saved cards without\n   * selecting its radio button\n   */\n  function hideNewCardForm(e) {\n    const paymentMethodBlock = select(\"#payment-method-block\");\n    const paymentIdEdit = select('input[name=\"paymentId\"]');\n    if (paymentMethodBlock && paymentIdEdit) {\n      hideBlock(paymentMethodBlock);\n      const form = select(\"#sopPaymentDetailsForm\");\n      const selectedCard = select('input[name=\"subscriptionId\"]:not([id=payment-method-add])');\n      if (selectedCard) {\n        const formAction = selectedCard.getAttribute(\"data-formaction\");\n        if (formAction) {\n          form.action = formAction;\n        }\n      }\n    }\n  }\n\n  function loadMaponEditBoutique() {\n    var selectedPosId = select('input[name=\"posName\"]:checked');\n    if (selectedPosId) {\n      const lat = selectedPosId.getAttribute(\"data-lat\");\n      const long = selectedPosId.getAttribute(\"data-lng\");\n      initializeMap(lat, long, selectedPosId);\n      focusElement(selectedPosId, { notChangeTabIndex: true });\n    }\n  }\n\n  function loadGmoDeviceFingerUrl() {\n    // load Gmo Device Finger url on body\n    let script = document.createElement('script')\n    script.src = `${window.config.webservices.gmo.gmoDeviceFingerUrl}`\n    script.type = 'text/javascript'\n    script.onload = function( evt ) {\n      document.body.removeChild ( this )\n    }\n    document.body.appendChild(script)\n  }\n\n  function selectPaymentFocusIn() {\n    selectAll('[name=\"payment\"]').forEach((inputs) => {\n      if (document.activeElement === inputs) {\n        inputs.closest(\"li\").style.border = \"1px solid\";\n      } else {\n        inputs.closest(\"li\").removeAttribute(\"style\");\n      }\n    });\n  }\n\n  function selectPaymentFocusOut() {\n    selectAll('[name=\"payment\"]').forEach((inputs) => {\n      inputs.closest(\"li\").removeAttribute(\"style\");\n    });\n  }\n\n  function selectPaymentType(e) {\n    const paymentTypeEl = e.delegateTarget;\n    const giftcardEl = select(\".js-giftCard\");\n    const codPaymentEl = select(\"#payment-cod\");\n    var setTrustlyEl = select(\".js-trustly\");\n    paymentTypeEl.checked = true;\n    if (paymentTypeEl) {\n      selectAll('[name=\"payment\"]').forEach((inputs) => {\n        if (paymentTypeEl.id === inputs.id) {\n          inputs.closest(\"li\").removeAttribute(\"style\");\n          inputs.closest(\"li\").classList.add(\"selected\");\n          focusElement(inputs, { notChangeTabIndex: true });\n          inputs.setAttribute(\"checked\", \"checked\");\n          inputs.removeAttribute(\"tabindex\");\n          inputs.closest(\"li\").style.border = \"1px solid\";\n        } else {\n          inputs.closest(\"li\").classList.remove(\"selected\");\n          inputs.removeAttribute(\"checked\");\n          inputs.removeAttribute(\"tabindex\");\n          inputs.closest(\"li\").removeAttribute(\"style\");\n        }\n      });\n    }\n    if (paymentTypeEl) {\n      if (select(\"#payment-giftcard\")) {\n        select(\"#payment-giftcard\").closest(\"li\").classList.remove(\"giftcard-black\");\n        select(\"#payment-giftcard\").closest(\"li\").classList.add(\"giftcard-white\");\n      }\n      const id = paymentTypeEl.getAttribute(\"id\");\n\n      if (setTrustlyEl) {\n        setTrustlyEl.innerHTML = `<svg class=\"icon trustly\" focusable=\"false\" aria-hidden=\"true\">\n              <use xlink:href=\"${config.paths.icons}icons.svg${config.targetVersion}#${id === \"payment-trustly\" ? 'trustly' : 'trustly-grey-bg'}\" />\n              </svg><span class=\"is-sr-only\">Trustly</span>`;\n      }\n      if (id === \"payment-creditcard\") {\n        var setOptionalEl = select('input[name=\"card_cvn_optional\"]');\n        if (setOptionalEl) {\n          setOptionalEl.removeAttribute(\"required\");\n          setOptionalEl.setAttribute(\"aria-required\", false);\n        }\n      }\n      if(codPaymentEl){\n        if (id !== \"payment-cod\") {\n          updateCodPayment(\"remove\");\n        } else {\n          updateCodPayment(\"apply\");\n        }\n      }\n      if (id === \"payment-applePay\") {\n        const termCondErrorMsgEl = select(\"#error-setTermCondition_applePay\");\n        const labeltermCondition = select('label[for=\"setTermCondition_applePay\"]');\n        if (termCondErrorMsgEl && labeltermCondition) {\n          labeltermCondition.removeChild(termCondErrorMsgEl);\n        }\n      }\n      if (id === \"payment-giftcard\") {\n        const formElm = select(\"form#sopPaymentDetailsForm\");\n        const giftMethodEl = select(\"#giftcard-method\");\n        localStorage.setItem(\"defaultAction\", formElm.getAttribute(\"action\"));\n        if (giftcardEl) {\n          if (giftMethodEl && giftMethodEl.classList.contains(HIDDEN_CLASSNAME)) {\n            giftMethodEl.classList.remove(HIDDEN_CLASSNAME);\n            giftMethodEl.removeAttribute(\"aria-hidden\");\n            const fields = selectAll(\"input\", giftMethodEl);\n            fields.forEach((field) => {\n              field.removeAttribute(\"disabled\");\n              field.setAttribute(\"required\", true);\n              field.setAttribute(\"aria-required\", true);\n            });\n          }\n          paymentTypeEl.closest(\"li\").classList.remove(\"giftcard-white\");\n          paymentTypeEl.closest(\"li\").classList.add(\"giftcard-black\");\n          giftcardEl.innerHTML = \"\";\n          giftcardEl.innerHTML = `<svg class=\"icon is-boxes-giftcard-white\" focusable=\"false\" aria-hidden=\"true\">\n              <use xlink:href=\"${config.paths.icons}icons.svg${config.targetVersion}#boxes_giftcard\" />\n              </svg><span class=\"is-sr-only\">Chanel Gift card</span>`;\n        }\n      } else {\n        if (giftcardEl) {\n          giftcardEl.innerHTML = `<svg class=\"icon\" focusable=\"false\" aria-hidden=\"true\">\n                <use xlink:href=\"${config.paths.icons}icons.svg${config.targetVersion}#boxes_giftcard\" />\n                </svg><span class=\"is-sr-only\">Chanel Gift card</span>`;\n        }\n      }\n    }\n  }\n\n  function updateCodPayment(op) {\n    xhr.post(config.webservices.checkout.codOperation + op, {}).then((data) => {\n      if (data.success) {\n        updateSteps(data);\n      }\n    });\n  }\n\n  function selectSavedCard(e) {\n    var selectedCard = e.delegateTarget;\n    if (!selectedCard) {\n      selectedCard = e;\n    }\n    const id = selectedCard.getAttribute(\"id\");\n    if (selectedCard) {\n      selectedCard.checked = true;\n      var inputs = selectAll('input[name=\"subscriptionId\"]');\n      var selectedCvvId = \"\";\n      if (inputs) {\n        var inputs_length = inputs.length;\n        var j = 0;\n        for (; j < inputs_length; j++) {\n          if (inputs[j].checked === true) {\n            if (inputs[j].id == \"payment-method-add\") {\n              var setDefaultEl = select(\"#setDefaultPaymentMethod\");\n              if (setDefaultEl) {\n                setDefaultEl.removeAttribute(\"required\");\n                setDefaultEl.setAttribute(\"aria-required\", false);\n                setDefaultEl.setAttribute(\"disabled\", true);\n              }\n              var setSavePaymentMethodEl = select(\"#savePaymentMethod\");\n              if (setSavePaymentMethodEl) {\n                setSavePaymentMethodEl.removeAttribute(\"required\");\n                setSavePaymentMethodEl.setAttribute(\"aria-required\", false);\n              }\n              if (setSavePaymentMethodEl.checked) {\n                setDefaultEl.removeAttribute(\"disabled\");\n              }\n              selectedCvvId = \"card_cvn\";\n            } else {\n              selectedCvvId = \"card_cvn\" + inputs[j].value;\n            }\n          }\n          if (inputs[j].id !== \"payment-method-add\") {\n            var cvvLabelElement = select(\"#card-cvv-block-\" + inputs[j].value);\n            if (inputs[j].checked === true && cvvLabelElement) {\n              cvvLabelElement.removeAttribute(\"class\");\n              cvvLabelElement.removeAttribute(\"hidden\");\n              focusElement(inputs[j], { notChangeTabIndex: true });\n            } else {\n              if (cvvLabelElement) {\n                cvvLabelElement.setAttribute(\"hidden\", \"\");\n                cvvLabelElement.removeAttribute(\"class\");\n              }\n            }\n          }\n        }\n      }\n      selectAll(\".js-card-cvn\").forEach((cvnInputField) => {\n        if (cvnInputField.id == selectedCvvId) {\n          cvnInputField.setAttribute(\"name\", \"card_cvn\");\n          cvnInputField.setAttribute(\"data-encrypted-name\", \"cvc\");\n        } else {\n          cvnInputField.setAttribute(\"name\", \"card_cvn_optional\");\n          cvnInputField.setAttribute(\"data-encrypted-name\", \"cvc_optional\");\n          cvnInputField.setAttribute(\"disabled\", \"disabled\");\n        }\n      });\n    }\n  }\n\n  /**\n   * Update Analytics data for Continue to shipping Options\n   */\n  function addDeliveryAnalytics() {\n    window.document.DLKit.push(\"on-tracking\", {\n      event: window.config.dl.event,\n      eventCategory: \"delivery\",\n      eventAction: \"home delivery\",\n      eventLabel: \"continue\",\n    });\n  }\n\n  function addcncDeliveryAnalytics() {\n    window.document.DLKit.push(\"on-tracking\", {\n      event: window.config.dl.event,\n      eventCategory: \"delivery\",\n      eventAction: \"click and collect\",\n      eventLabel: \"continue\",\n    });\n  }\n\n  /**\n   * Update Analytics data for Continue to shipping Options\n   */\n  function updateAnalyticsShippingOptions() {\n    window.document.DLKit.push(\"on-tracking\", {\n      event: window.config.dl.event,\n      eventCategory: \"delivery\",\n      eventAction: \"click\",\n      eventLabel: \"edit address\",\n    });\n  }\n\n  /**\n   * Update Analytics data for Edit an address for registered users\n   */\n  function updateAnalyticsEditAddress() {\n    window.document.DLKit.push(\"on-tracking\", {\n      event: window.config.dl.event,\n      eventCategory: \"delivery\",\n      eventAction: \"click\",\n      eventLabel: \"edit details\",\n    });\n  }\n\n  function editboutiqueLayerUpdate() {\n    window.document.DLKit.push(\"on-tracking\", {\n      eventCategory: \"delivery\",\n      eventAction: \"click\",\n      eventLabel: \"edit boutique\",\n      event: \"uaevent\",\n    });\n  }\n\n  /**\n   * Update Analytics data for Add an address for registered users\n   */\n  function updateAnalyticsAddAddress() {\n    window.document.DLKit.push(\"on-tracking\", {\n      event: window.config.dl.event,\n      eventCategory: \"delivery\",\n      eventAction: \"click\",\n      eventLabel: \"add a new address\",\n    });\n  }\n\n  /**\n   * Update Analytics data for Continue as a guest / Create an account\n   */\n  function updateAnalyticsUserOpc(id) {\n    switch (id) {\n      case \"checkout-guest-sign-in\":\n        window.document.DLKit.push(\"on-tracking\", {\n          event: window.config.dl.event,\n          eventCategory: \"account\",\n          eventAction: \"redirection\",\n          eventLabel: \"continue as a guest\",\n        });\n        break;\n      case \"checkout-register\":\n        window.document.DLKit.push(\"on-tracking\", {\n          event: window.config.dl.event,\n          eventCategory: \"account\",\n          eventAction: \"redirection\",\n          eventLabel: \"create an account\",\n        });\n        break;\n    }\n  }\n\n  function updateAnalyticsContinueAsGuest() {\n    window.document.DLKit.push(\"on-tracking\", {\n      event: window.config.dl.event,\n      eventCategory: \"guest\",\n      eventAction: \"click\",\n      eventLabel: \"continue to delivery\",\n    });\n  }\n\n  function updateAnalyticsOpcEdit() {\n    window.document.DLKit.push(\"on-tracking\", {\n      eventCategory: \"checkout\",\n      eventAction: \"click and collect\",\n      eventLabel: \"edit\",\n      event: \"uaevent\",\n    });\n  }\n\n  /**\n   * Update Analytics data for click and collect\n   * and select POS functionality\n   */\n  function posDataLayerUpdate(type, title) {\n    const posListArray = selectAll('input[name=\"posName\"]');\n    var totalPOS;\n    if (posListArray) {\n      totalPOS = posListArray.length;\n    }\n    var dataset;\n    switch (type) {\n      case \"CnC\":\n        dataset = {\n          eventCategory: window.config.dl.opc.deliveryMethod.method,\n          eventAction: window.config.dl.opc.deliveryMethod.cnc,\n          event: window.config.dl.event,\n          eventLabel: title,\n          click_and_collect_number_of_store: totalPOS,\n        };\n        break;\n      case \"posMap\":\n        dataset = {\n          eventCategory: window.config.dl.opc.deliveryMethod.method,\n          eventAction: window.config.dl.opc.deliveryMethod.eventActionMap,\n          event: window.config.dl.event,\n          eventLabel: title,\n          click_and_collect_number_of_store: totalPOS,\n        };\n        break;\n      default:\n        var selectedPosId = select('input[name=\"posName\"]:checked');\n        if (selectedPosId) title = selectedPosId.getAttribute(\"value\");\n        dataset = {\n          eventCategory: window.config.dl.opc.deliveryMethod.method,\n          eventAction: window.config.dl.opc.deliveryMethod.eventActionList,\n          event: window.config.dl.event,\n          eventLabel: title,\n          click_and_collect_number_of_store: totalPOS,\n        };\n        break;\n    }\n    window.document.DLKit.push(\"on-tracking\", dataset);\n  }\n\n  function addhomeDeliveryCnCAnalytics() {\n    window.dataLayer.push({\n      'eventCategory': 'delivery',\n      'eventAction': 'display',\n      'eventLabel': 'home delivery|click and collect',\n      'event':  'nievent'\n    });\n  }\n\n  defaultPaymentMethod();\n\n  function defaultPaymentMethod() {\n    const paymentDetailsForm = select(\"#sopPaymentDetailsForm\");\n    const creditCardOption = select(\"#payment-creditcard\");\n    if (paymentDetailsForm) {\n      if (creditCardOption) {\n        creditCardOption.click();\n      }\n    }\n  }\n\n  function handleSMSNotification(form) {\n    if (form.invalid.length) {\n      return;\n    }\n    xhr\n      .submit(form)\n      .then((data) => {\n        if (data.success) {\n          select('button[type=\"submit\"]', form).innerHTML = `\n            <svg class=\"icon is-medium is-checked\" focusable=\"false\" viewBox=\"0 0 1 1\" aria-hidden=\"true\" data-test=\"\">\n              <use xmlns:xlink=\"http://www.w3.org/1999/xlink\" xlink:href=\"${config.paths.icons}icons.svg${config.targetVersion}#checked\"></use>\n            </svg>\n            <span class=\"is-sr-only\">${window.config.dl.opc.numberSubmitted}</span>`;\n          if (select(\".js-btn-submit\")) select(\".js-btn-submit\").setAttribute(\"disabled\", true);\n          const countryCode = select(\"#countryCodeID\", form).value;\n          const mobileNumber = select(\"#smsContactNo\", form).value;\n          if (countryCode !== \"\" && mobileNumber !== \"\") {\n            let code = countryCode.replace(/\\D/g, \"\");\n            if (select(\"#numberWithCode\")) select(\"#numberWithCode\").innerHTML = `+${code} ${mobileNumber}`;\n            if (select(\"#notificationUnSubscriptionForm\")) select(\"#notificationUnSubscriptionForm\").action = select(\"#smsUnSubscriptionUrl\").value;\n            selectAll('[name=\"contactNumber\"]').forEach((inptPhone) => {\n              inptPhone.value = data.phoneCountryCode + \"\" + data.phoneNumber;\n            });\n            selectAll('[name=\"modifiedTime\"]').forEach((inpt) => {\n              inpt.value = data.modifiedTime;\n            });\n          }\n\n          setTimeout(function () {\n            if (select(\"#notification-form\")) select(\"#notification-form\").setAttribute(\"hidden\", \"\");\n            if (select(\"#notification-subscribed\")) select(\"#notification-subscribed\").removeAttribute(\"hidden\");\n            if (select(\".js-change-number\")) focusElement(select(\".js-change-number\"));\n          }, 3000);\n        }\n      })\n      .catch((data) => {\n        if (select(\".js-btn-save\")) select(\".js-btn-save\").classList.remove(\"is-disabled\");\n        displayError(data, form);\n      });\n  }\n\n  function updateSMSNumber(e) {\n    if (select(\"#notification-subscribed\")) select(\"#notification-subscribed\").setAttribute(\"hidden\", \"\");\n    if (select(\"#notification-form\")) select(\"#notification-form\").removeAttribute(\"hidden\");\n    if (select(\"#js-btn-submit\")) select(\"#js-btn-submit\").setAttribute(\"hidden\", \"\");\n    if (select(\"#js-btn-save\")) select(\"#js-btn-save\").removeAttribute(\"hidden\");\n    if (select(\".js-btn-save\")) select(\".js-btn-save\").classList.remove(\"is-disabled\");\n    if (select(\"#smsContactNo\") && select(\"#numberWithCode\")) {\n      select(\"#smsContactNo\").value = select(\"#numberWithCode\").innerHTML.substring(2).trim();\n      focusElement(select(\"#smsContactNo\"), { notChangeTabIndex: true });\n    }\n    if (select(\"#notificationSubscriptionForm\") && select(\"#smsUpdateSubscriptionUrl\")) select(\"#notificationSubscriptionForm\").action = select(\"#smsUpdateSubscriptionUrl\").value;\n    e.preventDefault();\n  }\n\n  function cancelUpdateSMSNumber(e) {\n    if (select(\"#notification-form\")) select(\"#notification-form\").setAttribute(\"hidden\", \"\");\n    if (select(\"#notification-subscribed\")) select(\"#notification-subscribed\").removeAttribute(\"hidden\");\n    if (select(\"#notificationSubscriptionForm\") && select(\"#smsUnSubscriptionUrl\")) select(\"#notificationSubscriptionForm\").action = select(\"#smsUnSubscriptionUrl\").value;\n    if (select(\".js-change-number\")) focusElement(select(\".js-change-number\"));\n    e.preventDefault();\n  }\n\n  function handleSubscribeAgain() {\n    const form = select(\"#notificationSubscriptionForm\");\n    if (select(\"#smsSubscriptionUrl\")) form.action = select(\"#smsSubscriptionUrl\").value;\n    if (select(\"#notification-unsubscribed\")) select(\"#notification-unsubscribed\").setAttribute(\"hidden\", \"\");\n    if (select(\"#notification-form\")) select(\"#notification-form\").removeAttribute(\"hidden\");\n    if (select(\"#js-btn-submit\")) select(\"#js-btn-submit\").removeAttribute(\"hidden\");\n    select(\".js-btn-submit\", form).innerHTML = `\n         <span class=\"button__wrapper\"><span>${window.config.dl.opc.signUpCta}</span></span>`;\n    if (select(\"#js-btn-save\")) select(\"#js-btn-save\").setAttribute(\"hidden\", \"\");\n    if (select(\"#smsContactNo\")) {\n      select(\"#smsContactNo\").value = \"\";\n      focusElement(select(\"#smsContactNo\"), { notChangeTabIndex: true });\n    }\n  }\n\n  function handleUnsubscribe(form) {\n    if (form.invalid.length) {\n      return;\n    }\n    if (select(\".js-change-number\")) select(\".js-change-number\").classList.add(\"disabled-btn\");\n    xhr\n      .submit(form)\n      .then((data) => {\n        if (data.success) {\n          if (select(\"#notification-subscribed\")) select(\"#notification-subscribed\").setAttribute(\"hidden\", \"\");\n          if (select(\"#notification-unsubscribed\")) select(\"#notification-unsubscribed\").removeAttribute(\"hidden\");\n          selectAll('[name=\"modifiedTime\"]').forEach((inpt) => {\n            inpt.value = data.modifiedTime;\n          });\n          const pElement = select(\"p.unsubscribed\");\n          if (pElement) {\n            focusElement(pElement);\n            if (select(\".js-change-number\")) select(\".js-change-number\").classList.remove(\"disabled-btn\");\n          }\n        }\n      })\n      .catch((data) => {\n        displayError(data, form);\n      });\n  }\n\n  /**\n   * Update class of input's parent if input has value\n   */\n\n  function updateInputs() {\n    const selectPhoneInput = select(\"input[data-phone-pattern-code]\", document.body);\n\n    if (selectPhoneInput && selectPhoneInput.value !== \"\") {\n      const wrapper = selectPhoneInput.closest(\".js-label-input\");\n      !wrapper.classList.contains(\"has-content\") ? wrapper.classList.add(\"has-content\") : null;\n    }\n  }\n\n  /**\n   * Update Analytics data for\n   * view shipping rules link\n   */\n  function shippingRulesDataLayerUpdate() {\n    var dataset = {\n      eventCategory: \"delivery\",\n      eventAction: \"click\",\n      eventLabel: \"shipping rules\",\n      event: \"uaevent\",\n    };\n    window.document.DLKit.push(\"on-tracking\", dataset);\n  }\n\n  function giftCardDataLayerUpdate(message) {\n    var dataset = {\n      eventCategory: \"card balance\",\n      eventAction: \"error\",\n      eventLabel: message,\n      event: \"nievent\",\n    };\n    window.document.DLKit.push(\"on-tracking\", dataset);\n  }\n\n  function changePaymentType(e) {\n    e.preventDefault();\n    const paymentModeSelector = select(\"#paymentModeSelector\");\n    const giftCardPaymentHeader = select(\"#giftCardPaymentHeader\");\n    const giftCardBtn = select(\"#payment-giftcard\");\n    const creditCardBtn = select(\"#payment-creditcard\");\n    const MODULE_SELECTOR = \"[data-form-toggle-display]\";\n    const giftCardListDisplay = select(\"#giftcard-display-list\");\n    giftCardListDisplay ? (giftCardListDisplay.innerHTML = \"\") : \"\";\n    paymentModeSelector ? paymentModeSelector.classList.remove(HIDDEN_CLASSNAME) : \"\";\n    giftCardPaymentHeader ? giftCardPaymentHeader.setAttribute(\"hidden\", true) : \"\";\n\n    xhr.post(config.webservices.checkout.removeGiftCard, {}).then((data) => {\n      renderGiftCardSection(data, true);\n      const formElm = select(\"form#sopPaymentDetailsForm\");\n      const selectedCard = select(\"#payment-method-add\");\n      if (selectedCard.checked) {\n        formElm.action = selectedCard.getAttribute(\"data-formaction\");\n      } else {\n        const selectedCardDefault = select('input[name=\"subscriptionId\"]:not([id=payment-method-add])');\n        formElm.action = selectedCardDefault.getAttribute(\"data-formaction\");\n      }\n    });\n\n    if (creditCardBtn && giftCardBtn) {\n      creditCardBtn.checked = true;\n      creditCardBtn.setAttribute(\"checked\", \"checked\");\n      giftCardBtn.checked = false;\n      giftCardBtn.removeAttribute(\"checked\", \"checked\");\n    }\n\n    const evtParams = {\n      bubbles: true,\n      cancelable: false,\n    };\n    const evt = new window.CustomEvent(\"change\", evtParams);\n    Array.prototype.forEach.call(document.querySelectorAll(MODULE_SELECTOR), (el) => {\n      if (el.checked) {\n        el.dispatchEvent(evt);\n        focusElement(creditCardBtn, { notChangeTabIndex: true });\n      }\n    });\n  }\n\n  function updateGiftCardList(e) {\n    e.preventDefault();\n    const checkTermCondEl = select(\"#setTermCondition_applePay\");\n    if (checkTermCondEl) {\n      checkTermCondEl.removeAttribute(\"required\", true);\n    }\n    const giftForm = e.delegateTarget.form || e.delegateTarget;\n    if (giftForm.checkValidity() && select(\"input[id=giftCardNumber]\", giftForm).value.length > 0 && select(\"input[id=giftCardCvn]\", giftForm).value.length > 0) {\n      giftForm.action = config.webservices.checkout.addGiftCard;\n      let paramsData = {\n        gift_card_number: select(\"input[id=giftCardNumber]\", giftForm).value,\n        gift_card_cvn: select(\"input[id=giftCardCvn]\", giftForm).value,\n      };\n      xhr.submit(giftForm).then((paramsData) => {\n        renderGiftCardSection(paramsData, false);\n        const giftCardTitleEl = select(\".gift-card-main\");\n        giftCardTitleEl ? focusElement(giftCardTitleEl) : \"\";\n        let paymentModeSelector = select(\"#paymentModeSelector\");\n        paymentModeSelector ? paymentModeSelector.classList.add(HIDDEN_CLASSNAME) : \"\";\n        let giftCardPaymentHeader = select(\"#giftCardPaymentHeader\");\n        giftCardPaymentHeader ? giftCardPaymentHeader.removeAttribute(\"hidden\") : \"\";\n      });\n    } else {\n      let giftCardNo = select(\"#giftCardNumber\").getAttribute(\"aria-invalid\");\n      let giftCardCvn = select(\"#giftCardCvn\").getAttribute(\"aria-invalid\");\n      if (giftCardNo) {\n        focusElement(select(\"#giftCardNumber\"), { notChangeTabIndex: true });\n        return;\n      }\n      if (giftCardCvn) {\n        focusElement(select(\"#giftCardCvn\"), { notChangeTabIndex: true });\n        return;\n      }\n    }\n  }\n\n  function renderGiftCardSection(data, defaultUrl) {\n    if (data.jsonData.success) {\n      let paymentModeSelector = select(\"#paymentModeSelector\");\n      let giftCardPaymentHeader = select(\"#giftCardPaymentHeader\");\n      if (data.jsonData.giftCardList.length > 0) {\n        paymentModeSelector.classList.add(HIDDEN_CLASSNAME);\n        giftCardPaymentHeader.removeAttribute(\"hidden\");\n      } else {\n        giftCardPaymentHeader.setAttribute(\"hidden\", true);\n        paymentModeSelector.classList.remove(HIDDEN_CLASSNAME);\n      }\n      let wrapper = select(\"#giftcard-method-wrapper\");\n      wrapper.innerHTML = data.html;\n      if (!data.jsonData.successKey) {\n        let errorMessage = select(\"#giftcard-error-message\");\n        const dataErrorMessage = data.jsonData.errorMessage;\n        errorMessage.innerHTML = dataErrorMessage;\n        giftCardDataLayerUpdate(dataErrorMessage);\n        focusElement(errorMessage);\n        let giftCardForm = select(\"#giftcard_add_form\");\n        if (giftCardForm) {\n          giftCardForm.classList.remove(HIDDEN_CLASSNAME);\n          const fields = selectAll(\"input\", giftCardForm);\n          if (!defaultUrl) {\n            fields.forEach((field) => {\n              field.removeAttribute(\"disabled\");\n              field.setAttribute(\"required\", true);\n              field.setAttribute(\"aria-required\", true);\n            });\n          } else {\n            fields.forEach((field) => {\n              field.setAttribute(\"disabled\", true);\n            });\n          }\n        }\n        let addMoreGiftCard = select(\".js-giftCard-addMoreSection\");\n        addMoreGiftCard ? addMoreGiftCard.classList.add(HIDDEN_CLASSNAME) : \"\";\n      }\n      steps[\"cart_total\"].el.innerHTML = data.cart_total;\n      Manager.publish(\"bindDom\", wrapper);\n      const formElm = select(\"form#sopPaymentDetailsForm\");\n      if (formElm) {\n        if (defaultUrl) formElm.action = localStorage.getItem(\"defaultAction\");\n        else formElm.action = window.config.webservices.checkout.giftCardPlaceOrder;\n      }\n    } else {\n      // TODO - Handle Error Scenario\n    }\n  }\n\n  function removeAllGiftCards(e) {\n    e.preventDefault();\n    const removeLink = e.delegateTarget;\n    if (removeLink.classList.contains(\"display-remove-link\")) {\n      const paymentModeSelector = select(\"#paymentModeSelector\");\n      const giftCardPaymentHeader = select(\"#giftCardPaymentHeader\");\n      paymentModeSelector ? paymentModeSelector.classList.remove(HIDDEN_CLASSNAME) : \"\";\n      giftCardPaymentHeader ? giftCardPaymentHeader.setAttribute(\"hidden\", true) : \"\";\n    }\n    const giftCardListDisplay = select(\"#giftcard-display-list\");\n    giftCardListDisplay ? (giftCardListDisplay.innerHTML = \"\") : \"\";\n    xhr.post(config.webservices.checkout.removeGiftCard, {}).then((data) => {\n      renderGiftCardSection(data, false);\n      const giftCardNoEl = select(\"#giftCardNumber\");\n      const giftCardCvnEl = select(\"#giftCardCvn\");\n      if (giftCardNoEl && giftCardCvnEl) {\n        giftCardNoEl.setAttribute(\"required\", \"true\");\n        giftCardCvnEl.setAttribute(\"required\", \"true\");\n        giftCardNoEl ? focusElement(giftCardNoEl, { notChangeTabIndex: true }) : \"\";\n      }\n    });\n  }\n\n  function showGiftCardForm(e) {\n    e.preventDefault();\n    const giftCardNoEl = select(\"#giftCardNumber\");\n    const giftCardForm = select(\"#giftcard_add_form\");\n    if (giftCardForm) {\n      giftCardForm.classList.remove(HIDDEN_CLASSNAME);\n      select(\".js-giftCard-addMoreSection\").classList.add(HIDDEN_CLASSNAME);\n      select(\"#giftCardCvn\").setAttribute(\"required\", \"true\");\n      if (giftCardNoEl) {\n        const giftCardLabel = select(\"h3\", giftCardForm);\n        giftCardNoEl.setAttribute(\"required\", \"true\");\n        giftCardLabel ? focusElement(giftCardLabel) : \"\";\n      }\n      getCollection(\"#giftcard_add_form input\").forEach((input) => {\n        input.removeAttribute(\"disabled\");\n      });\n    }\n  }\n\n  function hideGiftCardForm(e) {\n    e.preventDefault();\n    select(\"#giftcard_add_form\").classList.add(HIDDEN_CLASSNAME);\n    selectAll(\"#giftcard_add_form input\").forEach((input) => {\n      input.setAttribute(\"disabled\", true);\n    });\n    select(\".js-giftCard-addMoreSection\").classList.remove(HIDDEN_CLASSNAME);\n    select(\"#giftCardNumber\").removeAttribute(\"required\");\n    select(\"#giftCardCvn\").removeAttribute(\"required\");\n    const giftCardAddEl = select(\".js-show-giftCard-form-button\");\n    giftCardAddEl ? focusElement(giftCardAddEl, { notChangeTabIndex: true }) : \"\";\n    let errorMessage = select(\"#giftcard-error-message\");\n    errorMessage ? errorMessage.classList.add(HIDDEN_CLASSNAME) : \"\";\n  }\n\n  function showPaymentForm(e) {\n    e.preventDefault();\n    const paymentModeSelector = select(\"#paymentModeSelector\");\n    const giftCardPaymentHeader = select(\"#giftCardPaymentHeader\");\n    const giftCardBtn = select(\"#payment-giftcard\");\n    const creditCardBtn = select(\"#payment-creditcard\");\n    const MODULE_SELECTOR = \"[data-form-toggle-display]\";\n    const giftCardListDisplay = select(\"#giftcard-display-list\");\n    const giftCardlistDiv = select(\".giftCard__List\").innerHTML;\n    const giftCardMoreSection = select(\".js-giftCard-addMoreSection\");\n    giftCardListDisplay ? giftCardListDisplay.classList.remove(HIDDEN_CLASSNAME) : \"\";\n\n    var giftCardMethod = document.createElement(\"div\");\n    var giftCardList = document.createElement(\"div\");\n    giftCardMethod.setAttribute(\"class\", \"giftcard-method\");\n    giftCardList.setAttribute(\"class\", \"giftCard__List\");\n    giftCardMethod.appendChild(giftCardList);\n    giftCardList.innerHTML = giftCardlistDiv;\n    giftCardListDisplay ? (giftCardListDisplay.innerHTML = giftCardMethod.innerHTML) : \"\";\n    giftCardMoreSection ? giftCardMoreSection.classList.add(HIDDEN_CLASSNAME) : \"\";\n    if (creditCardBtn && giftCardBtn) {\n      creditCardBtn.checked = true;\n      creditCardBtn.setAttribute(\"checked\", \"checked\");\n      giftCardBtn.checked = false;\n      giftCardBtn.removeAttribute(\"checked\", \"checked\");\n    }\n    const evtParams = {\n      bubbles: true,\n      cancelable: false,\n    };\n    const evt = new window.CustomEvent(\"change\", evtParams);\n    Array.prototype.forEach.call(document.querySelectorAll(MODULE_SELECTOR), (el) => {\n      if (el.checked) {\n        el.dispatchEvent(evt);\n        focusElement(creditCardBtn, { notChangeTabIndex: true });\n      }\n    });\n\n    if (giftCardListDisplay) {\n      const button = select(\".js-remove-giftCard\", giftCardListDisplay);\n      const selectCardType = select(\"#selectCreditCardType\");\n      button ? button.classList.add(\"display-remove-link\") : \"\";\n      selectCardType ? focusElement(selectCardType, { notChangeTabIndex: true }) : \"\";\n      const formElm = select(\"form#sopPaymentDetailsForm\");\n      if (formElm) {\n        formElm.action = window.config.webservices.checkout.giftCardPlaceOrder;\n      }\n    }\n  }\n\n  function handleDeliverySlotDateSelection(e) {\n    let deliverySlotDateSelectBox = e.delegateTarget;\n    getCollection(\"option\", deliverySlotDateSelectBox).forEach((option) => {\n      if (option.value == deliverySlotDateSelectBox.value && option.dataset[\"timeSlotSelectboxId\"] && option.dataset[\"timeSlots\"]) {\n        getCollection(\"#\" + option.dataset[\"timeSlotSelectboxId\"]).forEach((timeSlotSelectBox) => {\n          timeSlotSelectBox.innerHTML = \"\";\n          let selectedOption;\n          JSON.parse(option.dataset[\"timeSlots\"]).timeSlots.forEach((timeSlot) => {\n            let option = document.createElement(\"option\");\n            option.value = timeSlot.value;\n            option.innerText = timeSlot.display;\n            timeSlotSelectBox.appendChild(option);\n            selectedOption = selectedOption || option;\n          });\n          if (selectedOption) {\n            let wrapper = select(\".selectbox__wrapper\", timeSlotSelectBox.parentElement);\n            if (wrapper) {\n              wrapper.innerHTML = `<span>${selectedOption.innerText}</span>`;\n            }\n            selectedOption.setAttribute(\"selected\", \"selected\");\n          }\n        });\n      }\n    });\n  }\n\n  function countryCodeName() {\n    const selectBox = select(\"#pos_countryCode\");\n    let countryCodeName = select('input[name=\"countryCodeName\"]');\n    if (countryCodeName) {\n      countryCodeName.value = selectBox.options[selectBox.selectedIndex].text;\n    }\n  }\n\n  function editOrderSummary() {\n    updateAnalyticsOpcEdit();\n  }\n\n  /**\n   * when payment mode selected BCMC then hide input security code and save for later checkbox.\n   * paymentModeSelected function checks for code 'ban_contact'\n   */\n  function paymentModeSelected(event) {\n    let paymentInfoNodes = getCollection(\".ban-contact-info-eu\");\n    let cardNumber = select(\"#cardNumber\");\n    paymentInfoNodes.forEach((paymentInfoNode) => {\n      let type = paymentInfoNode.type;\n      if (event.target.value === \"ban_contact\") {\n        paymentInfoNode.classList.add(HIDDEN_CLASSNAME);\n        paymentInfoNode.setAttribute(\"aria-hidden\", \"true\");\n        cardNumber.setAttribute(\"maxlength\", \"19\");\n        if (type === \"text\" || type === \"number\") {\n          paymentInfoNode.setAttribute(\"disabled\", true);\n        }\n      } else {\n        paymentInfoNode.classList.remove(HIDDEN_CLASSNAME);\n        paymentInfoNode.removeAttribute(\"aria-hidden\");\n        cardNumber.setAttribute(\"maxlength\", \"16\");\n        if (type === \"text\" || type === \"number\") {\n          paymentInfoNode.removeAttribute(\"disabled\");\n        }\n      }\n    });\n  }\n\n  function updateRegisterUserDetails() {\n    let perferencesDetail = select(\"#newsletter-subscribe\");\n    let subscribe = perferencesDetail && perferencesDetail.checked;\n    if (subscribe) {\n      updateAnalyticsPerferenceRegister();\n    }\n  }\n\n  /**\n   * Update Analytics data for register user on opc in case of newletter subscribed\n   */\n  function updateAnalyticsPerferenceRegister() {\n    window.document.DLKit.push(\"on-tracking\", {\n      event: \"uaevent\",\n      eventCategory: \"checkout\",\n      eventAction: \"newsletter\",\n      eventLabel: \"subscription\",\n    });\n  }\n\n  function updateIncompleteAddress() {\n    const sidepanelDiv = select(\"div.sidepanel-edit-form.js-add-edit-address-from-opc\");\n    const addressForm = select('form[id=\"addressForm\"]', sidepanelDiv);\n\n    const submitBtn = select('button[type=\"submit\"]', addressForm);\n    if (submitBtn) {\n      submitBtn.click();\n    }\n  }\n\n  function orderRegisterUserDetails() {\n    let perferencesDetail = select(\"#newsletter-subscribe\");\n    let subscribe = perferencesDetail.checked;\n    if (subscribe) {\n      updateAnalyticsOrderPerferenceRegister();\n    }\n  }\n\n  /**\n   * Update Analytics data for register user on order in case of newletter subscribed\n   */\n  function updateAnalyticsOrderPerferenceRegister() {\n    window.document.DLKit.push(\"on-tracking\", {\n      event: \"uaevent\",\n      eventCategory: \"order confirmation\",\n      eventAction: \"newsletter\",\n      eventLabel: \"subscription\",\n    });\n  }\n\n  function toshiDeliveryMode(form) {\n    let toshiDeliveryMehod = select(\".toshi-method\");\n    let toshiFlag = false;\n    if (toshiDeliveryMehod && toshiDeliveryMehod.children[0].checked == true) {\n      const deliverySlotSelected = getCollection(\".css-1odr93t\");\n      const inputElement = select(\".toshi-method > input\");\n      const dataTime = getCollection(\".css-1odr93t\");\n      if (dataTime.length > 1) {\n        toshiFlag = true;\n        inputElement.setCustomValidity(\"toshi.invalid\");\n        inputElement.checkValidity();\n        focusElement(inputElement);\n        updateAnalyticErrorToshi();\n        return true;\n      }\n    }\n    return toshiFlag;\n  }\n\n  function updateDataOnWeekendDeliverySelect(e) {\n    handleDeliverySlotDateSelection(e);\n    const data = JSON.parse(e.srcElement.options[e.srcElement.selectedIndex].getAttribute(\"data-deliverymode-info\"));\n    const containerDiv = select(\".highlightShippingNode\");\n    containerDiv.setAttribute(\"data-test\", \"rdbtnShippingMethod_\" + data.code);\n    const selectedRadio = select('input[name=\"delivery_method\"]', containerDiv);\n    selectedRadio.value = data.code;\n    selectedRadio.setAttribute(\"data-shippingmethod-analytics\", data.code + \" - \" + data.price);\n    selectedRadio.setAttribute(\"data-test\", \"rdbtnShippingMethod_Input_\" + data.code);\n  }\n  \n  function handleChange(e) {\n    const dropdown = e.target || e\n    const selectedIndex = dropdown.selectedIndex\n    if (dropdown.options[selectedIndex]) {\n      const el = select('#weekendDeliveryOptions')\n      if (dropdown.options[selectedIndex].text.includes(' ')) {\n        const arr = dropdown.options[selectedIndex].text.split(' ')\n        select('span', el).innerHTML = ['<span>', arr[0], ' ', '<b>', arr[1], '</b>', '</span>'].join('')\n      } else {\n        select('span', el).innerHTML = ['<span>', dropdown.options[selectedIndex].text, '</span>'].join('')\n      }\n    }\n  }\n\n  function updateAnalyticErrorToshi() {\n    window.document.DLKit.push(\"on-tracking\", {\n      event: \"nievent\",\n      eventCategory: \"delivery\",\n      eventAction: \"error\",\n      eventLabel: \"Please select a date and a time slot\",\n    });\n  }\n\n  function updateIncompleteAddress() {\n    const sidepanelDiv = select(\"div.sidepanel-edit-form.js-add-edit-address-from-opc\");\n    const addressForm = select('form[id=\"addressForm\"]', sidepanelDiv);\n\n    const submitBtn = select('button[type=\"submit\"]', addressForm);\n    if (submitBtn) {\n      submitBtn.click();\n    }\n  }\n\n  function onSaveAddressCheckbox() {\n    const savecheckbox = select('[id=\"address.addAddressToGigya\"]')\n    if (savecheckbox) {\n\t    if (savecheckbox.checked) {\n\t\t    savecheckbox.value = true\n\t\t    savecheckbox.setAttribute('checked', true)\n      }\n      else {\n    \t  savecheckbox.value = false\n    \t  savecheckbox.removeAttribute('checked')\n      }\n    }\n  }\n\n  function invoiceDisplay() {\n    const invoice = select('[id=\"set-invoice\"]')\n    const invoiceform = select('[id=\"invoice-form\"]')\n    const invoicePrivacy = selectAll('.js-privacy')\n    const invoiceAccount = selectAll('.js-company')\n    if (invoice) {\n\t    if (invoice.checked) {\n\t\t    invoice.value = true\n\t\t    invoice.setAttribute('checked', true)\n        invoiceform.removeAttribute('hidden')\n        const invoiceList = select('ul.inline-invoice-radio')\n        const invoiceRadio = selectAll('.js-invoice', invoiceList)\n        const profesional = select('[id=\"invoiceForm-professional\"]')\n        if (invoiceRadio) {\n          invoiceRadio.forEach((element) => {\n            element.addEventListener('change', invoiceTypeDisplay)\n          })\n        }\n        if (profesional.checked == true) {\n          invoiceAccount.forEach((input) => {\n            input.setAttribute('required', true)\n            input.setAttribute('aria-required', true)\n          })\n        }\n        invoicePrivacy.forEach((input) => {\n          input.setAttribute('required', true)\n          input.setAttribute('aria-required', true)\n        })\n      } else {\n          invoice.value = false\n          invoice.removeAttribute('checked')\n          invoiceform.setAttribute('hidden', '')\n          invoicePrivacy.forEach((input) => {\n            input.removeAttribute('required')\n            input.removeAttribute('aria-required')\n          })\n           invoiceAccount.forEach((input) => {\n            input.removeAttribute('required')\n            input.removeAttribute('aria-required')\n          })\n      }\n    }\n  }\n  function invoiceTypeDisplay() {\n    const personal = select('[id=\"invoiceForm-personal\"]')\n    const profesional = select('[id=\"invoiceForm-professional\"]')\n    const invoiceCompany = select('.js-professional')\n    const invoicePersonal = select('.js-personal')\n    const invoicePrivacy = selectAll('.js-privacy')\n    const invoiceAccount = selectAll('.js-company')\n    invoicePrivacy.forEach((input) => {\n      input.setAttribute('required', true)\n      input.setAttribute('aria-required', true)\n    })\n\n    if (profesional.checked == true) {\n        invoiceCompany.removeAttribute('hidden')\n        personal.setAttribute('checked', false)\n        invoiceAccount.forEach((input) => {\n          input.setAttribute('required', true)\n          input.setAttribute('aria-required', true)\n        })\n    } else {\n        invoiceCompany.setAttribute('hidden', '')\n        invoicePersonal.removeAttribute('hidden')\n        profesional.setAttribute('checked', false)\n        invoiceAccount.forEach((input) => {\n          input.removeAttribute('required')\n          input.removeAttribute('aria-required')\n        })\n      }\n  }\n\n  function editExistingBoutique(e) {\n    const button = e.delegateTarget;\n    const productCode = button.dataset.productCode\n    sidePanel.open(config.popups['listOfPOSDataForCnC'] + '?productCode=' + productCode, document.querySelector('.js-edit-boutique-link'))\n  }\n\n  function loadMapOnPageLoad() {\n    var geoPointDetails = select('input[name=\"posGeoLocation\"]') ? select('input[name=\"posGeoLocation\"]') : select('input[name=\"posName\"]');\n    if (geoPointDetails) {\n      const lat = geoPointDetails.getAttribute(\"data-lat\");\n      const long = geoPointDetails.getAttribute(\"data-lng\");\n      const elmId = geoPointDetails.getAttribute(\"id\");\n      initializeMap(lat, long, elmId);\n      focusElement(geoPointDetails, { notChangeTabIndex: true });\n    }\n  }\n\n  window.addEventListener(\"online\", updateOnlineGiftCardBtn);\n  function updateOnlineGiftCardBtn(event) {\n    if (navigator.onLine) {\n      const confirmGiftCardBtn = select(\".js-add-giftCard-button\");\n      if (confirmGiftCardBtn) confirmGiftCardBtn.classList.remove(\"is-disabled\");\n    }\n  }\n  function copyQRCode(e) {\n    const button = e.delegateTarget;\n    const qrCode = button.getAttribute(\"data-qrcode\");\n    navigator.clipboard.writeText(qrCode);\n    if(qrCode)  {\n      dataLayer.push({\n        'eventCategory': 'order summary',\n        'eventAction': 'copy_pix_qr_code',\n        'eventLabel': '',\n        'event': 'uaevent' // associated event\n      });\n    }\n    copyNotification();\n  }\n\n  function copyNotification() {\n    notifier.show({\n      name: config.notifierNotify.notifierTitle,\n      message: `<div class=\"notify-head\"><div class=\"notify-me-heading\" role=\"heading\" aria-level=\"1\">` + config.notifierNotify.notifierTitle + `</div>\n      <p class=\"notify-desc\">` + config.notifierNotify.notifierDesc + `</p></div>`,\n      close: config.notifierNotify.close,\n    })\n  }\n\n  window.addEventListener('resize', handlePOSMap);\n\n  function handlePOSMap() {\n    var lat;\n    var long;\n    var id;\n    var geoPointDetails = select('input[name=\"posGeoLocation\"]');\n    var selectedPosId = select('input[name=\"posName\"]:checked');\n    if (geoPointDetails || selectedPosId) {\n      if (geoPointDetails) {\n        lat = geoPointDetails.getAttribute(\"data-lat\");\n        long = geoPointDetails.getAttribute(\"data-lng\");\n        id = geoPointDetails.getAttribute(\"id\");\n      }\n      else if (selectedPosId) {\n        lat = selectedPosId.getAttribute(\"data-lat\");\n        long = selectedPosId.getAttribute(\"data-lng\");\n        id = selectedPosId.getAttribute(\"id\");\n      }\n\n      var mobileMapElement = select(\"#googleMapMobile-\" + id);\n      if (isMobile) {\n        if (select(\".POSMap\")) {\n          select(\".POSMap\").setAttribute(\"hidden\", \"\");\n        }\n        if (mobileMapElement) {\n          mobileMapElement.closest(\".POSMapMobile\").removeAttribute(\"hidden\");\n        }\n      }\n      else if (isTabletScreen()) {\n        if (select(\".POSMap\")) {\n          select(\".POSMap\").setAttribute(\"hidden\", \"\");\n        }\n        if (mobileMapElement) {\n          mobileMapElement.closest(\".POSMapMobile\").removeAttribute(\"hidden\");\n        }\n      }\n      else if (isWideScreen()) {\n        if (select(\".POSMap\")) {\n          select('.POSMap').removeAttribute(\"hidden\")\n        }\n        if (mobileMapElement) {\n          mobileMapElement.closest(\".POSMapMobile\").setAttribute(\"hidden\", \"\");\n        }\n      }\n      initializeMap(lat, long, id);\n    }\n  }\n\n  bind(document.body, \".js-opc-change-country\", \"click\", ChangeCountry);\n  bind(document.body, \".js-update-cancel\", \"click\", cancelUpdateSMSNumber);\n  bind(document.body, \".js-change-number\", \"click\", updateSMSNumber);\n  bind(document.body, \".subscribe-again\", \"click\", handleSubscribeAgain);\n  bind(document.body, \".js-shipping-rules\", \"click\", shippingRulesDataLayerUpdate);\n  bind(document.body, \".continueWithPOS\", \"click\", posDataLayerUpdate);\n  bind(document.body, '[data-popup-target=\"address-edit\"]', \"click\", updateAnalyticsEditAddress);\n  bind(document.body, '[data-popup-target=\"address-add\"]', \"click\", updateAnalyticsAddAddress);\n  bind(document.body, \".deliveryOptionType\", \"click\", selectDeliveryMethod);\n  bind(document.body, '[name=\"posName\"]', \"change\", selectPOSAddress);\n  bind(document.body, \"[data-step]\", \"click\", stepBack);\n  bind(document.body, \"[data-step-display]\", \"click\", toggleDisplay);\n  bind(document.body, '.step3 [name=\"useDeliveryAddress\"]', \"change\", handleBillingAddressForm);\n  bind(document.body, '.step3 [name=\"useDeliveryAddressEU\"]', \"change\", handleBillingAddressForm);\n  bind(document.body, '[id=\"savePaymentMethod\"]', \"change\", updateDefaultCardCheckbox);\n  bind(document.body, DIALOG_WRONG_ADDRESS_ISCORRECT_BUTTON_SELECTOR, \"click\", onUserConfirmedWrongAddress);\n  bind(el, \"form\", \"submit\", handleSubmit);\n  bind(el, \".js-check-credit-card-support\", \"input\", hilightCreditCard);\n  bind(document.body, '[id=\"address.addAddressToGigya\"]', 'change', onSaveAddressCheckbox)\n  bind(document.body, '[id=\"set-invoice\"]', 'change', invoiceDisplay)\n  bind(document.body, \"button\", \"click\", enableSubmitBtns);\n  bind(document.body, '[name=\"subscriptionId\"]', \"change\", selectSavedCard);\n  bind(document.body, '[name=\"payment\"]', \"change\", selectPaymentType);\n  bind(document.body, '[name=\"payment\"]', \"focusin\", selectPaymentFocusIn);\n  bind(document.body, '[name=\"payment\"]', \"focusout\", selectPaymentFocusOut);\n  bind(document.body, '[id=\"sopPaymentDetailsForm\"]', \"submit\", hideNewCardForm);\n  bind(document.body, '[id=\"btnContinuAsGuest\"]', \"click\", updateAnalyticsContinueAsGuest);\n  bind(document.body, \".js-remove-giftCard\", \"click\", removeAllGiftCards);\n  bind(document.body, \".js-add-giftCard-button\", \"click\", updateGiftCardList);\n  bind(document.body, '[id=\"selectCreditCardType\"]', \"change\", paymentModeSelected);\n  bind(document.body, \".js-remaining-pay\", \"click\", showPaymentForm);\n  bind(document.body, \".change-giftCard-link\", \"click\", changePaymentType);\n  bind(document.body, \".js-show-giftCard-form-button\", \"click\", showGiftCardForm);\n  bind(document.body, \".js-hide-giftCard-form-button\", \"click\", hideGiftCardForm);\n  bind(document.body, \".js-deliveryslot-date\", \"change\", handleDeliverySlotDateSelection);\n  bind(document.body, \".js-weekend-select\", \"change\", updateDataOnWeekendDeliverySelect);\n  bind(document.body, \".js-shipping-mode-option\", \"click\", shippingOptionHighlight);\n  bind(document.body, '[id=\"edit_checkout\"]', \"click\", editOrderSummary);\n  bind(document.body, \".js-gigya-register-form\", \"click\", updateRegisterUserDetails);\n  bind(document.body, 'button[id=\"updateAddress\"]', \"focusout\", updateIncompleteAddress);\n  bind(document.body, \".js-order-resgister-screen\", \"click\", orderRegisterUserDetails);\n  bind(document.body, \".js-edit-boutique-link\", \"click\", editExistingBoutique);\n  bind(document.body, \".js-selectBoutique\", \"click\", handleSubmit);\n  bind(document.body, \".js-cta-copy-qrcode\", \"click\", copyQRCode);\n  bind(document.body, '[id=\"weekendDeliveryOptions\"]', 'change', handleChange);\n}\n\nexport default function (el) {\n  return new OPC(el);\n}\n","import * as xhr from 'modules/fetch'\nimport config from 'lib/config'\nimport bind from 'delegate'\nimport Loader from 'ui/widgets/loader'\nimport { select, getCollection } from 'lib/selectors'\nimport addressValidation from './address-validation'\nimport { Manager, CHECK_RESPONSE } from 'lib/events'\nimport  * as MobilePhoneValidation  from '../../config/mobile-phone-validation'\nimport {trimNumber} from 'lib/helpers'\n\nconst LIST_ITEMS_SELECTOR = '.js-selection-list'\nconst SIDEPANEL_ADD_ADDRESS_FORM_SELECTOR = '.sidepanel-edit-form form[id=addressForm]'\nconst DIALOG_WRONG_ADDRESS_ISCORRECT_BUTTON_SELECTOR = 'button.is-tertiary.js-popin-close'\nconst DIALOG_WRONG_ADDRESS_CLOSE_BUTTON_SELECTOR = 'button.is-icon.js-popin-close'\n\nexport default function List(el) {\n  function displayError(data, form, sidePanel) {\n    if (data.modal) {\n      addressValidation.display({\n        html: data.modal,\n        outerClose: false,\n        form,\n        opener: form.querySelector('[type=\"submit\"]'),\n        // when the user decide that the filled address is valid\n        validCallback: () => {\n          handleEditResponse(data, sidePanel, form)\n        }\n      })\n    } else if (data.fields){\n      const payload = {\n        'data': data,\n        'form': form\n      }\n      Manager.publish(CHECK_RESPONSE, payload)\n    }      \n  }\n\n  function displayMoreItems(data, selectionList) {\n    if (data.html) {\n      const lastItem = selectionList.children[selectionList.childElementCount - 1]\n\n      selectionList.insertAdjacentHTML('beforeend', data.html)\n\n      lastItem.nextElementSibling.querySelector('input').focus()\n    }\n\n    return data\n  }\n\n  function handleEditResponse(data, sidePanel) {\n    // check if the item is already in the list\n    let updatedItem = document.getElementById(`selection-item-${data.id}`)\n\n    // update the item if it's in the list\n    if (updatedItem) {\n      const tempWrapper = document.createElement('ul')\n      tempWrapper.innerHTML = data.html\n      const item = tempWrapper.firstElementChild\n      updatedItem.parentElement.replaceChild(item, updatedItem)\n      updatedItem = item\n    }\n    // add the new item at the top of the list\n    else {\n      const selectionList = el.querySelector(LIST_ITEMS_SELECTOR)\n      selectionList.insertAdjacentHTML('afterbegin', data.html)\n      updatedItem = selectionList.firstElementChild\n    }\n\n    sidePanel.on('hide', () => {\n      window.requestAnimationFrame(() => {\n        const itemInput = updatedItem.querySelector('input')\n        // preselect the item if its new or updated\n        if(itemInput) {\n          itemInput.click()\n          itemInput.focus()\n        }\n      })\n    })\n\n    // close the sidepanel\n    sidePanel.hide()\n  }\n\n   \n  function handleSidepanelEditForm(e) {\n    const form = e.target\n    const sidePanel = e.delegateTarget.parentElement.modal\n    const addSelector = select('.js-sidepanel-address-save') \n    if (addSelector) {\n      addSelector.classList.add('is-disabled')\n      addSelector.disabled = true\n    }\n    if (form.invalid.length) {\n      addSelector.classList.remove('is-disabled')\n      addSelector.disabled = false\n      return\n    }\n    if(!form.invalid.length && config.country.toLowerCase() === \"ru\"){\n      addSelector.classList.remove('is-disabled')\n      addSelector.disabled = false\n    }\n    const checkboxCompanyName = select('[name=billToBusinessAddress]', form)\n    const inputCompanyName = select('[name=companyName]', form)\n\n    if (checkboxCompanyName) {\n      checkboxCompanyName.value = !!checkboxCompanyName.checked\n      !checkboxCompanyName.checked ? inputCompanyName.value = '' : null\n    }\n    e.preventDefault()\n    const phoneNumber = select('.sidepanel-edit-form input[data-phone-pattern]')\n\n    if (phoneNumber && !phoneNumber.dataset.mobileValidation) {\n      MobilePhoneValidation.getUserNumber()\n      .then((isValid) => {\n        submitFormData(form, sidePanel)\n      })\n    }\n    else {\n      submitFormData(form, sidePanel)\n    }\n    \n  }\n\n  function submitFormData(form, sidePanel) {\n    updateAnalyticsEditAddressSideTray()\n    if (form.id === 'addressForm') {\n      manageDataObj(form, sidePanel)\n    }\n    else {\n      xhr.submit(form)\n        .then(data => {\n          handleEditResponse(data, sidePanel)\n        })\n        .catch(data => {\n          displayError(data, form, sidePanel)\n        })\n    }\n  }\n\n  /**\n * Return new object from Form data\n */\n  function manageDataObj(form, sidePanel) {\n    const paramsData = {}\n    const inputs = getCollection('input, select', form)\n    let isoCode\n    const namesToExclude = ['phoneCountryCode', 'addressId', 'countryIso', 'useDeliveryAddressEU', '_useDeliveryAddressEU', 'qualityCode', 'skipValidation', '_shippingToBusinessAddress', 'billingAddress', 'shippingAddress', 'line2', 'district', 'provincia', 'shippingToBusinessAddress', 'defaultAddress', 'municipality','village','addAddressToGigya','building']\n    if((config.country.toLowerCase() === \"ru\") || (config.country.toLowerCase() === \"cn\")){\n      namesToExclude.push(\"postcode\")      \n    }\n    Array.from(inputs).filter(input =>\n      // We add an exception for phoneCountryCode as this field is used to normalized the\n      // required phoneCountryCodeField input\n       (input.required || namesToExclude.indexOf(input.name) !== -1)).forEach(input => {\n        if (input.type === 'radio'|| input.type === 'checkbox') {\n          if (input.name === \"addAddressToGigya\") {\n            paramsData[input.name] = input.value\n          } else {\n            input.checked === true ? (paramsData[input.name] = input.value) : null;\n          }\n        } else if (input.name === 'countryIso') {\n        isoCode = input.value === 'LT' ? input.value : null\n        paramsData[input.name] = input.value\n      } else if((config.country.toLowerCase() === \"cn\") && ((input.name === \"provincia\") || (input.name === \"district\") || (input.name === \"townCity\"))) {\n        paramsData[input.name] = input.selectedOptions[0].innerText\n      } else if (input.name === 'postcode') {\n        input.value.indexOf('LT') !== -1 ? input.value = input.value.replace(/[^0-9]/g, '') : null\n        paramsData[input.name] = isoCode ? `${isoCode}-${input.value}` : input.value\n      }\n      else {\n        input.value !== '' ? paramsData[input.name] = input.value : null\n      }\n    })\n    \n    if (window.config.country=='GB')\n      paramsData.phone =  trimNumber(paramsData.phone)\n    \n    xhr.submit(form, { data: paramsData })\n    .then(data => {\n      handleEditResponse(data, sidePanel)\n    })\n    .catch(data => {\n      displayError(data, form, sidePanel)\n    })\n  }\n\n  function loadMoreItems(e) {\n    const button = e.delegateTarget\n    const selectionList = el.querySelector(LIST_ITEMS_SELECTOR)\n    let replacedApi\n\n    const loader = new Loader(button, {\n      enableSyncCol: true,\n      referenceEl: button\n    })\n\n    loader.init()\n    loader.create()\n\n    if (config.webservices.more[button.dataset.loadmore]) {\n      replacedApi = config.webservices.more[button.dataset.loadmore]\n      replacedApi = replacedApi.replace('{0}', selectionList.childElementCount)\n    }\n\n    // get the api call from the confif or directly from the button if theres no match in the config\n    const api = replacedApi || button.dataset.loadmore\n\n    xhr.get(api)\n      .then(data => displayMoreItems(data, selectionList))\n      .then(data => manageLoadMoreButton(data, button))\n      .catch(config.noop)\n      .then(loader.destroy)\n  }\n\n  function manageLoadMoreButton(data, button) {\n    // update the load more button url\n    if (data.next) {\n      button.dataset.loadmore = data.next\n    }\n    // remove it if theres no more itemes to display\n    else {\n      button.parentElement.removeChild(button)\n    }\n  }\n  function onUserConfirmedWrongAddress(e) {\n    const formElm = select(SIDEPANEL_ADD_ADDRESS_FORM_SELECTOR, this.el)\n    if(!!formElm){\n      const sidePanel = formElm.offsetParent.modal\n\n      if(formElm['skipValidation']) {\n        formElm['skipValidation'].value = 'true'\n      }\n      submitFormData(formElm, sidePanel)\n    }\n  }\n\n  function onUserCloseWrongAddress(e) {\n    const addSelector = select('.js-sidepanel-address-save')\n    if(!addSelector) return\n    addSelector.classList.remove('is-disabled')\n    addSelector.disabled = false\n  }\n\n  /**\n   * Update Analytics data for Add/Edit an address for registered users in side tray\n   */\n  function updateAnalyticsEditAddressSideTray() {\n    window.document.DLKit.push('on-tracking', {\n      event: window.config.dl.event,\n      eventCategory: 'edit address',\n      eventAction: 'click',\n      eventLabel: 'save address'\n    })\n  }\n\n  bind(document.body, '.sidepanel-edit-form', 'submit', handleSidepanelEditForm)\n  bind(el, '[data-loadmore]', 'click', loadMoreItems)\n  bind(document.body, DIALOG_WRONG_ADDRESS_ISCORRECT_BUTTON_SELECTOR, 'click', onUserConfirmedWrongAddress)\n  bind(document.body, DIALOG_WRONG_ADDRESS_CLOSE_BUTTON_SELECTOR, 'click', onUserCloseWrongAddress)\n}\n","import bind from 'delegate'\nimport config from 'lib/config'\nimport inert from 'lib/inert'\nimport { Manager } from 'lib/events'\nimport notifier from 'modules/notifier'\nimport { select, getCollection } from 'lib/selectors'\nimport { focusElement } from 'lib/helpers'\n\nconst PROMOCODE_ID = 'promocode'\nconst PROMOCODE_FORM_ID = 'promocode-form'\nconst PROMOCODE_INTRO_ID = 'promocode-intro'\nconst TOGGLE_SELECTOR = '.js-promocode'\nconst HIDDEN_CLASSNAME = 'is-hidden'\n\t\n\t\nfunction PromocodeToggle() {\n\t\n  function toggle(e) {\n    e.preventDefault()\n\n    const form = document.getElementById(PROMOCODE_FORM_ID)\n    if (form) {\n      form.classList.remove(HIDDEN_CLASSNAME)\n      inert.unset(form)\n\n      const focusable = form.querySelector('input:not([type=\"hidden\"])')\n      if (focusable) {\n        focusable.focus()\n      }\n    }\n\n    const intro = document.getElementById(PROMOCODE_INTRO_ID)\n    if (intro) {\n      intro.parentNode.removeChild(intro)\n    }\n    const dataLyerType = 'promo code'\n    promoCodeDataLayerEntry(dataLyerType)\n  }\n\n  bind(document.body, `#${PROMOCODE_ID} ${TOGGLE_SELECTOR}`, 'click', toggle)\n}\nfunction highlightShippingNodeWithPromo(e) {\n  if (e && e.delegateTarget) {\n    let radioButton = select('input[name=delivery_method]', e.delegateTarget)\n    if (radioButton) {\n      radioButton.checked = true\n    }\n  }\n  let shippingNodes = getCollection('.shippingItem')\n  shippingNodes.forEach((shippingNode) => {\n    if (shippingNode.children[0].checked !== true) {\n      shippingNode.classList.remove('highlightShippingNode')\n      getCollection('.shippingmethod__details', shippingNode).forEach((detailsSection) => {\n        detailsSection.classList.add('is-hidden')\n        getCollection('select', detailsSection).forEach((selectBox) => {\n          selectBox.removeAttribute('name')\n        })\n      })\n    }\n    else {\n      if (!shippingNode.classList.contains('highlightShippingNode')) {\n        shippingNode.classList.add('highlightShippingNode')\n        getCollection('.shippingmethod__details', shippingNode).forEach((detailsSection) => {\n          detailsSection.classList.remove('is-hidden')\n          getCollection('select', detailsSection).forEach((selectBox) => {\n            selectBox.setAttribute('name', selectBox.dataset['name'])\n          })\n        })\n      }\n    }\n  })\n}\nfunction Promocode(data) {\n  const el = document.getElementById(PROMOCODE_ID)\n\n  function set() {\n    if (!el) {\n      return\n    }\n    el.innerHTML = data.parts.promocode\n    Manager.publish('bindDom', el)\n   \n   const formTypeRemove = el.querySelector('form[data-form-type=\"promocode-remove\"]')\n   const formTypeAdd = el.querySelector('form[data-form-type=\"promocode-add\"]')\n   \n    if(formTypeRemove){\n      setFocusAdd()\n    }\n    if(formTypeAdd){\n      setFocusRemove()\n   }\n   highlightShippingNodeWithPromo()\n  }\n\n  function setFocusAdd() {\n    let focusable = Array.from(el.querySelectorAll('.confirmation')).pop()\n    if (focusable) {\n      focusable = focusable.querySelector('p') || focusable\n      focusable.setAttribute('tabindex', -1)\n    }\n    else {\n      focusable = el.querySelector('input:not([type=\"hidden\"])')\n    }\n\n    if (focusable) {\n      focusable.focus()\n    }\n  }\n\n  function setFocusRemove() {\n    let confirmation = Array.from(el.querySelectorAll('.confirmation'))\n    let focusable\n\n    if (confirmation.length) {\n      confirmation = confirmation.pop()\n      focusable = confirmation.querySelector('button[type=\"submit\"]')\n    }\n    else {\n      focusable = el.querySelector('input:not([type=\"hidden\"])')\n    }\n    if (data.message) {\n      const message = data.message\n      const params = {\n        name: message.label || config.locales.notifier.request.label,\n        message: message.text || message,\n        close: message.close || config.locales.notifier.request.close,\n        noFocus: !document.body.classList.contains('is-using-keyboard')\n      }\n      if (focusable) {\n        params.opener = focusable\n      }\n      notifier.show(params)\n    }\n    else if (focusable) {\n      focusable.focus()\n    }\n\n   const addNewEle =  select('#addNewValue')\n   if (addNewEle) {\n\t   const addNewValue = addNewEle.value\n\t   if (addNewValue) {\n        const newPromoBtn = document.getElementById(addNewValue)\n         if (newPromoBtn) {\n           focusElement(newPromoBtn)\n        }\n      }\n    }\n  }\n\n  set()\n}\n\nfunction promoCodeDataLayerEntry(type) {\n  var dataset = {\n    'eventCategory': 'delivery',\n    'eventAction': 'click',\n    'eventLabel': type,\n    'event': 'uaevent'\n   }\n  window.document.DLKit.push('on-tracking', dataset)\n}\n\nfunction handlePromoAdd() {\n  const voucherCode = select('#voucher-code')\n  const addNewValue = select('#addNewValue')\n\n   if (voucherCode && addNewValue) {\n     addNewValue.value = voucherCode.value\n   }\n  const dataLyerType = 'apply promo code'\n  promoCodeDataLayerEntry(dataLyerType)\n}\n\nbind(document.body, '[data-form-type=\"promocode-add\"]', 'click', handlePromoAdd)\n\nexport {\n  Promocode,\n  PromocodeToggle\n}\n","import {select, selectAll} from 'lib/selectors'\nimport {focusElement, isWideScreen, tabIndexToZero} from 'lib/helpers'\nimport popin from 'modules/popin'\nimport config from 'lib/config'\n\n// Selectors\nconst DIALOG_CLOSE_BUTTON_SELECTOR = 'div.yes-no-modal button.popin__close.js-popin-close'\n\nlet submitted = false;\n\nclass ThreeDS2Popin {\n  constructor(el) {\n    this.el = el\n    this.buttonClose = null\n    this.params = {\n    }\n  }\n\n  async init() {\n    let challengeTokenIdElem = select(\"#challengeTokenId\")\n    let challengeToken = challengeTokenIdElem.value\n    let legacy = challengeTokenIdElem.dataset['legacy']\n    let checkGiftCard = select('#isGiftCard')\n    let isGiftCard = checkGiftCard.value == 'true' ? true : false\n    this.buildTemplate(challengeToken, legacy, isGiftCard)\n}\n\n  perform3DS2Operations (tokenID) {\n    const isChallengeShopper = select(\"#challengeShopperId\").value\n    if (isChallengeShopper) {\n      this.initiate3DS2ChallengeShopper(tokenID);\n    }\n  }\n\n  initiate3DS2ChallengeShopper(challengeToken) {\n    submitted = false;\n    var threeDS2ChallengeShopperNode = select('#threeDS2');\n    const localeValue = select(\"#localId\").value\n    const envValue = select(\"#envId\").value\n    var configuration = {\n      locale: localeValue,\n      environment: envValue\n    }\n    const checkout = new AdyenCheckout(configuration);\n    var challengeShopperComponent = checkout\n      .create( 'threeDS2Challenge', {\n        challengeToken: challengeToken,\n        onComplete: function ( challengeData ) {\n          if (submitted) {\n            // Already submitted. Ignore this call\n            return;\n          }\n          submitted = true;\n          this.challengeResult = challengeData.data.details[\"threeds2.challengeResult\"];\n          var challengeResultField = select(\"#challengeResult\");\n          challengeResultField.value = this.challengeResult;\n          var threeDS2popinCol = select('.popin__col')\n          threeDS2popinCol.setAttribute('style', 'visibility:hidden');\n          document.getElementById(\"3ds2-form\").submit();\n        },\n        onError: function (error) {\n          console.error(JSON.stringify(error));\n        },\n        size: '05'\n      } );\n    challengeShopperComponent.mount(threeDS2ChallengeShopperNode);\n  }\n\n  buildTemplate(tokenID, legacy, isGiftCard) {\n    this.template =\n      `<div class=\"popin-text text-center\" id=\"threeDS2-popin-wrapper\" data-close-label=\"${window.config.locales.opc.threeDS2Auth.closethreeDS2Auth}\" data-test=\"secThreeDS2Popin\">\n        <div class=\"modal-body\">\n          <div id=\"threeDS2\" class=\"heading is-5\" role=\"heading\"></div>\n           <form method=\"post\" id=\"3ds2-form\" action=\"${legacy ? window.config.webservices.checkout.threeDS2ResponseLegacy :(isGiftCard ? window.config.webservices.checkout.threeDS2GiftCard : window.config.webservices.checkout.threeDS2Response)}\">\n                <input type=\"hidden\" name=\"challengeToken\" value=\"${tokenID}\" />\n                <input type=\"hidden\" id=\"challengeResult\" name=\"challengeResult\" />\n          </form>      \n        </div>\n      </div>`\n  }\n\n  onOpenPopin() {\n    let challengeToken = select(\"#challengeTokenId\").value\n    this.perform3DS2Operations(challengeToken)\n    this.setDomElements()\n  }\n\n  setDomElements() {\n    this.popinEl = select('.threeDS2popin')\n    if (this.popinEl) {\n      this.popinEl.removeAttribute('aria-labelledby')\n      this.popinEl.setAttribute('aria-label', config.popin3DS2.authLabelTitle)\n      this.popinEl.setAttribute('tabindex', '-1');\n    }\n\n    this.buttonClose = select('.js-popin-close', this.popinEl)\n    this.form = select('form', this.popinEl)\n  }\n\n  /**\n   * display a yes(remove) or no(cancel) dialog\n   * @param data {Object}: contains additional params\n   */\n   open() {\n    popin.open({\n      html: this.template,\n      role: 'dialog',\n      modifiers: 'is-relative threeDS2popin',\n      opener: null,\n      manageFocus: true,\n      forceInert: true,\n      modal: true,\n      action: 'removeCancelModal',\n      outerClose: false\n    }).then(() => {\n      this.onOpenPopin()\n    })\n    // To catch the esc key\n    window.addEventListener('keydown', this.onEscapeKeyClicked)\n  }\n\n  /**\n   * Close the active modal\n   */\n  closeModal() {\n    window.removeEventListener('keydown', this.onEscapeKeyClicked)\n    popin.hide()\n  }\n\n  /**\n   * Triggered once user clicked on the modal cancel button\n   * @param params {MouseEvent}: contains MouseEvent parameters\n   */\n  onModalCancelButtonClicked = (e) => {\n    this.closeModal()\n    focusElement(this.params.clickedElm)\n    if (!isWideScreen()) {\n      const links = selectAll('.collapse-panel__header .js-collapse-button')\n      if (links.length > 0) {\n        tabIndexToZero(links)\n      }\n    }\n  }\n\n  /**\n   * Triggered once user clicked on keyboard inputs\n   * @param e {MouseEvent}: MouseEvent parameters \n   */\n  onEscapeKeyClicked = (e) => {\n    if ((e.key === 'Escape' || e.key === 'Esc' || e.keyCode === 27)) {\n      this.onModalCancelButtonClicked(e)\n    }\n  }\n\n}\n\nconst initThreeDS2Popin = () => {\n  const threeDS2 = new ThreeDS2Popin()\n  threeDS2.init().then(() => {\n    threeDS2.open()\n  })\n}\n\nexport default initThreeDS2Popin","import bind from 'delegate'\nimport { select } from 'lib/selectors'\n\n/**\n *\n * @param {*HTMLElement} scope - the element containing the data-formaction attributes\n * formaction attribute used because it is triggerd on submiting (enter key)\n   and we want to change the form's action value only when input is selected\n */\nexport default function Toggle(scope) {\n  function handleFormAction(e) {\n    const el = e.delegateTarget\n\n    if (!el.checked) {\n      return\n    }\n\n    const form = el.closest('form')\n\n    if (!form) {\n      return\n    }\n\n    if (!form.defaultAction) {\n      form.defaultAction = form.getAttribute('action')\n    }\n\n    form.action = el.dataset.formaction\n\n    if (!form.action) {\n      form.action = form.defaultAction\n    }\n\n    if (form.id === 'sopPaymentDetailsForm' && select('.js-remove-giftCard')) {\n       form.action = window.config.webservices.checkout.giftCardPlaceOrder\n     }\n  }\n\n  bind(scope, 'input[data-formaction]', 'change', handleFormAction)\n}\n"],"sourceRoot":""}