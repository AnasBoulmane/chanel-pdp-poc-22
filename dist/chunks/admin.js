(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{446:function(t,e,a){"use strict";a.r(e);a(7);var s=a(11),n=a(0),i=a(2),c=a(1),r=a(564),o=a.n(r);const l=Object(n.select)("#admin-calendar");class h extends(l?s.a:class{constructor(){}}){constructor(t){super(t||null),t&&this.isStaged()&&(this.selectors={CALENDAR_SELECTOR:"#admin-calendar-container",SERVER_DATE_SELECTOR:"#admin-calendar-server-date",SERVER_TIMEZONE_SELECTOR:"#admin-calendar-server-timezone",DISPLAY_LOCAL_TIMEZONE_SELECTOR:".js-admin-calendar-local-timezone",DISPLAY_SERVER_TIMEZONE_SELECTOR:".js-admin-calendar-server-timezone",IS_PLURIAL_SELECTOR:".js-admin-calendar-is-plurial",DISPLAY_SERVER_DIFF_SELECTOR:".js-admin-calendar-server-diff",ONLINE_LINK_SELECTOR:".js-admin-calendar-online-link",GOTO_SELECTOR:".js-admin-calendar-goto",RESET_SELECTOR:".js-admin-calendar-reset",DISPLAY_ICON_SELECTOR:".display-icon"},this.isDisplayed=!1,this.defaultDate=null,this.displayCalendar=this.displayCalendar.bind(this),this.goTo=this.goTo.bind(this),this.onChangeState=this.onChangeState.bind(this),this.selectdDate=null,this.init())}isStaged(){const t=!!location.host.match(/[-]staged[-:]/g);return this.el.classList.toggle("is-hidden",!t),t}init(){if(this.calendar=Object(n.select)(this.selectors.CALENDAR_SELECTOR)||!1,!this.calendar)return;const t=Object(i.l)("previewdate"),e=this.getLocalTimezone();let a=Object(n.select)(this.selectors.SERVER_TIMEZONE_SELECTOR)||!1,s=Object(n.select)(this.selectors.SERVER_DATE_SELECTOR)||!1;a=!!a&&parseInt(a.value.split(":")),s=!!s&&s.value,this.defaultDate=/false/i.test(t)?this.formatToday():(this.defaultDate=t||this.formatDate(s,a,!0))?this.defaultDate:this.formatToday(),this.render(),this.afterRender(s,e,a),this.bind(),this.setOnlineViewLink(),!t&&s&&this.historyPush()}historyPush(){const t=this.formatParameters();history.replaceState({date:this.defaultDate},"Preview page","?previewdate=".concat(this.defaultDate).concat(t))}formatParameters(){let t="",e=[];return location.search.substr(1).split("&").forEach(a=>{e=a.split("="),e&&e[0]&&"previewdate"!==e[0]&&e[1]&&(t+="&".concat(e[0],"=").concat(e[1]))}),t}afterRender(t,e,a){const s=Object(n.select)(this.selectors.DISPLAY_SERVER_DIFF_SELECTOR)||!1,i=Object(n.selectAll)(this.selectors.IS_PLURIAL_SELECTOR)||!1,c=Object(n.select)(this.selectors.RESET_SELECTOR)||!1,r=Object(n.select)(this.selectors.DISPLAY_LOCAL_TIMEZONE_SELECTOR)||!1,o=Object(n.select)(this.selectors.DISPLAY_SERVER_TIMEZONE_SELECTOR)||!1,l=Object(n.select)(".flatpickr-calendar",this.el)||!1;l&&(l.classList.add("showTimeInput"),l.classList.add("no-border")),r.innerHTML=r&&0!=e?e<0?"".concat(e):"+".concat(e):0,o.innerHTML=o&&0!=a?a<0?"".concat(a):"+".concat(a):0;const h=a-e;s&&(s.innerHTML=h),i&&i.forEach(t=>{t.classList.toggle("is-hidden",0!=h)}),c&&c.classList.toggle("is-hidden",!t)}render(){this.instance=o()(this.calendar,{enableTime:!0,dateFormat:"Y-m-dTH:i",inline:!0,time_24hr:!0,defaultDate:this.defaultDate,onReady:()=>{this.targetDatesByIndex(),this.targetInputHour(),this.targetInputMinute(),this.targetCurrentMonth(),this.targetCurrentYear()},onChange:()=>{this.targetDatesByIndex()}})}targetDatesByIndex(){Object(n.selectAll)(".dayContainer span").forEach((t,e)=>{t.setAttribute("data-test","lblDatesBy_".concat(e))})}targetInputHour(){Object(n.select)(".flatpickr-hour").setAttribute("data-test","txtInputHour")}targetInputMinute(){Object(n.select)(".flatpickr-minute").setAttribute("data-test","txtInputMinute")}targetCurrentMonth(){Object(n.select)(".cur-year").parentNode.setAttribute("data-test","lblCurrentMonthCalendarTray")}targetCurrentYear(){Object(n.select)(".flatpickr-current-month > div").setAttribute("data-test","lblCurrentYearCalendarTray")}getLocalTimezone(){let t=(new Date).getTimezoneOffset();const e=t<0?"+":"-";return t=parseInt(Math.abs(t/60)),t=parseInt(e+t),t}formatDate(t,e,a,s){if(!t||!e)return!1;a=a||!1,s=s||this.getLocalTimezone();const n=new Date(t);if(e=isNaN(e)?0:e,s=isNaN(s)?0:s,a){n.setUTCHours(n.getUTCHours()+e);const t=n.getUTCHours()>9?n.getUTCHours():"0".concat(n.getUTCHours()),a=n.getUTCMinutes()>9?n.getUTCMinutes():"0".concat(n.getUTCMinutes()),s=n.getUTCMonth()+1,i=s>9?s:"0".concat(s),c=n.getUTCDate(),r=n.getUTCDate()>9?c:"0".concat(c);return"".concat(n.getUTCFullYear(),"-").concat(i,"-").concat(r,"T").concat(t,":").concat(a)}n.setHours(n.getHours()+e);const i=n.getHours()>9?n.getHours():"0".concat(n.getHours()),c=n.getMinutes()>9?n.getMinutes():"0".concat(n.getMinutes()),r=n.getMonth()+1,o=r>9?r:"0".concat(r),l=n.getDate(),h=n.getDate()>9?l:"0".concat(l);return"".concat(n.getFullYear(),"-").concat(o,"-").concat(h,"T").concat(i,":").concat(c)}bind(){(this.icon=Object(n.select)(this.selectors.DISPLAY_ICON_SELECTOR)||!1)&&this.icon.addEventListener("click",this.displayCalendar),(this.btn=Object(n.select)(this.selectors.GOTO_SELECTOR)||!1)&&this.btn.addEventListener("click",this.goTo),c.C.subscribe(c.f,this.onChangeState),c.C.subscribe(c.g,this.onChangeState)}onChangeState(t,e){this.stateChanged(e.namespace)}stateChanged(t){this.historyPush()}setOnlineViewLink(){const t=location.host.match(/[-]staged[:]/g)?location.origin.replace(/[-]staged[:]/g,":"):location.origin.replace(/[-]staged[-]/g,"-");(this.link=Object(n.select)(this.selectors.ONLINE_LINK_SELECTOR)||!1)&&this.link.setAttribute("href","".concat(t).concat(location.pathname))}displayCalendar(){this.isDisplayed=!this.isDisplayed,l.classList.toggle("hidden",!1===this.isDisplayed),l.classList.toggle("showed",!0===this.isDisplayed)}goTo(){this.selectedDate=this.calendar.value||!1,this.displayCalendar();const t=location.host.match(/local/g)?"site=chanel&":"",e="".concat(location.origin).concat(location.pathname,"?").concat(t,"previewdate=").concat(this.selectedDate);location.assign(e)}formatToday(){const t=new Date;return"".concat(t.getFullYear(),"-").concat(t.getMonth()+1,"-").concat(t.getDate(),"T00:01")}}e.default=new h(l)}}]);