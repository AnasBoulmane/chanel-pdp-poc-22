(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{1053:function(e,t,n){"use strict";n.r(t);n(7),n(134),n(14);var a=n(4),c=n.n(a),o=n(5),i=n(0),r=n(6),s=n(3);let d=!1;function l(e){const t=e.target;e.preventDefault();const n=Object(i.select)(".js-wechat-pay-option");if(d&&n.classList.contains("selected"))return function(){const e='<div id="errPopin" class="wechat-error-popin" data-close-label="'.concat(s.a.wechat.qrCodePopin.close," - ").concat(s.a.wechat.errPopin.title,'">\n                          <div class="wechat-error-popin__header has-text-centered">\n                            <div class="heading is-7 text-center" role="heading" aria-level="1">\n                              ').concat(s.a.wechat.errPopin.title,'\n                            </div>\n                          </div>\n                          <p class="has-text-centered summary">\n                            ').concat(s.a.wechat.errPopin.summary,'\n                          </p>\n                          <p class="has-text-centered description">\n                            ').concat(s.a.wechat.errPopin.description,"\n                          </p>\n                        </div>");r.a.open({html:e,modifiers:"is-big is-relative errPopin",modal:!0,role:"dialog",label:s.a.wechat.errPopin.title,opener:Object(i.select)(".js-wechat-btn"),forceInert:!0,manageFocus:!0,outerClose:!0}).then(()=>{window.addEventListener("click",p)})}(),!1;t.checkValidity()&&o.submit(t,{}).then(e=>{e.isSuccess?"alipay"===e.pspname?function(e){window.location.href=e.url}(e):"wechatpay"===e.pspname?function(e){o.get(s.a.currentLocale+e.url,{}).then(e=>{e.isSuccess&&("wechatpay"===e.pspname?function(e){WeixinJSBridge.invoke("getBrandWCPayRequest",{appId:e.appId,timeStamp:e.timeStamp,nonceStr:e.nonceStr,package:e.packageName,signType:e.signType,paySign:e.paySign},(function(e){var t=e.err_msg.split(":")[1];"ok"!==t&&"fail"!==t||(window.location.href=cnCheckPaymentStatus+orderCode)}));const t=s.a.currentLocale+"checkout/multi/wechat/startPay";o.post(t,{data:{orderCode:orderCode}}).then(()=>{})}(e):"wechatpay_native"===e.pspname&&function(e){const t="data:image/png;base64,".concat(e.url);!function(e,t){r.a.open({html:e,modifiers:"is-big is-relative qrCodePopin",modal:!0,label:s.a.wechat.qrCodePopin.title,opener:Object(i.select)(".js-wechat-btn"),forceInert:!0,manageFocus:!0,outerClose:!0}).then(()=>{!function e(t){o.get(s.a.webservices.checkout.cnCheckPaymentStatus+t).then(n=>{n.retry?setTimeout(()=>{e(t)},1e4):window.location.href=s.a.currentLocale+n.redirectUrl})}(t.orderCode),d=!0;Object(i.select)(".js-wechat-btn").classList.remove("is-disabled"),window.addEventListener("click",p)})}('<div id="qrCodePopin" class="qr-code-popin" data-close-label="'.concat(s.a.wechat.qrCodePopin.close," - ").concat(s.a.wechat.qrCodePopin.title,'">\n                      <div class="qr-code-popin__header has-text-centered">\n                        <div class="heading is-7 text-center" role="heading" aria-level="1">\n                          ').concat(s.a.wechat.qrCodePopin.title,'\n                        </div>\n                      </div>\n                      <div id="qrCode"><img id="qr-code" alt="').concat(s.a.wechat.qrCodePopin.altImgText,'" src ="').concat(t,'" /></div>\n                      <p class="has-text-centered">\n                      ').concat(s.a.wechat.qrCodePopin.orderTitle,"</br>\n                        ").concat(e.orderCode,'\n                      </p>\n                      <p class="msg">\n                        ').concat(s.a.wechat.qrCodePopin.msg,"</br>\n                      </p>\n                    </div>"),e)}(e))}).catch(e=>{console.error(e)})}(e):"unionpay"===e.pspname&&function(e){const t=document.createElement("form");t.setAttribute("method","post"),t.setAttribute("action",e.frontTransUrl),t.setAttribute("id","payForm");for(const[n,a]of Object.entries(e.submitFromDataMap)){const e=document.createElement("input");e.setAttribute("type","hidden"),e.setAttribute("name",n),e.setAttribute("id",n),e.setAttribute("value",a),t.appendChild(e)}Object(i.select)("#unionPay-method").after(t),t.submit()}(e):window.location.replace(s.a.currentLocale+e.url)}).catch(e=>{console.error(e)})}function p(e){const t=Object(i.select)(".popin__col");t&&!t.contains(e.target)&&(r.a.hide(),window.removeEventListener("click",p))}t.default={init:function(){c()(document.body,"#cnPlaceOrderForm","submit",l)}}}}]);