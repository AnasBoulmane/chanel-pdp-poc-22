(window.webpackJsonp=window.webpackJsonp||[]).push([[31],{1088:function(e,t,o){"use strict";o.r(t);o(15);var s=o(454),r=(o(466),o(544)),a=(o(748),o(13)),n=o(22),i=o(532),c=o(0),l=o(2),d=o(1);const p=Object(c.select)(".js-product-details-zoom",Object(c.select)(".js-main-content"));let u=null;t.default=class extends s.Component{constructor(){var e,t,o;super(...arguments),o=()=>this.props.facecakeProps.isFacecakeMockupEnabled?u:this.props.product.code,(t="getProductID")in(e=this)?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o}componentDidMount(){const{orientation:e}=this.props;this.retrySetup(),window.addEventListener("orientationchange",this.onOrientationChange.bind(this)),d.C.subscribe(d.fb,()=>this.onResize()),p.style.display="none","desktop"!==Object(l.s)()&&(this.topBannerBehaviour(!0),this.vtoVariantsBehaviour(!0)),u=this.props.facecakeProps.sampleProductIds[0],this.getProductID()}componentDidUpdate(){"desktop"!==Object(l.s)()&&this.vtoVariantsBehaviour(!0)}startCamera(){const e=(e,t)=>{const{dispatch:o}=this.props;Object(i.e)({dispatch:o})};"https:"===location.protocol?(navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia,navigator.getUserMedia?navigator.getUserMedia({video:!0},(function(t){window.localStream=t;var o=t.getVideoTracks()[0];void 0!==o?o.onended=function(){e()}:e()}),(function(t){switch(t.name){case"NotFoundError":case"DevicesNotFoundError":"Please setup your webcam first.";break;case"SourceUnavailableError":"Your webcam is busy";break;case"PermissionDeniedError":case"SecurityError":"Permission denied!";break;default:return void e()}e()})):e()):e()}stopCamera(){if(window.localStream){window.localStream.getTracks().forEach((function(e){e.stop()}))}}topBannerBehaviour(e){const t=Object(c.select)(".top-banner-component",document.body),o=Object(c.select)(".page-productDetails-Eyewear .js-main",document.body),s=Object(c.select)(".product-details__content",document.body);if(t&&o){const r=t.getBoundingClientRect().height;o.style.paddingTop="".concat(e?r:0,"px"),s&&(s.style.transform="translate3d(0, ".concat(e?-r:0,"px, 0)"))}}vtoVariantsBehaviour(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];const t=Object(c.select)(".product-details__text"),o=Object(c.select)(".product-details__head"),s=Object(c.select)(".product-details__bar"),r=Object(c.select)(".js-product-details-more-wrapper"),a=Object(c.select)(".product-details__backorder"),n=Object(c.select)(".product-details__option"),i=Object(c.selectAll)(".product-details__description",o),l=Object(c.select)("p.product-details__more");if(e&&t){t.insertBefore(s,n);const e=document.createElement("p");e.className="product-details__description-wrapper",i&&i.forEach(o=>{e.insertBefore(o,null),t.insertBefore(e,s)})}else{const e=Object(c.select)(".product-details__description-wrapper",t),n=Object(c.selectAll)(".product-details__description",t);n&&n.forEach(e=>{o.insertBefore(e,null)}),e&&e.remove(),t.insertBefore(o,a),t.insertBefore(s,a),l&&t.insertBefore(l,s),r&&t.insertBefore(r,s)}}onResize(){d.C.publish(d.db);Object(c.select)(".page-productDetails-Eyewear .js-main",document.body)&&("desktop"===Object(l.s)()?(this.vtoVariantsBehaviour(!1),this.topBannerBehaviour(!1)):this.topBannerBehaviour(!0))}onOrientationChange(){const{showing:e}=this.props;if(e&&Object(n.a)()&&this.container){const{top:e,left:t}=this.container.getBoundingClientRect();window.scrollTo({top:e,left:t,options:{behavior:"smooth"}})}}componentWillUnmount(){this.video&&(this.video.srcObject=null),window.removeEventListener("orientationchange",this.onOrientationChange),p.style.display=null,this.topBannerBehaviour(!1)}close(){this.vtoVariantsBehaviour(!1);const{dispatch:e}=this.props,t=Object(c.select)("button",Object(c.select)(".vto-open__wrapper"));t&&t.classList.remove("buttonDisabled"),window.vtoClose(),Object(i.g)({dispatch:e}),Object(i.k)({dispatch:e}),d.C.publish(d.db);let o=Object(c.select)(".js-product-details-zoom");o&&(o.style.display=null);const s=Object(c.select)(".product-details .product-details-scroll");s&&(s.style.visibility="visible"),this.stopCamera()}retrySetup(){const{product:e,dispatch:t}=this.props;if("eyewear"===this.props.product.vto.category){new a.a(this.container,{delay:0});d.C.publish("VTO_IS_SHOWING",e),Object(i.i)({dispatch:t})}}componentWillReceiveProps(e){const{product:t}=this.props,{vto:o}=e.product;o&&o!==t.vto&&this.setSelectedMockup()}setSelectedMockup(){const e=this.props.facecakeProps.sampleProductIds,t=e.findIndex(e=>e==u);u=t!=e.length-1?e[t+1]:e[0]}getEyewearDimensions(e){const t=Object(c.select)(".vto-eyewear-container");return null!=t?window.getComputedStyle(t)[e]:""}render(){let{orientation:e,error:t}=this.props,o="?lang="+dataLayer[0].locale+"&title="+encodeURIComponent("Try on ".concat(this.props.product.basic.name," ").concat(this.props.product.color?this.props.product.color.name:""))+"&fallbackContent="+encodeURIComponent(config.vto.labels.canvasLabel)+"&cameraErrorMsg="+encodeURIComponent(config.locales.vto.permissionDenied)+"&generalErrorMsg="+encodeURIComponent(config.vto.labels.error);return s.default.createElement("div",{ref:e=>this.container=e,className:"vto__wrapper ".concat(e.portrait?"portrait":"landscape")},s.default.createElement(r.a,{ref:e=>this.button=e,close:()=>this.close(this.props)}),"eyewear"===this.props.product.vto.category?s.default.createElement("div",{className:"vto-eyewear-container"},s.default.createElement("iframe",{className:"vto_iframe",referrerpolicy:"strict-origin",height:this.getEyewearDimensions("height"),"aria-hidden":"false",title:"".concat(config.locales.vto.tryOn," ").concat(this.props.product.basic.name," ").concat(this.props.product.color?this.props.product.color.name:""),tabIndex:"-1",src:this.props.facecakeProps.tryOnUrl+"/"+this.props.product.baseProduct+o,scrolling:"no",allow:"camera;"})):null)}}},544:function(e,t,o){"use strict";o(15);var s=o(454),r=o(466),a=o(3),n=o(0);class i extends s.Component{constructor(){var e,t,o;super(...arguments),o=()=>{const e=Object(n.select)(".product-details .js-slide:first-child a");e&&(e.style.top="",e.style.zIndex="")},(t="handleClick")in(e=this)?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o}componentDidMount(){this.button.focus()}render(){return s.default.createElement("button",{ref:e=>this.button=e,className:"button is-icon vto-close",onClick:()=>{this.props.close(),this.handleClick()}},s.default.createElement(r.a,{name:"close"}),s.default.createElement("span",{className:"is-sr-only"},a.a.locales.vto.closeButtonLabel))}}t.a=i},748:function(e,t,o){"use strict";var s=o(454);t.a=e=>{let{error:t}=e;return s.default.createElement("div",{className:"error permissionDenied"},s.default.createElement("div",{role:"heading","aria-level":"2",className:"error__title"},t.name),s.default.createElement("p",{className:"error__message"},t.message))}}}]);